window.__require=function e(t,n,o){function i(r,c){if(!n[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){return i(t[r][1][e]||e)},d,d.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({AttributesMenu:[function(e,t,n){"use strict";cc._RF.push(t,"30df8yOol9HK5KIXgeL7b2Q","AttributesMenu"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("Global"),i=e("Panel"),a=e("MainScene"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.carImageSprite=null,t.carNameLabel=null,t.carLevelLabel=null,t.equippedLabel=null,t.nextCarButton=null,t.prevCarButton=null,t.equipButton=null,t.normalMaterial=null,t.colorMaterial=null,t.attributeNodes=[],t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.on(i.PANEL_EVT_SHOW,this.onPanelShow,this),this.equipButton.node.on("click",function(){e._equippedCar=e._displayedCar,a.default.instance.updateCarBeingEquipped(e._equippedCar),e.updateDisplayedCar()}),this.nextCarButton.node.on("click",function(){e._displayedCar++,e.updateDisplayedCar()}),this.prevCarButton.node.on("click",function(){e._displayedCar--,e.updateDisplayedCar()})},t.prototype.onPanelShow=function(e){this._displayedCar=e.equipped,this._maxCarLevel=e.maxLevel,this._equippedCar=e.equipped,this.updateDisplayedCar()},t.prototype.updateDisplayedCar=function(){var e=this;this._displayedCar>this._maxCarLevel?(this.equipButton.interactable=!1,this.carImageSprite.node.color=cc.color().fromHEX("#66e8ec"),this.carImageSprite.setMaterial(0,this.colorMaterial)):(this.equipButton.interactable=!0,this.carImageSprite.node.color=cc.Color.WHITE,this.carImageSprite.setMaterial(0,this.normalMaterial)),this._displayedCar==this._equippedCar?(this.equipButton.interactable=!1,this.equippedLabel.node.opacity=255):this.equippedLabel.node.opacity=0,this.prevCarButton.node.active=1!=this._displayedCar,this.nextCarButton.node.active=this._displayedCar!=o.presetCars.length-1;var t=o.presetCars[this._displayedCar];this.carNameLabel.string=t.name,this.carImageSprite.spriteFrame=t.perspective,this.carLevelLabel.string=""+this._displayedCar,this.attributeNodes.forEach(function(t,n){var i=e._displayedCar,a=o.presetCars.length-1,r=t.getChildByName("label_value").getComponent(cc.Label),c=t.getChildByName("sprite_attribute_background"),s=c.getChildByName("sprite_attribute_foreground");switch(n){case 0:var l="lv."+i,d=i/a;break;case 1:l=o.g_value2String(o.g_profitingFormula(i))+"/s",d=i*i/(a*a);break;case 2:l=o.g_value2String(o.g_bulletDamageFormula(i)),d=i*i/(a*a);break;case 3:l=40+5*(i-1)+"km/h",d=(40+5*(i-1))/(40+5*(a-1));break;case 4:l="$"+o.g_value2String(Math.floor(1e3*Math.pow(1.2,i-1))),d=i*i*i/(a*a*a);break;case 5:l=Math.floor(1+.2*(i-1))+"m/s",d=(1+.2*(i-1))/(1+.2*(a-1));break;case 6:l=""+(1+.5*(i-1)),d=(1+.5*(i-1))/(1+.5*(a-1))}s.width=c.width*d,r.string=l})},__decorate([s(cc.Sprite)],t.prototype,"carImageSprite",void 0),__decorate([s(cc.Label)],t.prototype,"carNameLabel",void 0),__decorate([s(cc.Label)],t.prototype,"carLevelLabel",void 0),__decorate([s(cc.Label)],t.prototype,"equippedLabel",void 0),__decorate([s(cc.Button)],t.prototype,"nextCarButton",void 0),__decorate([s(cc.Button)],t.prototype,"prevCarButton",void 0),__decorate([s(cc.Button)],t.prototype,"equipButton",void 0),__decorate([s(cc.Material)],t.prototype,"normalMaterial",void 0),__decorate([s(cc.Material)],t.prototype,"colorMaterial",void 0),__decorate([s([cc.Node])],t.prototype,"attributeNodes",void 0),__decorate([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{Global:"Global",MainScene:"MainScene",Panel:"Panel"}],CommonVehicle:[function(e,t,n){"use strict";cc._RF.push(t,"a05f8AhHvhLuKZoMMOp7fM6","CommonVehicle"),Object.defineProperty(n,"__esModule",{value:!0}),n.VEHICLE_EVT_EXPLOSION=void 0;var o=e("Global"),i=e("libcocos"),a=e("CustomProgressBar"),r=e("GameScene"),c=e("RacingCar"),s=e("libutils"),l=cc._decorator,d=l.ccclass,h=l.property;n.VEHICLE_EVT_EXPLOSION="on-vehicle-explosion";var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._basicSpeed=0,t._extraSpeed=0,t._healthValue=[0,0],t.vehicleImage=null,t.vehicleShadow=null,t.goldenGlowing=null,t.collision=null,t.explosion=null,t.hitting=null,t.healthBar=null,t.goldenVehicle=null,t.org_scale=1,t}var l;return __extends(t,e),l=t,t.create=function(e){if(this._instancePool.length){var t=this._instancePool.pop().getComponent(l);return t.initialize(e),Promise.resolve(t)}return i.cocos.loadRes("Items/common_vehicle",cc.Prefab).then(function(t){var n=cc.instantiate(t).getComponent(l);return n.initialize(e),n})},Object.defineProperty(t.prototype,"currentSpeed",{get:function(){return this._basicSpeed+this._extraSpeed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"healthValue",{get:function(){return this._healthValue[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOffscreen",{get:function(){var e=this.node.getBoundingBoxToWorld();return e.yMax<0?-1:e.yMin>=cc.Canvas.instance.node.height?1:0},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.explosion.getComponent(cc.Animation).on("finished",function(){e.node.active=!1,e.explosion.active=!1,l._instancePool.push(e.node)}),this.hitting.getComponent(cc.Animation).on("finished",function(){e.hitting.active=!1})},t.prototype.start=function(){},t.prototype.update=function(e){if(!r.isGamePaused){if(r.isGameEnded&&(e*=.1),this._vehicleType<=o.VehicleType.NORMAL_BLUE)if(c.bonusFlag&&!this.goldenGlowing.active)this.goldenGlowing.active=!0,(t=this.vehicleImage.getComponent(cc.Sprite)).spriteFrame=this.goldenVehicle,this.vehicleShadow.getComponent(cc.Sprite).spriteFrame=this.goldenVehicle,this.node.scale=.6,this._vehicleType==o.VehicleType.NORMAL_RED?(this._healthValue[0]/=3,this._healthValue[1]/=3):this._vehicleType==o.VehicleType.NORMAL_BLUE&&(this._healthValue[0]/=2,this._healthValue[1]/=2);else if(!c.bonusFlag&&this.goldenGlowing.active){var t;this.goldenGlowing.active=!1,(t=this.vehicleImage.getComponent(cc.Sprite)).spriteFrame=o.npcCars[this._vehicleType],this.vehicleShadow.getComponent(cc.Sprite).spriteFrame=t.spriteFrame,this.node.scale=this.org_scale,this._vehicleType==o.VehicleType.NORMAL_RED?this._healthValue[1]*=3:this._vehicleType==o.VehicleType.NORMAL_BLUE&&(this._healthValue[1]*=2)}var n=r.default.instance.currentLevel;switch(this._basicSpeed=n<=2?30:n<=6?40:50,this.isOffscreen){case-1:this.node.active=!1,l._instancePool.push(this.node);break;case 1:this._basicSpeed=0}this.node.y+=e*this.currentSpeed*1e3*o.PTMRatio/60/60}},t.prototype.onDestroy=function(){var e=this;l._instancePool=l._instancePool.filter(function(t){return t!=e.node})},t.prototype.onCollisionEnter=function(e,t){if("racing_car"==e.node.name){if(this._healthValue[0]>0){var o=e.node.getBoundingBoxToWorld(),i=t.node.getBoundingBoxToWorld();o.center.y<=i.center.y&&this.onExplosion()}e.getComponent("RacingCar").isInvincible&&(this._healthValue[0]=0,this.node.parent.emit(n.VEHICLE_EVT_EXPLOSION,this.node,this._vehicleType))}else e.node.name.startsWith("sprite_bullet")&&(this.isOffscreen||this.onBulletHitting(e.node,c.bulletDamage))},t.prototype.onCollisionStay=function(){},t.prototype.onCollisionExit=function(){},t.prototype.explode=function(){this._healthValue[0]=0,this.onExplosion(),this.node.parent.emit(n.VEHICLE_EVT_EXPLOSION,this.node,this._vehicleType,!0)},t.prototype.onExplosion=function(){this._vehicleType==o.VehicleType.EXPLOSIVE?i.cocos.audio.playEffect("Sounds/explosion"):i.cocos.audio.playEffect("Sounds/breaking"),this.healthBar.progress=0,this.healthBar.node.opacity=0,this.explosion.active=!0,this.explosion.getComponent(cc.Animation).play(),this.vehicleImage.active=!1,this.vehicleShadow.active=!1},t.prototype.initialize=function(e){var t;switch(e){case o.VehicleType.NORMAL_GRAY:t=s.utils.randomObj([1,11,12]);break;case o.VehicleType.NORMAL_RED:t=s.utils.randomObj([2,21]);break;case o.VehicleType.NORMAL_BLUE:t=s.utils.randomObj([3,31]);break;default:t=e}this.vehicleImage.getComponent(cc.Sprite).spriteFrame=o.npcCars[t],this.vehicleShadow.getComponent(cc.Sprite).spriteFrame=o.npcCars[t],this.goldenGlowing.active=!1,this.vehicleImage.getComponent(cc.Animation).stop();var n=4,i=o.g_vehicleHealthRateFormula(r.default.instance.currentLevel);switch(e){case o.VehicleType.NORMAL_GRAY:n*=1*i,this.node.scale=.7;break;case o.VehicleType.NORMAL_RED:n*=3*i,this.node.scale=.6;break;case o.VehicleType.NORMAL_BLUE:n*=2*i,this.node.scale=.7;break;case o.VehicleType.ITEMS:n*=1*i,this.node.scale=.65;break;case o.VehicleType.EXPLOSIVE:n*=2*i,this.node.scale=.8;break;case o.VehicleType.COINS:this.node.scale=.6,n*=4*i;break;case o.VehicleType.TRAILER:n*=5*i,this.node.scale=.6;break;default:this.node.scale=.6}this.org_scale=this.node.scale,this._vehicleType=e,this._healthValue=[n,n],this.vehicleImage.active=!0,this.vehicleShadow.active=!0,this.healthBar.node.opacity=0,this.healthBar.progress=1;var a=this.vehicleImage.getContentSize();this.node.setContentSize(a.width,a.height),this.healthBar.node.y=-a.height/2-30,this.node.getComponent(cc.BoxCollider).size=this.node.getContentSize()},t.prototype.onBulletHitting=function(e,t){if(this._healthValue[0]>0){if(this.healthBar.node.opacity=255,this._healthValue[0]-=t,this.healthBar.progress=this._healthValue[0]/this._healthValue[1],e.stopAllActions(),e.active=!1,!this.hitting.active){var o=this.node.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.getPosition()));this.hitting.setPosition(o.x,o.y+60),this.hitting.active=!0,this.hitting.getComponent(cc.Animation).play()}this._healthValue[0]<=0&&(this._healthValue[0]=0,this.onExplosion(),this.node.parent.emit(n.VEHICLE_EVT_EXPLOSION,this.node,this._vehicleType))}},t._instancePool=new Array,__decorate([h(cc.Node)],t.prototype,"vehicleImage",void 0),__decorate([h(cc.Node)],t.prototype,"vehicleShadow",void 0),__decorate([h(cc.Node)],t.prototype,"goldenGlowing",void 0),__decorate([h(cc.Node)],t.prototype,"collision",void 0),__decorate([h(cc.Node)],t.prototype,"explosion",void 0),__decorate([h(cc.Node)],t.prototype,"hitting",void 0),__decorate([h(a.default)],t.prototype,"healthBar",void 0),__decorate([h(cc.SpriteFrame)],t.prototype,"goldenVehicle",void 0),l=__decorate([d],t)}(cc.Component);n.default=u,cc._RF.pop()},{CustomProgressBar:"CustomProgressBar",GameScene:"GameScene",Global:"Global",RacingCar:"RacingCar",libcocos:"libcocos",libutils:"libutils"}],CustomProgressBar:[function(e,t,n){"use strict";cc._RF.push(t,"85d0eDo0xhKo57Bxn5EOOBj","CustomProgressBar"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._progress=0,t.progressMask=null,t.lightingNode=null,t.progressSprite=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"progress",{get:function(){return this._progress},set:function(e){e<0?e=0:e>1&&(e=1),this.progressMask.node.width=this.progressSprite.node.width*e,this.lightingNode&&(this.lightingNode.x=this.progressMask.node.x+this.progressMask.node.width)},enumerable:!1,configurable:!0}),__decorate([a(cc.Mask)],t.prototype,"progressMask",void 0),__decorate([a(cc.Node)],t.prototype,"lightingNode",void 0),__decorate([a(cc.Sprite)],t.prototype,"progressSprite",void 0),__decorate([i],t)}(cc.Component);n.default=r,cc._RF.pop()},{}],DebugSelfRotation:[function(e,t,n){"use strict";cc._RF.push(t,"e82c65PCHhE96i/MQLCX0SJ","DebugSelfRotation"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass;o.property;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){this.node.runAction(cc.repeatForever(cc.rotate3DBy(8,0,360,0)))},__decorate([i],t)}(cc.Component);n.default=a,cc._RF.pop()},{}],DialogMenu:[function(e,t,n){"use strict";cc._RF.push(t,"2e429is1NZA37aP41vsmNWi","DialogMenu"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("Panel"),i=cc._decorator,a=i.ccclass,r=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.titleLabel=null,t.contentLabel=null,t.sp_title=null,t.sp_content=null,t.title_sps=[],t.content_sps=[],t}return __extends(t,e),t.prototype.onLoad=function(){this.node.on(o.PANEL_EVT_SHOW,this.onPanelShow,this)},t.prototype.onPanelShow=function(e,t){this.titleLabel&&(this.titleLabel.string=e),this.contentLabel.string=t,this.sp_title&&("\u683c\u4f4d\u5df2\u6ee1"==e?(this.titleLabel.string="",this.sp_title.spriteFrame=this.title_sps[0]):this.sp_title.spriteFrame=null),this.sp_content&&("\u60a8\u662f\u5426\u53c8\u8981\u5c06\u7b49\u7ea7\u6700\u4f4e\u7684\u8f66\u8f86\u56de\u6536?"==t?(this.contentLabel.string="",this.sp_content.spriteFrame=this.content_sps[0]):this.sp_content.spriteFrame=null)},__decorate([r(cc.Label)],t.prototype,"titleLabel",void 0),__decorate([r(cc.Label)],t.prototype,"contentLabel",void 0),__decorate([r(cc.Sprite)],t.prototype,"sp_title",void 0),__decorate([r(cc.Sprite)],t.prototype,"sp_content",void 0),__decorate([r([cc.SpriteFrame])],t.prototype,"title_sps",void 0),__decorate([r([cc.SpriteFrame])],t.prototype,"content_sps",void 0),__decorate([a],t)}(cc.Component);n.default=c,cc._RF.pop()},{Panel:"Panel"}],DisplayBox:[function(e,t,n){"use strict";cc._RF.push(t,"60e57Rgo+pLfIEiRvjivnDI","DisplayBox"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("Global"),i=cc._decorator,a=i.ccclass,r=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._carLevel=0,t._carLevelInChest=0,t.carSprite=null,t.backlightSprite=null,t.highlightSprite=null,t.carLevelLabel=null,t.chestFrame=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"carImage",{get:function(){return this._carLevelInChest?o.presetCars[this._carLevelInChest].perspective:o.presetCars[this._carLevel].perspective},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlight",{get:function(){return 0!=this.highlightSprite.node.getNumberOfRunningActions()},set:function(e){e!=this.highlight&&(e?(this.highlightSprite.node.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.4),cc.fadeOut(.4),cc.fadeIn(.4),cc.fadeOut(.4)))),this.carSprite.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(.4),cc.moveBy(.1,-10,0),cc.moveBy(.1,10,0),cc.moveBy(.1,-10,0),cc.moveBy(.1,10,0))))):(this.highlightSprite.node.stopAllActions(),this.highlightSprite.node.opacity=0,this.carSprite.node.stopAllActions(),this.carSprite.node.x=0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dragging",{get:function(){return 150==this.carSprite.node.opacity},set:function(e){this.carSprite.node.opacity=e?150:255},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"composing",{get:function(){return!this.carSprite.node.active},set:function(e){this.carSprite.node.active=!e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"carLevel",{get:function(){return this._carLevel},set:function(e){this._carLevel=e,0==e?(this.carSprite.spriteFrame=null,this.carLevelLabel.string=""):-1==e?(this.carSprite.spriteFrame=this.chestFrame,this.carLevelLabel.string=""):(this.carSprite.spriteFrame=o.presetCars[e].perspective,this.carLevelLabel.string=""+e)},enumerable:!1,configurable:!0}),t.prototype.highlightOnce=function(){this.highlightSprite.node.runAction(cc.sequence(cc.fadeIn(.4),cc.fadeOut(.4),cc.fadeIn(.4),cc.fadeOut(.4))),this.carSprite.node.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.1,-10,0),cc.moveBy(.1,10,0),cc.moveBy(.1,-10,0),cc.moveBy(.1,10,0)))},t.prototype.openChest=function(e){var t=this;this._carLevelInChest=e,this.carSprite.node.runAction(cc.sequence(cc.sequence(cc.moveBy(.03,10,0),cc.moveBy(.06,-20,0),cc.moveBy(.03,10,0)),cc.callFunc(function(){t._carLevelInChest=0,t.carLevel=e}),cc.sequence(cc.moveBy(.03,10,0),cc.moveBy(.06,-20,0),cc.moveBy(.03,10,0))))},__decorate([r(cc.Sprite)],t.prototype,"carSprite",void 0),__decorate([r(cc.Sprite)],t.prototype,"backlightSprite",void 0),__decorate([r(cc.Sprite)],t.prototype,"highlightSprite",void 0),__decorate([r(cc.Label)],t.prototype,"carLevelLabel",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"chestFrame",void 0),__decorate([a],t)}(cc.Component);n.default=c,cc._RF.pop()},{Global:"Global"}],DisplayStage:[function(e,t,n){"use strict";cc._RF.push(t,"3511c9ba59DrqKZWtWRY+mm","DisplayStage"),Object.defineProperty(n,"__esModule",{value:!0}),n.DS_EVT_ATTRIBUTES=n.DS_EVT_RANK_LIST=n.DS_EVT_START_ACTION=n.DS_EVT_START_GAME=void 0;var o=e("Global"),i=cc._decorator,a=i.ccclass,r=i.property;n.DS_EVT_START_GAME="on-game-button",n.DS_EVT_START_ACTION="on-action-button",n.DS_EVT_RANK_LIST="on-rank-list-button",n.DS_EVT_ATTRIBUTES="on-attributes-button";var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._carLevel=0,t._nextLevel=0,t.carSprite=null,t.backlightSprite=null,t.carLevelLabel=null,t.carNameLabel=null,t.nextLevelLabel=null,t.levelStatusNode=null,t.startGameButton=null,t.actionGameButton=null,t.rankListButton=null,t.attributesButton=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"carLevel",{get:function(){return this._carLevel},set:function(e){this._carLevel=e,this.carSprite.spriteFrame=e?o.presetCars[e].perspective:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextLevel",{get:function(){return this._nextLevel},set:function(e){this._nextLevel=e,this.updateLevelStatus(e)},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.startGameButton.node.on("click",function(){e.node.emit(n.DS_EVT_START_GAME,e._nextLevel)}),this.actionGameButton.node.on("click",function(){e.node.emit(n.DS_EVT_START_ACTION)}),this.rankListButton.node.on("click",function(){e.node.emit(n.DS_EVT_RANK_LIST)}),this.attributesButton.node.on("click",function(){e.node.emit(n.DS_EVT_ATTRIBUTES)})},t.prototype.start=function(){var e=this.carSprite.node;e.opacity=0,e.runAction(cc.fadeIn(.6))},t.prototype.updateLevelStatus=function(e){var t=this.levelStatusNode.children.slice(),n=t.map(function(e){return e.children[0].getComponent(cc.Label)}),o=this.levelStatusNode.getChildByName("sprite_cash_bubble"),i=this.levelStatusNode.getChildByName("sprite_boss_bubble");if(e<=2){for(var a=0;a<5;++a)n[a].string=""+(a+1),t[a].color=a+1==e?cc.Color.WHITE:cc.Color.BLACK;o.position=t[4].position}else for(a=0;a<5;++a)n[a].string=""+(e-2+a),t[a].color=2==a?cc.Color.WHITE:cc.Color.BLACK,(e-2+a)%10==0?(i.position=t[a].position,i.opacity=255,o.opacity=0):(e-2+a)%10==5&&(o.position=t[a].position,i.opacity=0,o.opacity=255)},__decorate([r(cc.Sprite)],t.prototype,"carSprite",void 0),__decorate([r(cc.Sprite)],t.prototype,"backlightSprite",void 0),__decorate([r(cc.Label)],t.prototype,"carLevelLabel",void 0),__decorate([r(cc.Label)],t.prototype,"carNameLabel",void 0),__decorate([r(cc.Label)],t.prototype,"nextLevelLabel",void 0),__decorate([r(cc.Node)],t.prototype,"levelStatusNode",void 0),__decorate([r(cc.Button)],t.prototype,"startGameButton",void 0),__decorate([r(cc.Button)],t.prototype,"actionGameButton",void 0),__decorate([r(cc.Button)],t.prototype,"rankListButton",void 0),__decorate([r(cc.Button)],t.prototype,"attributesButton",void 0),__decorate([a],t)}(cc.Component);n.default=c,cc._RF.pop()},{Global:"Global"}],GameItem:[function(e,t,n){"use strict";cc._RF.push(t,"64215vubJRBrLovq5tDwFL3","GameItem"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("Global"),i=e("RacingCar"),a=e("libcocos"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemSprite=null,t.itemType=0,t}var n;return __extends(t,e),n=t,t.create=function(e,t){var o=this._instancePool[e];if(o&&o.length)var i=o.pop();else i=cc.instantiate(t).getComponent(n);return i.initialize(),i},t.remove=function(e){var t=this._instancePool;e.node.removeFromParent(!1),t[e.type]||(t[e.type]=[]),t[e.type].push(e)},Object.defineProperty(t.prototype,"type",{get:function(){return this.itemType},enumerable:!1,configurable:!0}),t.prototype.update=function(e){if(this.node.getBoundingBox().yMax<=0)n.remove(this);else{if(this._validityTimer>0&&(this._validityTimer-=e,this._validityTimer<=0&&(this._validityTimer=0,this.getComponent(cc.Collider).enabled=!0)),this._followingFlag){var t=this.node.getBoundingBoxToWorld().center,o=i.currentCarPosition.sub(t),a=o.mag(),r=1500*e,c=o.mul(r/a),s=c.x,l=c.y;this.node.x+=s,this.node.y+=l}this.gravitySpeed&&this.initialSpeed&&(Math.abs(this.node.x)>260&&(this.node.x=this.node.x>0?260:-260,this.initialSpeed.x*=-1),this.gravitySpeed.y-=9.8*50*e,this.node.x+=this.initialSpeed.x*e,this.node.y+=this.initialSpeed.y*e+this.gravitySpeed.y*e)}},t.prototype.onCollisionEnter=function(e,t){var r=this;i.magnetFlag&&"node_magnet_area"==e.node.name&&(this.initialSpeed=null,this.gravitySpeed=null,this._followingFlag=!0),"racing_car"==e.node.name&&(this.initialSpeed=null,this.gravitySpeed=null,this._followingFlag=!1,this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){return n.remove(r)}))),t.enabled=!1,this.itemType==o.ItemType.COIN||this.itemType==o.ItemType.DIAMOND?a.cocos.audio.playEffect("Sounds/gold_coin"):a.cocos.audio.playEffect("Sounds/item"))},t.prototype.initialize=function(){this.node.opacity=255,this.node.scale=1,this.itemSprite.node.y=this.node.height/2,this._followingFlag=!1,this.initialSpeed=cc.v2(0,0),this.gravitySpeed=cc.v2(0,0),this._validityTimer=.2,this.getComponent(cc.Collider).enabled=!1},t._instancePool=[],__decorate([s(cc.Sprite)],t.prototype,"itemSprite",void 0),__decorate([s({type:cc.Enum(o.ItemType)})],t.prototype,"itemType",void 0),n=__decorate([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{Global:"Global",RacingCar:"RacingCar",libcocos:"libcocos"}],GameScene:[function(e,t,n){"use strict";cc._RF.push(t,"8d96b0//5FO9prCnxIn8QY4","GameScene");var o=void 0;Object.defineProperty(n,"__esModule",{value:!0}),n.GAME_EVT_FAILURE=n.GAME_EVT_VICTORY=n.isCashLevel=n.isBossLevel=n.isGamePaused=n.isGameEnded=void 0;var i=e("RacingCar"),a=e("RacingRoad"),r=e("Panel"),c=e("libcocos"),s=e("CustomProgressBar"),l=e("libutils"),d=e("MainScene"),h=e("Global"),u=e("CommonVehicle"),p=e("libwechat"),_=e("libwechat_review"),g=e("gameline"),m=e("gamewall"),f=e("adBox"),v=e("redPack"),w=e("redPackIcon"),y=e("gameRecord"),b=cc._decorator,C=b.ccclass,S=b.property;n.isGameEnded=!1,n.isGamePaused=!1,n.isBossLevel=!1,n.isCashLevel=!1,n.GAME_EVT_VICTORY="on-game-victory",n.GAME_EVT_FAILURE="on-game-failure";var P=[function(e){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(){return e.spawnFlyingBomb(l.utils.randomInt(0,5)),[2]})})},function(e){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(){return e.spawnFlyingBomb(0),e.spawnFlyingBomb(4),[2]})})},function(e){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(){return e.spawnFlyingBomb(1),e.spawnFlyingBomb(3),[2]})})},function(e){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(){return e.spawnFlyingBomb(0),e.spawnFlyingBomb(2),e.spawnFlyingBomb(4),[2]})})},function(e){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(){return e.spawnFlyingBomb(1),e.spawnFlyingBomb(2),e.spawnFlyingBomb(3),[2]})})}],B=__spreadArrays(P,[function(e){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e.spawnFlyingBomb(0),e.spawnFlyingBomb(4),[4,c.cocos.asyncwait(500)];case 1:return t.sent(),e.spawnFlyingBomb(1),e.spawnFlyingBomb(3),[2]}})})},function(e){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e.spawnFlyingBomb(0),e.spawnFlyingBomb(4),[4,c.cocos.asyncwait(800)];case 1:return t.sent(),e.spawnFlyingBomb(1),e.spawnFlyingBomb(3),[4,c.cocos.asyncwait(600)];case 2:return t.sent(),e.spawnFlyingBomb(2),[2]}})})},function(e){return __awaiter(o,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:t=4,n.label=1;case 1:return t>=0?(e.spawnFlyingBomb(t),0==t?[3,4]:[4,c.cocos.asyncwait(800)]):[3,4];case 2:n.sent(),n.label=3;case 3:return--t,[3,1];case 4:return[2]}})})},function(e){return __awaiter(o,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:t=0,n.label=1;case 1:return t<5?(e.spawnFlyingBomb(t),4==t?[3,4]:[4,c.cocos.asyncwait(800)]):[3,4];case 2:n.sent(),n.label=3;case 3:return++t,[3,1];case 4:return[2]}})})}]),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.game_icon=null,t.game_wall=null,t.game_line=null,t._bannerTime=0,t._banner_active=!1,t._bombInterval=0,t._isSpawningBombs=0,t.uiContainer=null,t.racingCar=null,t.racingRoad=null,t.levelProgressBar=null,t.levelLabel=null,t.coinsLabel=null,t.levelHintingLabel=null,t.bombWarnings=[],t.bombs=[],t.levelProgressCar=null,t}var o;return __extends(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return cc.Canvas.instance.getComponent(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentLevel",{get:function(){return this._currentLevel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"carLevel",{get:function(){return this.racingCar.level},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e,t){this.racingCar.level=t,this.levelLabel.string="Lv."+e,this.levelHintingLabel.string="\u5173\u5361 "+e,this.levelHintingLabel.node.opacity=0,this.levelHintingLabel.node.scale=0,this.levelHintingLabel.node.runAction(cc.sequence(cc.spawn(cc.fadeIn(.5),cc.scaleTo(.5,.6).easing(cc.easeBackOut())),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.scaleTo(.5,0).easing(cc.easeBackIn())))),this._isSpawningBombs=h.g_presetLevelFormula(e).isSpawningBombs,this._isRevived=0,this._currentLevel=e,this._timeUsing=0,this._destroyingCount=0,this._bannerTime=0,n.isBossLevel=e%10==0,n.isCashLevel=e%10==5,console.log("Level-"+e+" Car-"+t),console.log("Enemy basic health: ",4*h.g_vehicleHealthRateFormula(e)),console.log("Bullet damage: ",h.g_bulletDamageFormula(this.racingCar.cannonLevel))},t.prototype.onLoad=function(){var e=this;this.node.getChildByName("node_main_area").getChildByName("btn-gamewall").active=!1,p.wechat.hideBannerAd().then(function(){_.wechat_review.isReview||(p.wechat.showBannerAd(),setTimeout(function(){n.isGamePaused||p.wechat.hideBannerAd()},1500))}),g.default.hideLine(),this.node.on(cc.Node.EventType.TOUCH_START,this.racingCar.onTouchBegan,this.racingCar),this.node.on(cc.Node.EventType.TOUCH_END,this.racingCar.onTouchEnded,this.racingCar),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.racingCar.onTouchMoved,this.racingCar),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.racingCar.onTouchEnded,this.racingCar),this.node.on(n.GAME_EVT_VICTORY,function(){n.isGameEnded||(n.isGameEnded=!0,c.cocos.loadRes("sahua_00",cc.Prefab).then(function(t){var n=cc.instantiate(t),o=cc.instantiate(t);e.node.addChild(n),e.node.addChild(o),n.y=-272,o.y=-272,o.scaleX=1,o.x=-n.x}),e.scheduleOnce(function(){y.gameRecord.stopRecord(function(t){console.log("on gameRecord stop",t),e.scheduleOnce(function(){n.isGamePaused=!0,e.showVictoryPanel(t)},1)})},.5))}),this.node.on(n.GAME_EVT_FAILURE,function(){n.isGameEnded||(n.isGameEnded=n.isGamePaused=!0,e.scheduleOnce(function(){e.showRevivePanel()},1))}),this.node.on(u.VEHICLE_EVT_EXPLOSION,function(){e._destroyingCount+=1}),this.racingCar.node.on(i.CAR_EVT_GETTING_COIN,function(){e.coinsLabel.node.getNumberOfRunningActions()||e.coinsLabel.node.runAction(cc.sequence(cc.scaleTo(.12,1.5),cc.scaleTo(.12,1))),e.coinsLabel.string=""+e.racingCar.collectedCoins})},t.prototype.getSinglePos=function(){return this.node.getChildByName("node_main_area").getChildByName("game_icon").getPosition()},t.prototype.onBtnShowGameWall=function(){var e=this;cc.clicked_gamewall=!0,this.node.getChildByName("node_main_area").getChildByName("btn-gamewall").children[0].active=!1,this.game_wall?this.game_wall.show():m.default.load().then(function(t){e.game_wall=t.getComponent("gamewall"),e.node.addChild(t),e.game_wall.show()}),p.wechat.hideRightupNative(),this.game_icon&&(this.game_icon.active=!1),p.wechat.showBannerAd(),n.isGamePaused=!0},t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){var e,t,o=this;return __generator(this,function(i){switch(i.label){case 0:return p.wechat.showVersion(this.node),y.gameRecord.startRecord(300),cc.director.getCollisionManager().enabled=!0,this.game_icon=this.node.getChildByName("node_main_area").getChildByName("game_icon"),n.isGameEnded=n.isGamePaused=!1,c.cocos.audio.playMusic("Sounds/game_scene_music"),c.cocos.audio.setMusicVolume(1),this._racingRoadScale=cc.Canvas.instance.node.width/640*.9,this.node.on("close-native",function(){p.wechat.getConfig("no_single")||(o.game_icon.active=!0)}),e=!1,this.node.on("show-line",function(){console.log("## show-line",e),_.wechat_review.isReview||(e?console.log("show-line, game wall active"):!_.wechat_review.isReview&&g.default.showLine()||p.wechat.getConfig("no_line")||(o.game_line?(o.game_line.active=!0,console.log("show-line, done")):(console.log("show-line, load"),g.default.load().then(function(e){console.log("show-line, loaded"),o.game_line=e,o.node.addChild(e),e.y=407}))))}),this.node.on("hide-line",function(){console.log("## hide-line"),o.game_line&&(o.game_line.active=!1),g.default.hideLine()}),this.node.on("hide-wall",function(t){console.log("## hide-wall"),p.wechat.showRightupNative(null,function(){p.wechat.getConfig("no_single")||(o.game_icon.active=!0)},o.game_icon),"continue"==t?o.node.emit("show-line"):(e=!1,p.wechat.hideBannerAd(),n.isGameEnded||(n.isGamePaused=!1))}),this.node.getChildByName("node_main_area").getChildByName("btn-gamewall").children[0].active=!cc.clicked_gamewall,_.wechat_review.isReview?(p.wechat.hideRightupNative(),this.game_icon.active=!1):(this.game_icon.active=!p.wechat.getConfig("no_single"),p.wechat.showRightupNative(function(){o.game_icon.active=!1},function(){p.wechat.getConfig("no_single")?o.game_icon.active=!1:o.game_icon.active=!0},this.game_icon)),this.node.on("show-continue",function(){console.log("show-continue"),e=!0,p.wechat.getConfig("new_gamewall")&&(o.game_wall?o.game_wall.show("continue"):m.default.load().then(function(e){o.game_wall=e.getComponent("gamewall"),o.node.addChild(e),o.game_wall.show("continue")})),o.node.emit("hide-line"),p.wechat.hideRightupNative(),o.game_icon.active=!1,p.wechat.showBannerAd(),p.wechat.getConfig("new_gamewall")&&o.node.emit("hide-wall","continue")}),_.wechat_review.isReview||!p.wechat.getConfig("hongbao")?[3,2]:((t=this.node.getChildByName("node_main_area").getChildByName("btn-gamewall").getPosition()).x+=20,[4,w.default.showIcon(this.node.getChildByName("node_main_area"),t)]);case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.update=function(e){var t=this,o=this.racingRoad,i=this.racingCar;if(this.levelProgressBar.progress=o.levelProgress,this.racingCar.extraSpeedPercentage=o.levelProgress,this.levelProgressCar.x=362*o.levelProgress-206,o.node.scale=this._racingRoadScale-(i.node.y-300)/300*.15,!n.isGameEnded&&!n.isGamePaused){this._timeUsing+=e,this._bannerTime+=e,p.wechat.getConfig("play_banner")&&this._bannerTime>10&&!_.wechat_review.isReview&&(this._bannerTime=0,p.wechat.showBannerAd().then(function(){t._banner_active=!0,setTimeout(function(){t._banner_active&&(p.wechat.hideBannerAd(),t._bannerTime=0,t._banner_active=!1)},1e3)}));var a=this._isSpawningBombs;a&&this._bombInterval>5?(this._bombInterval=0,Math.random()<.4&&(c.cocos.audio.playEffect("Sounds/warning"),1==a?l.utils.randomObj(P)(this):l.utils.randomObj(B)(this))):this._bombInterval+=e}},t.prototype.spawnFlyingBomb=function(e){var t=this.bombWarnings[e],n=this.bombs[e];if(n.active)console.warn("Too many bombs at the same time and the same track.");else{t.active=!0,t.opacity=255;var o=t.children[0];t.children[1].runAction(cc.blink(1,3)),o.scale=1,o.opacity=255,o.runAction(cc.sequence(cc.scaleTo(1,.1,2),cc.blink(1,2),cc.callFunc(function(){t.runAction(cc.fadeOut(1)),n.active=!0,n.zIndex=1e3,n.y=n.parent.convertToNodeSpaceAR(t.parent.convertToWorldSpaceAR(t.getPosition())).y,n.stopAllActions(),n.runAction(cc.sequence(cc.moveBy(6,0,-t.y),cc.callFunc(function(){n.active=!1,t.active=!1})))})))}},t.prototype.showRevivePanel=function(){var e=this;this._banner_active=!1,p.wechat.showBannerAd(),this.node.emit("show-line");var t=this.racingRoad.levelProgress;r.default.showWithPromise({path:"revive"},{counting:0,type:0==this._isRevived?"video":"share"}).then(function(o){o?(e._isRevived+=1,e.racingCar.doRevive(),n.isGameEnded=n.isGamePaused=!1,e.node.emit("hide-line"),p.wechat.hideBannerAd()):e.showFailurePanel(t)})},t.prototype.showVictoryPanel=function(e){var t=this;void 0===e&&(e=null),this._banner_active=!1,console.log("showVictoryPanel",e),_.wechat_review.isReview?(this.node.emit("show-line"),p.wechat.showBannerAd()):(g.default.hideLine(),this.game_line&&(this.game_line.active=!1),f.default.checkAdBox()?(p.wechat.hideBannerAd(),this.node.once("showBanner",function(){console.log("---------------showBannerAd once showBanner");var e=p.wechat.getConfig("ad_box_type")||1;console.log("-------ad_box type",e),1==e?p.wechat.showCustomBanner("ad_box"):p.wechat.showBannerAd("ad_box"),t.node.emit("show-line")}),p.wechat.getConfig("hongbao")?v.default.load().then(function(e){t.node.addChild(e),e.getComponent(v.default).show()}):f.default.load().then(function(e){t.node.addChild(e),e.getComponent(f.default).adBoxShow()})):this.node.emit("show-continue")),c.cocos.audio.stopMusic(),c.cocos.audio.playEffect("Sounds/victory");var n=this._currentLevel,o=Math.floor(this._timeUsing),i=this._destroyingCount,a=this.racingCar.collectedCoins,s=d.default.profitPerSecond*(a+i)*n*.05,l=this.racingCar.collectedChests,h=this.currentLevel;r.default.showWithPromise({path:"victory",animating:r.FadingCallback},{time:o,destroying:i,coins:a,cash:s,level:h,videoPath:e}).then(function(){cc.director.loadScene("MainScene",function(){d.default.instance.onLevelCompleted(n,!0,s,l)})})},t.prototype.showFailurePanel=function(e){var t=this;console.log("------------------showFailurePanel",e),c.cocos.audio.stopMusic(),c.cocos.audio.playEffect("Sounds/failure");var n=this._currentLevel,i=this.carLevel,a=this.racingCar.collectedCoins,s=d.default.profitPerSecond*a*n*.05;this.node.emit("show-line"),p.wechat.hideBannerAd().then(function(){p.wechat.showBannerAd()});var l=n;r.default.showWithPromise({path:"failure",animating:r.FadingCallback},{cash:s,level:l,progress:e}).then(function(e){e?cc.director.loadScene("GameScene",function(){o.instance.initialize(n,i)}):cc.director.loadScene("MainScene",function(){d.default.instance.onLevelCompleted(t._currentLevel,!1,s)})})},__decorate([S(cc.Node)],t.prototype,"uiContainer",void 0),__decorate([S(i.default)],t.prototype,"racingCar",void 0),__decorate([S(a.default)],t.prototype,"racingRoad",void 0),__decorate([S(s.default)],t.prototype,"levelProgressBar",void 0),__decorate([S(cc.Label)],t.prototype,"levelLabel",void 0),__decorate([S(cc.Label)],t.prototype,"coinsLabel",void 0),__decorate([S(cc.Label)],t.prototype,"levelHintingLabel",void 0),__decorate([S([cc.Node])],t.prototype,"bombWarnings",void 0),__decorate([S([cc.Node])],t.prototype,"bombs",void 0),__decorate([S(cc.Node)],t.prototype,"levelProgressCar",void 0),o=__decorate([C],t)}(cc.Component);n.default=N,cc._RF.pop()},{CommonVehicle:"CommonVehicle",CustomProgressBar:"CustomProgressBar",Global:"Global",MainScene:"MainScene",Panel:"Panel",RacingCar:"RacingCar",RacingRoad:"RacingRoad",adBox:"adBox",gameRecord:"gameRecord",gameline:"gameline",gamewall:"gamewall",libcocos:"libcocos",libutils:"libutils",libwechat:"libwechat",libwechat_review:"libwechat_review",redPack:"redPack",redPackIcon:"redPackIcon"}],Global:[function(e,t,n){"use strict";var o;cc._RF.push(t,"6b22b2QQDJJLIJgMxxmH3zv","Global"),Object.defineProperty(n,"__esModule",{value:!0}),n.g_presetLevelFormula=n.g_vehicleHealthRateFormula=n.g_shootingIntervalFormula=n.g_bulletDamageFormula=n.g_initialPriceFormula=n.g_recyclingFormula=n.g_profitingFormula=n.g_value2String=n.g_checkCollisionPoint=n.PTMRatio=n.npcCars=n.presetCars=n.ItemType=n.VehicleType=void 0;var i,a=e("libcocos");(i=o=n.VehicleType||(n.VehicleType={}))[i.NORMAL_GRAY=1]="NORMAL_GRAY",i[i.NORMAL_RED=2]="NORMAL_RED",i[i.NORMAL_BLUE=3]="NORMAL_BLUE",i[i.ITEMS=4]="ITEMS",i[i.EXPLOSIVE=5]="EXPLOSIVE",i[i.COINS=6]="COINS",i[i.TRAILER=7]="TRAILER",function(e){e[e.COIN=0]="COIN",e[e.DIAMOND=1]="DIAMOND",e[e.POWER=2]="POWER",e[e.N2O=3]="N2O",e[e.BONUS=4]="BONUS",e[e.CHEST=5]="CHEST",e[e.MAGNET=6]="MAGNET"}(n.ItemType||(n.ItemType={})),n.presetCars=new Array,n.npcCars=new Array,n.PTMRatio=50,n.g_checkCollisionPoint=function(e,t,n){void 0===n&&(n=5);for(var o=a.cocos.getWorldRectangle(e),i=a.cocos.getWorldRectangle(t),r=0;r<=n;++r){var c=o.center.lerp(i.center,r/n);if(o.contains(c)&&i.contains(c))return c}};var r=["","k","m","b","t","q","Q","s","S"];n.g_value2String=function(e){for(var t=0;t<r.length&&!(e<1e3);++t)e/=1e3;var n=e.toString().substr(0,4);return"."==n[3]?n.substr(0,3)+r[t]:n+r[t]},n.g_profitingFormula=function(e){return e<=0?0:1.2*Math.pow(2,e-1)},n.g_recyclingFormula=function(e){return e?5*Math.pow(8/3,e-1):0},n.g_initialPriceFormula=function(e){return e?10*Math.pow(8/3,e-1):0};var c=[1,1,1.5,1.8,2.5,6,6,9,11,15];n.g_bulletDamageFormula=function(e){var t=Math.pow(100,Math.floor((e-1)/10))*c[(e-1)%10];return e<=10&&(t*=2),t};var s=[.14,.12,.1,.08,.06,.14,.12,.1,.08,.06];n.g_shootingIntervalFormula=function(e){return s[(e-1)%10]};var l=[0,.1],d=[1.6,1.6,1.6,2,2,2,1.65,1.65,1.65,1.65,1.5,1.5,1.5,1.5,1.5,1.35,1.35,1.35,1.35,1.35];n.g_vehicleHealthRateFormula=function(e){if(l[e])return l[e];for(var t=1,n=1;n<e&&n<21;++n)t*=d[n-1];for(n=21;n<e&&n<31;++n)t*=1.2;for(n=31;n<e&&n<41;++n)t*=1.15;for(n=41;n<e&&n<51;++n)t*=1.11;for(n=51;n<e&&n<61;++n)t*=1.08;for(n=61;n<e&&n<71;++n)t*=1.06;for(n=71;n<e&&n<81;++n)t*=1.05;for(n=81;n<e&&n<91;++n)t*=1.04;for(n=91;n<e&&n<101;++n)t*=1.03;for(n=101;n<e;++n)t*=1.02;return l[e]=t,t},n.g_presetLevelFormula=function(e){switch(e){case 1:return{enemyWaves:10,isSpawningBombs:0,speedRange:[.7,1.2],enemies:[{type:o.NORMAL_GRAY,percentage:87},{type:o.NORMAL_BLUE,percentage:10},{type:o.EXPLOSIVE,percentage:3}]};case 2:return{enemyWaves:10,isSpawningBombs:0,speedRange:[.8,1.3],enemies:[{type:o.NORMAL_GRAY,percentage:87},{type:o.NORMAL_BLUE,percentage:10},{type:o.EXPLOSIVE,percentage:3}]};case 3:case 4:case 5:return{enemyWaves:13,isSpawningBombs:0,speedRange:[1,1.5],enemies:[{type:o.NORMAL_GRAY,percentage:79},{type:o.NORMAL_BLUE,percentage:10},{type:o.NORMAL_RED,percentage:8},{type:o.EXPLOSIVE,percentage:3}]};case 6:return{enemyWaves:13,isSpawningBombs:0,speedRange:[1,1.5],enemies:[{type:o.NORMAL_GRAY,percentage:74},{type:o.NORMAL_BLUE,percentage:10},{type:o.NORMAL_RED,percentage:8},{type:o.ITEMS,percentage:5},{type:o.EXPLOSIVE,percentage:3}]};case 7:return{enemyWaves:13,isSpawningBombs:1,speedRange:[1,1.5],enemies:[{type:o.NORMAL_GRAY,percentage:74},{type:o.NORMAL_BLUE,percentage:10},{type:o.NORMAL_RED,percentage:8},{type:o.ITEMS,percentage:5},{type:o.EXPLOSIVE,percentage:3}]};case 8:return{enemyWaves:13,isSpawningBombs:1,speedRange:[1,1.7],enemies:[{type:o.NORMAL_GRAY,percentage:71},{type:o.NORMAL_BLUE,percentage:10},{type:o.NORMAL_RED,percentage:8},{type:o.ITEMS,percentage:5},{type:o.EXPLOSIVE,percentage:3},{type:o.COINS,percentage:3}]};case 9:return{enemyWaves:13,isSpawningBombs:2,speedRange:[1,1.7],enemies:[{type:o.NORMAL_GRAY,percentage:71},{type:o.NORMAL_BLUE,percentage:10},{type:o.NORMAL_RED,percentage:8},{type:o.ITEMS,percentage:5},{type:o.EXPLOSIVE,percentage:3},{type:o.COINS,percentage:3}]};default:return{enemyWaves:13,isSpawningBombs:2,speedRange:[1,1.7],enemies:[{type:o.NORMAL_GRAY,percentage:70},{type:o.NORMAL_BLUE,percentage:10},{type:o.NORMAL_RED,percentage:8},{type:o.ITEMS,percentage:5},{type:o.EXPLOSIVE,percentage:3},{type:o.COINS,percentage:3},{type:o.TRAILER,percentage:1}]}}};var h=cc.Button.prototype.onLoad;cc.Button.prototype.onLoad=function(){h&&h(),this.node&&this.node.on("click",function(){return a.cocos.audio.playEffect("Sounds/button")})},cc._RF.pop()},{libcocos:"libcocos"}],ListView:[function(e,t,n){"use strict";cc._RF.push(t,"e2724gE1tVEDLE5VQhchbRW","ListView"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._length=0,t.resizable=!0,t.precreate=10,t.synchronous=!0,t.updatingStride=1,t.optimization=!1,t.optimizingStride=1,t.contianer=null,t.placeholder=null,t.scrollView=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(e){if(e<0)throw"INVALID_RANGE";if(this._length=e,this.placeholder&&(this.placeholder.active=!e),this.size<e)this.size=e;else{var t=this.nodes;if(this.synchronous){for(var n=0;n<e;++n)t[n].active=!0;for(n=e;n<t.length;++n)t[n].active=!1}else{for(n=e;n<t.length;++n)t[n].active=!1;var o=function(e){i.scheduleOnce(function(){return t[e].active=!0},e/60*i.updatingStride)},i=this;for(n=0;n<e;++n)o(n)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.nodes.length},set:function(e){if(!e)throw"INVALID_RANGE";if(!this.resizable)throw"READ_ONLY";for(var t=this.nodes,n=t.length;n<e;++n)cc.instantiate(t[0]).parent=t[0].parent;var o=t.slice(e,t.length-e);for(n=0;n<o.length;++n)o[n].destroy();this.length>e?this.length=e:this.length=this.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodes",{get:function(){return this.contianer.children},enumerable:!1,configurable:!0}),t.prototype.comps=function(e){return this.nodes.map(function(t){return t.getComponent(e)})},t.prototype.onLoad=function(){if(this.optimizingStride=Math.round(this.optimizingStride),this.updatingStride=Math.round(this.updatingStride),!this.nodes.length)throw"INVALID_RANGE";this.resizable&&(this.size=this.precreate),this.length=0,this.optimization&&(this.scrollView||(this.scrollView=this.node.getComponent(cc.ScrollView)),this.scrollView?(this.scrollView.node.on("scrolling",this.onDynamicOptimization,this),this._counting=this.optimizingStride-1,this.scheduleOnce(this.onDynamicOptimization,1/60)):console.error("Can not find the component cc.ScrollView. Reset the component or turn off the optimaztion of draw call."))},t.prototype.onDynamicOptimization=function(){if(++this._counting==this.optimizingStride){this._counting=0;var e=this.contianer.parent,t=e.getBoundingBox(),n=e.parent.convertToWorldSpaceAR(cc.v2(t.x,t.y));t.x=n.x,t.y=n.y;for(var o=0,i=this.contianer.children;o<i.length;o++){var a=i[o];a.opacity=t.intersects(a.getBoundingBoxToWorld())?255:0}}},__decorate([a],t.prototype,"resizable",void 0),__decorate([a({visible:function(){return this.resizable},step:1})],t.prototype,"precreate",void 0),__decorate([a({displayName:"Activate/Deactivate Synchronously"})],t.prototype,"synchronous",void 0),__decorate([a({visible:function(){return!this.synchronous},range:[1,60,1],slide:!0})],t.prototype,"updatingStride",void 0),__decorate([a({displayName:"Draw Call Optimization"})],t.prototype,"optimization",void 0),__decorate([a({visible:function(){return this.optimization},range:[1,20,1],slide:!0})],t.prototype,"optimizingStride",void 0),__decorate([a(cc.Node)],t.prototype,"contianer",void 0),__decorate([a(cc.Node)],t.prototype,"placeholder",void 0),__decorate([a({type:cc.ScrollView,visible:function(){return this.optimization}})],t.prototype,"scrollView",void 0),__decorate([i],t)}(cc.Component);n.default=r,cc._RF.pop()},{}],LoadingScene:[function(e,t,n){"use strict";cc._RF.push(t,"f4690rp9tFJxrpBqqX31k9B","LoadingScene"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("GameScene"),i=e("PresetCars"),a=e("Storage"),r=e("libcocos"),c=e("libwechat"),s=e("libwechat_review"),l=cc._decorator,d=l.ccclass,h=l.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadingBarMask=null,t.loadingBarSprite=null,t.loadingCard=null,t}return __extends(t,e),t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return console.log("-------cc.winSize",cc.winSize),(window.no_logo||window.no_title||window.hide_logo)&&(this.node.getChildByName("sprite_background").getChildByName("logo").active=!1),r.cocos.preloadScene("MainScene",function(t,n){var o=t/n*.75;e.progress=o}).then(function(){return i.g_loadCarResources(function(t,n){var o=t/n*.25+.75;e.progress=o})}).then(function(){return __awaiter(e,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return console.log("load main scene",s.wechat_review.isReview),[4,c.wechat.ensureConfigLoaded()];case 1:return t.sent(),!s.wechat_review.isReview&&c.wechat.getConfig("loaded_video")&&c.wechat.showRewardedVideoAd(),c.wechat.isMiniprogram()&&!s.wechat_review.isReview&&c.wechat.getConfig("gamestart_video")&&c.wechat.showInterstitialAd(),[4,a.g_loadStorage()];case 2:return!(e=t.sent())||e.enforceIntroducing>=0&&e.enforceIntroducing<=5?(this.node.getChildByName("sprite_background").getChildByName("btn_start").active=!0,this.node.getChildByName("sprite_background").getChildByName("sprite_loading_background").active=!1,this.node.getChildByName("sprite_background").getChildByName("label").active=!1,this.node.getChildByName("sprite_background").getChildByName("btn_start").on("click",function(){c.wechat.onNewGame(function(){setTimeout(function(){cc.director.loadScene("GameScene",function(){o.default.instance.initialize(1,1)})},0)})}),[2]):[2,cc.director.loadScene("MainScene")]}})})}),cc.sys.isNative?[2]:[4,c.wechat.ensureConfigLoaded()];case 1:return t.sent(),c.wechat.setClipBoard(),c.wechat.initialize(window.appid||"wx70d4b664b0969ac0",window["adunit-video"]||"adunit-d63cb6a5e482ce4b",window["adunit-banner"]||"adunit-8ba1c52ac9888668",window["adunit-interstitial"]||"adunit-6414377d821189ba",function(e,t){return{title:"\u6781\u54c1\u98de\u8f66\uff0c\u75af\u72c2\u8fc7\u5173\uff01",query:t,imageUrl:"https://detectivecdn.p8games.com/instantgame/share/car.jpg"}}),s.wechat_review.isReview||c.wechat.showBannerAd(),c.wechat.showVersion(this.node),[2]}})})},Object.defineProperty(t.prototype,"progress",{set:function(e){this.loadingBarMask.node.width=this.loadingBarSprite.node.width*e,this.loadingCard.x=472*e-250},enumerable:!1,configurable:!0}),__decorate([h(cc.Mask)],t.prototype,"loadingBarMask",void 0),__decorate([h(cc.Sprite)],t.prototype,"loadingBarSprite",void 0),__decorate([h(cc.Node)],t.prototype,"loadingCard",void 0),__decorate([d],t)}(cc.Component);n.default=u,cc._RF.pop()},{GameScene:"GameScene",PresetCars:"PresetCars",Storage:"Storage",libcocos:"libcocos",libwechat:"libwechat",libwechat_review:"libwechat_review"}],MainScene:[function(e,t,n){"use strict";cc._RF.push(t,"0bdcdMAkUJEwZ4xYcWiF3KJ","MainScene"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("DisplayBox"),i=e("DisplayStage"),a=e("Storage"),r=e("Global"),c=e("libcocos"),s=e("Panel"),l=e("GameScene"),d=e("libwechat"),h=e("libwechat_review"),u=e("gameline"),p=e("gamewall"),_=e("redPack"),g=e("redPackIcon"),m=e("adBox"),f=e("privacy"),v=cc._decorator,w=v.ccclass,y=v.property,b=0,C=0,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.game_icon=null,t.game_wall=null,t.game_line=null,t._recycleHighlight=!1,t._enforceComposing=!1,t._enforcePurchasing=!1,t._enforcePlaying=!1,t._enforceIntroducing=0,t._draggingNode=null,t._cashDeposit=100,t._nextLevel=1,t._listOfCars=new Array(12).fill(0),t._listOfPrices=[],t._highestCarLevel=1,t._carBeingEquipped=1,t._profitPerSecond=0,t._recommendedCar=1,t._levelCompletedData=null,t.storeButton=null,t.recycleButton=null,t.recommendedCarButton=null,t.recommendedCarSprite=null,t.recommendedCarLevelLabel=null,t.recommendedCarPriceLabel=null,t.cashDepositLabel=null,t.cashProfitingLabel=null,t.displayStage=null,t.displayBoxes=[],t.composingEffect=null,t.unlockingEffect=null,t.profitingLabels=[],t.headerProfitingLabels=[],t.debugResetStorageButton=null,t.bottomArea=null,t.headerArea=null,t.guidingHand=null,t.guidingArrow=null,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"profitPerSecond",{get:function(){return C},enumerable:!1,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return cc.Canvas.instance.getComponent(n)},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.node.getChildByName("node_main_area").getChildByName("btn-gamewall").active=!1,this.displayStage.node.on(i.DS_EVT_RANK_LIST,function(){}),this.displayStage.node.on(i.DS_EVT_START_ACTION,function(){}),this.displayStage.node.on(i.DS_EVT_START_GAME,function(){console.log("start game",!0),e._enforceComposing||e._enforcePurchasing||d.wechat.onNewGame(function(){setTimeout(function(){cc.director.loadScene("GameScene",function(){l.default.instance.initialize(e._nextLevel,e._carBeingEquipped)})},e._enforceIntroducing>=5?50:0)})}),this.displayStage.node.on(i.DS_EVT_ATTRIBUTES,function(){e._enforceComposing||e._enforcePurchasing||e._enforcePlaying||c.cocos.loadRes("Panels/attributes").then(function(t){cc.instantiate(t).getComponent(s.default).show({equipped:e._carBeingEquipped,maxLevel:e._highestCarLevel})})}),this.storeButton.node.on("click",function(){if(!(e._enforceComposing||e._enforcePurchasing||e._enforcePlaying)){var t=!1;s.default.showWithCallbacks({path:"store"},{onPanelShow:function(){switch(d.GAME_PLATFORM){case"wechat":h.wechat_review.isReview||d.wechat.showBannerAd().then(function(){t=!0,setTimeout(function(){t&&(d.wechat.hideBannerAd(),t=!1)},2e3)})}},onPanelHide:function(){switch(d.GAME_PLATFORM){case"wechat":t&&(d.wechat.hideBannerAd(),t=!1)}}},{listOfPrices:e._listOfPrices,maximumLevel:e._highestCarLevel})}}),this.recommendedCarButton.node.on("click",function(){e._enforceComposing||e._enforcePlaying||e.doPurchaseCar(e._recommendedCar)}),this.displayBoxes.forEach(function(t,n){var o=function(o){var i=e._draggingNode;if(-1!=e._listOfCars[n]){if(!(e._listOfCars[n]<=0))if(t.dragging=!1,i.removeFromParent(!1),e.recycleHighlight=!1,e.displayBoxes.forEach(function(e){return e.highlight=!1}),e.recycleButton.node.getBoundingBoxToWorld().contains(o.getLocation()))e.doRecycleCar(n);else{for(var a=e.displayBoxes.map(function(e){return e.node}),c=0;c<a.length&&!a[c].getBoundingBoxToWorld().contains(o.getLocation());++c);if(c!=a.length&&c!=n){var s=e._listOfCars,l=r.presetCars.length-1;s[c]&&s[n]==s[c]?s[n]<l&&e.doComposeCars(n,c):e.doReplaceCars(n,c)}}}else e.doOpenChest(n)};t.node.on(cc.Node.EventType.TOUCH_START,function(o){var i=e._draggingNode;e._listOfCars[n]<=0||(i?i.getComponent(cc.Sprite).spriteFrame=t.carImage:((i=e._draggingNode=new cc.Node("sprite_dragging")).addComponent(cc.Sprite).spriteFrame=t.carImage,i.scale=.5),t.dragging=!0,i.parent=cc.Canvas.instance.node,i.setPosition(i.parent.convertToNodeSpaceAR(o.touch.getLocation())),e._listOfCars.forEach(function(o,i){n!=i&&o==t.carLevel&&(e.displayBoxes[i].highlight=!0)}))}),t.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){var o=e._draggingNode;e._listOfCars[n]<=0||(e.recycleButton.node.getBoundingBoxToWorld().contains(t.getLocation())?e.recycleHighlight=!0:e.recycleHighlight=!1,o.setPosition(o.parent.convertToNodeSpaceAR(t.touch.getLocation())))}),t.node.on(cc.Node.EventType.TOUCH_END,o),t.node.on(cc.Node.EventType.TOUCH_CANCEL,o),t.node.getChildByName("sprite_displayed_car").scale=.4}),this.debugResetStorageButton.node.active=!1,this.debugResetStorageButton.node.on("click",function(){for(var t=[],n=1;n<r.presetCars.length;++n)t[n-1]=r.g_initialPriceFormula(n);e.storage={enforceIntroducing:0,carBeingEquipped:1,cashDeposit:100,highestCarLevel:1,listOfCars:new Array(12).fill(0),listOfPrices:t,nextLevel:1,timeStamp:0,version:1},cc.director.loadScene("MainScene")}),this.node.on("show-continue",function(){d.wechat.getConfig("new_gamewall")&&(e.game_wall?e.game_wall.show("continue"):p.default.load().then(function(t){e.game_wall=t.getComponent("gamewall"),e.node.addChild(t),e.game_wall.show("continue")})),e.node.emit("hide-line"),d.wechat.getConfig("new_gamewall")?e.node.emit("hide-wall","continue"):d.wechat.hideBannerAd()})},t.prototype.onBtnShowGameWall=function(){var e=this;cc.clicked_gamewall=!0,this.node.getChildByName("node_main_area").getChildByName("btn-gamewall").children[0].active=!1,this.game_wall?this.game_wall.show():p.default.load().then(function(t){e.game_wall=t.getComponent("gamewall"),e.node.addChild(t),e.game_wall.show()}),d.wechat.hideRightupNative(),this.game_icon&&(this.game_icon.active=!1),d.wechat.showBannerAd()},t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,o,i,s,l=this;return __generator(this,function(v){switch(v.label){case 0:for(setTimeout(function(){d.wechat.hideBannerAd()},1e3),u.default.init(window["adunit-line"]||"adunit-6e8043f8aed7d0f4",this.node.getChildByName("native-line")),u.default.hideLine(),p.default.init(window["adunit-wall"]||["adunit-4f78c2355bf7c032","adunit-a042381243f4dd0e"]),this.game_icon=this.node.getChildByName("node_main_area").getChildByName("game_icon"),this.node.on("close-native",function(){d.wechat.getConfig("no_single")||(l.game_icon.active=!0)}),this.node.on("show-line",function(){h.wechat_review.isReview||!h.wechat_review.isReview&&u.default.showLine()||d.wechat.getConfig("no_line")||(l.game_line?l.game_line.active=!0:u.default.load().then(function(e){l.game_line=e,l.node.addChild(e),e.y=407}))}),this.node.on("hide-line",function(){l.game_line&&(l.game_line.active=!1),u.default.hideLine()}),this.node.on("hide-wall",function(){d.wechat.showRightupNative(null,function(){d.wechat.getConfig("no_single")||(l.game_icon.active=!0)},l.game_icon),d.wechat.hideBannerAd()}),this.node.getChildByName("node_main_area").getChildByName("btn-gamewall").children[0].active=!cc.clicked_gamewall,h.wechat_review.isReview?(d.wechat.hideRightupNative(),this.game_icon.active=!1):(this.game_icon.active=!d.wechat.getConfig("no_single"),d.wechat.showRightupNative(function(){l.game_icon.active=!1},function(){d.wechat.getConfig("no_single")?l.game_icon.active=!1:l.game_icon.active=!0},this.game_icon)),c.cocos.audio.playMusic("Sounds/main_scene_music"),a.g_loadStorage().then(function(e){var t=Date.now();if(e){switch(e.version){case 0:e.enforceIntroducing=6}l.storage=e,t=e.timeStamp}else{for(var n=l._listOfPrices,o=1;o<r.presetCars.length;++o)n[o-1]=r.g_initialPriceFormula(o);a.g_saveStorage(l.storage)}var i=l._levelCompletedData;i&&(l._nextLevel=i.level,i.victory&&(l._nextLevel+=1),i.chest&&l.doSpawnChest(),l.doProfit(i.cash),a.g_saveStorage(l.storage),l._levelCompletedData=null),l.cashDepositLabel.string=r.g_value2String(l._cashDeposit),l.updateDisplayBoxes(),l.updateDisplayStage(),l.updateRecommendedCar(),l.doReceiveOfflineProfits(Date.now()-t),l.schedule(l.profitingScheduler,2,cc.macro.REPEAT_FOREVER,2),l.enforceIntroducing()}),e=this.displayBoxes,t=0;t<e.length;++t)e[t].node.opacity=0,e[t].node.runAction(cc.sequence(cc.delayTime(.1*t),cc.fadeIn(.4)));return(n=this.bottomArea).runAction(cc.moveBy(.6,0,n.height).easing(cc.easeSineOut())),(o=this.headerArea).runAction(cc.moveBy(.6,0,-o.height).easing(cc.easeSineOut())),c.cocos.preloadScene("GameScene").then(function(){console.log("Game scene loaded")}),h.wechat_review.isReview||!d.wechat.getConfig("hongbao")?[3,2]:((i=this.node.getChildByName("node_main_area").getChildByName("btn-gamewall").getPosition()).x+=20,[4,g.default.showIcon(this.node.getChildByName("node_main_area"),i)]);case 1:v.sent(),v.label=2;case 2:return m.default.checkStartAdBox()&&(this.node.once("showBanner",function(){console.log("---------------showBannerAd once showBanner");var e=d.wechat.getConfig("ad_box_type")||1;console.log("-------ad_box type",e),1==e?d.wechat.showCustomBanner("ad_box"):d.wechat.showBannerAd("ad_box"),l.node.emit("show-line")}),d.wechat.getConfig("hongbao")?_.default.load().then(function(e){l.node.addChild(e),e.getComponent(_.default).show()}):m.default.load().then(function(e){l.node.addChild(e),e.getComponent(m.default).adBoxShow()})),d.wechat.showVersion(this.node).y-=50,s=this.node,[4,f.default.show(s)];case 3:return v.sent(),"undefined"==typeof qq?(s.getChildByName("btn_protocol").active=!1,s.getChildByName("btn_privacy").active=!1):(s.getChildByName("btn_protocol").on("click",function(){f.default.showProtocol(s)}),s.getChildByName("btn_privacy").on("click",function(){console.log("btn show privacy"),f.default.showPrivacy(s)})),[2]}})})},t.prototype.onDestroy=function(){c.cocos.audio.stopMusic(),a.g_saveStorage(this.storage),this._draggingNode&&this._draggingNode.destroy()},t.prototype.doPurchaseCar=function(e,t){var n=this,o=t?0:this._listOfPrices[e-1];if(this._cashDeposit<o){var i=300*this._profitPerSecond,l=this;s.default.showWithCallbacks({path:"cashreward"},{onPanelShow:function(){console.log("---------------show cashreward"),l.node.getChildByName("node_main_area").getChildByName("game_icon").active=!1,h.wechat_review.isReview||d.wechat.showBannerAd(),l.node.emit("show-line")},onPanelHide:function(){d.wechat.hideBannerAd(),h.wechat_review.isReview||d.wechat.showRightupNative(null,function(){d.wechat.getConfig("no_single")||(l.game_icon.active=!0)},l.game_icon),l.node.emit("hide-line")},onButtonClick:function(t){var n=this;0==t&&d.wechat.showRewardedVideoAd().then(function(){l.doProfit(i),n.hide(),l._cashDeposit>=o&&l.doPurchaseCar(e)})}},"\u514d\u8d39\u94b1\u5e01",r.g_value2String(i))}else{for(var u=this._listOfCars,p=0;p<u.length&&u[p];++p);if(p!=u.length)this.cashDepositLabel.string=r.g_value2String(this._cashDeposit-=o),this._listOfCars[p]=e,this.updateDisplayBoxes(),c.cocos.audio.playEffect("Sounds/buy"),this._listOfPrices[e-1]*=1.2,this.updateRecommendedCar(),a.g_saveStorage(this.storage);else{for(var _=[],g=0,m=u;g<m.length;g++){var f=m[g];_[f]=_[f]||0,_[f]+=1}for(var v=0;v<_.length;++v)if(_[v]&&!(_[v]<2)){this.displayBoxes.forEach(function(e){e.carLevel!=v||e.highlight||e.highlightOnce()});break}v==_.length&&s.default.showWithPromise({path:"dialog"},"\u683c\u4f4d\u5df2\u6ee1","\u60a8\u662f\u5426\u53c8\u8981\u5c06\u7b49\u7ea7\u6700\u4f4e\u7684\u8f66\u8f86\u56de\u6536?").then(function(o){if(1==o){for(var i in _)if(!(Number(i)<=0)){n.doRecycleCar(u.indexOf(Number(i)));break}n.doPurchaseCar(e,t)}})}}},t.prototype.onLevelCompleted=function(e,t,n,o){void 0===n&&(n=0),void 0===o&&(o=0),this._levelCompletedData={level:e,victory:t,cash:n,chest:o}},t.prototype.doSpawnChest=function(){for(var e=this._highestCarLevel-(Math.floor((this._highestCarLevel-1)/10)+2),t=this._listOfCars,n=0;n<t.length;++n)if(0==t[n])return t[n]=-1,this.updateDisplayBoxes(),void a.g_saveStorage(this.storage);for(n=0;n<t.length;++n)if(-1==t[n])return;for(n=0;n<t.length;++n)if(t[n]<e)return t[n]=-1,this.updateDisplayBoxes(),void a.g_saveStorage(this.storage)},t.prototype.doOpenChest=function(e){var t=this._highestCarLevel-(Math.floor((this._highestCarLevel-1)/10)+2);this._listOfCars[e]=t,this.displayBoxes[e].openChest(t),this.scheduleOnce(this.updateDisplayBoxes,.24),a.g_saveStorage(this.storage)},t.prototype.doReplaceCars=function(e,t){if(!this._enforceComposing){var n=this._listOfCars[e];this._listOfCars[e]=this._listOfCars[t],this._listOfCars[t]=n,this.updateDisplayBoxes(),a.g_saveStorage(this.storage)}},t.prototype.doComposeCars=function(e,t){this._enforceComposing&&this.node.emit("composed");var n=this._listOfCars;n[e]=0,n[t]+=1,this.updateDisplayBoxes(),n[t]>this._highestCarLevel?(this._highestCarLevel=n[t],this._carBeingEquipped=n[t],this.updateDisplayStage(),this.updateRecommendedCar(),this.playUnlockingEffect(t),this._highestCarLevel>4&&this.scheduleOnce(function(){return d.wechat.showInterstitialAd()},1.5)):this.playComposingEffect(t),a.g_saveStorage(this.storage)},t.prototype.doRecycleCar=function(e){var t=this._listOfCars[e],n=r.g_recyclingFormula(t);this.doProfit(n),this._listOfCars[e]=0,this.updateDisplayBoxes(),a.g_saveStorage(this.storage)},t.prototype.doProfit=function(e){e&&(this.cashDepositLabel.string=r.g_value2String(this._cashDeposit+=e))},t.prototype.doReceiveOfflineProfits=function(e){if(!b&&!(e<=0)&&this._profitPerSecond){var t=Math.floor(e/1e3);t>14400&&(t=14400);var n=t*this._profitPerSecond;if(t<=600)this.doProfit(n);else{var o=this,i=t/3600>=1?(t/3600).toFixed(2)+"\u5c0f\u65f6":(t/60).toFixed(0)+"\u5206\u949f",a=""+r.g_value2String(n);s.default.showWithCallbacks({path:"offlineprofit"},{onPanelShow:function(){o.doProfit(n),d.wechat.showBannerAd(),h.wechat_review.isReview?o.node.emit("hide-line"):o.node.emit("show-line")},onPanelHide:function(){d.wechat.hideBannerAd(),h.wechat_review.isReview||d.wechat.showRightupNative(null,function(){d.wechat.getConfig("no_single")||(o.game_icon.active=!0)},o.game_icon),o.node.emit("hide-line")},onButtonClick:function(){var e=this;d.wechat.showRewardedVideoAd().then(function(){o.doProfit(n),e.hide()})}},a,i)}}},t.prototype.profitingScheduler=function(e){var t=Date.now(),n=this._profitPerSecond*e;b&&(n*=(t-b)/2e3),b=t,n&&(this.doProfit(n),this.playProfitingEffect()),a.g_saveStorage(this.storage)},t.prototype.updateCarBeingEquipped=function(e){this.displayStage.carLevel=this._carBeingEquipped=e,a.g_saveStorage(this.storage)},t.prototype.updateDisplayBoxes=function(){var e=this.displayBoxes,t=this._listOfCars;this._profitPerSecond=0;for(var n=0;n<t.length;++n)e[n].carLevel=t[n],this._profitPerSecond+=r.g_profitingFormula(t[n]);this.cashProfitingLabel.string=["+",r.g_value2String(this._profitPerSecond),"/\u79d2"].join(""),C=this._profitPerSecond},t.prototype.updateDisplayStage=function(){var e=this.displayStage;e.carLevel=this._carBeingEquipped,e.nextLevel=this._nextLevel},t.prototype.updateRecommendedCar=function(){var e=this._highestCarLevel,t=e-3,n=e-8;if(t<=1)this._recommendedCar=1;else{for(var o=this._listOfPrices,i=t-1,a=o[i]/2,c=1;c<t;++c)if(!(c+1<n)){var s=o[c]/Math.pow(2,c);s<a&&(i=c,a=s)}this._recommendedCar=i+1}var l=this._recommendedCar;this.recommendedCarLevelLabel.string=""+l,this.recommendedCarPriceLabel.string=r.g_value2String(this._listOfPrices[l-1]),this.recommendedCarSprite.spriteFrame=r.presetCars[l].perspective},t.prototype.playComposingEffect=function(e){var t=this;c.cocos.audio.playEffect("Sounds/composing"),this.displayBoxes[e].composing=!0,this.scheduleOnce(function(){return t.displayBoxes[e].composing=!1},.4);var n=this._listOfCars[e]-1,o=r.presetCars[n].perspective,i=this.composingEffect;i.node.getChildByName("sprite_item_0").getComponent(cc.Sprite).spriteFrame=o,i.node.getChildByName("sprite_item_1").getComponent(cc.Sprite).spriteFrame=o;var a=this.displayBoxes[e].node.getPosition();i.node.active=!0,i.node.setPosition(a),i.play().speed=1.5,i.once("finished",function(){i.node.active=!1,t.displayBoxes[e].composing=!1})},t.prototype.playUnlockingEffect=function(e){var t=this;c.cocos.audio.playEffect("Sounds/unlocking"),this.displayBoxes[e].composing=!0;var n=this._listOfCars[e],o=n-1,i=r.presetCars[o].perspective,a=this.unlockingEffect;c.cocos.searchNodeByPath(a.node,"align_node/sprite_item_0").getComponent(cc.Sprite).spriteFrame=i,c.cocos.searchNodeByPath(a.node,"align_node/sprite_item_1").getComponent(cc.Sprite).spriteFrame=i,a.node.active=!0,a.play(),a.once("finished",function(){a.node.active=!1});var l=this;this.scheduleOnce(function(){t.displayBoxes[e].composing=!1,n<=3||s.default.showWithCallbacks({path:"unlock"},{onPanelShow:function(){d.wechat.showBannerAd(),l.node.emit("show-line")},onPanelHide:function(){d.wechat.hideBannerAd(),h.wechat_review.isReview||d.wechat.showRightupNative(null,function(){d.wechat.getConfig("no_single")||(l.game_icon.active=!0)},l.game_icon),l.node.emit("hide-line")},onButtonClick:function(){d.wechat.shareAppMessage()}},n)},.8)},t.prototype.playProfitingEffect=function(){var e=this.displayBoxes,t=this._listOfCars;this.profitingLabels.forEach(function(n,o){if(!(t[o]<=0)){var i=e[o].node.getPosition(),a=t[o];n.string="+"+r.g_value2String(2*r.g_profitingFormula(a)),n.node.runAction(cc.sequence(cc.delayTime((o%10*6+Math.floor(o/10))/30),cc.place(i),cc.fadeIn(0),cc.spawn(cc.moveBy(1.2,0,60),cc.fadeOut(1.2))))}}),this.cashDepositLabel.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1)));for(var n=2*this._profitPerSecond,o=0,i=this.headerProfitingLabels;o<i.length;o++){var a=i[o];if(0==a.node.getNumberOfRunningActions()){a.node.opacity=255,a.node.setPosition(0,0),a.string="+"+r.g_value2String(n),a.node.runAction(cc.spawn(cc.fadeOut(1.2),cc.moveBy(1.2,0,30)));break}}},Object.defineProperty(t.prototype,"recycleHighlight",{get:function(){return this._recycleHighlight},set:function(e){if(e!=this.recycleHighlight){this._recycleHighlight=e;var t=this.recycleButton.node.children[0];t.stopAllActions(),e?t.runAction(cc.fadeIn(.2)):t.runAction(cc.fadeOut(.2))}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return{version:1,timeStamp:Date.now(),cashDeposit:this._cashDeposit,nextLevel:this._nextLevel,listOfCars:this._listOfCars,listOfPrices:this._listOfPrices,highestCarLevel:this._highestCarLevel,carBeingEquipped:this._carBeingEquipped,enforceIntroducing:this._enforceIntroducing}},set:function(e){this._cashDeposit=e.cashDeposit,this._nextLevel=e.nextLevel,this._listOfCars=e.listOfCars,this._listOfPrices=e.listOfPrices,this._highestCarLevel=e.highestCarLevel,this._carBeingEquipped=e.carBeingEquipped,this._enforceIntroducing=e.enforceIntroducing},enumerable:!1,configurable:!0}),t.prototype.enforceComposing=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,o,i=this;return __generator(this,function(a){switch(a.label){case 0:return e=this.guidingHand,1==this._listOfCars[0]&&1==this._listOfCars[1]?(t=this.displayBoxes[0].node.getBoundingBoxToWorld().center,n=this.displayBoxes[1].node.getBoundingBoxToWorld().center):1==this._listOfCars[0]&&1==this._listOfCars[2]?(t=this.displayBoxes[0].node.getBoundingBoxToWorld().center,n=this.displayBoxes[2].node.getBoundingBoxToWorld().center):(t=this.displayBoxes[1].node.getBoundingBoxToWorld().center,n=this.displayBoxes[2].node.getBoundingBoxToWorld().center),t=e.parent.convertToNodeSpaceAR(t),n=e.parent.convertToNodeSpaceAR(n),e.opacity=255,o=e.runAction(cc.repeatForever(cc.sequence(cc.place(t),cc.moveTo(.5,n),cc.delayTime(.2)))),this._enforceComposing=!0,[4,new Promise(function(e){return i.node.once("composed",e)})];case 1:return a.sent(),this._enforceComposing=!1,e.stopAction(o),e.opacity=0,[2]}})})},t.prototype.enforcePurchasing=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n=this;return __generator(this,function(o){switch(o.label){case 0:return e=this.guidingArrow,t=this.recommendedCarButton.node.getBoundingBoxToWorld().center,e.setPosition(e.parent.convertToNodeSpaceAR(t)),e.opacity=255,this._enforcePurchasing=!0,[4,new Promise(function(e){return n.recommendedCarButton.node.once("click",e)})];case 1:return o.sent(),[4,new Promise(function(e){return n.recommendedCarButton.node.once("click",e)})];case 2:return o.sent(),this._enforcePurchasing=!1,e.opacity=0,[2]}})})},t.prototype.enforcePlaying=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,o=this;return __generator(this,function(i){switch(i.label){case 0:return e=this.guidingHand,t=this.displayStage.startGameButton.node.getBoundingBoxToWorld().center,e.setPosition(e.parent.convertToNodeSpaceAR(t)),e.opacity=255,n=e.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.4,.6),cc.delayTime(.1),cc.scaleTo(.4,1),cc.delayTime(.3)))),this._enforcePlaying=!0,[4,new Promise(function(e){return o.displayStage.startGameButton.node.once("click",e)})];case 1:return i.sent(),this._enforcePlaying=!1,e.isValid&&(e.stopAction(n),e.scale=1,e.opacity=0),[2]}})})},t.prototype.enforceIntroducing=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:switch(this._enforceIntroducing){case 0:return[3,1];case 1:return[3,4];case 2:return[3,7];case 3:return[3,9];case 4:return[3,11];case 5:return[3,14]}return[3,16];case 1:return[4,c.cocos.asyncwait(1e3)];case 2:return e.sent(),[4,this.enforcePurchasing()];case 3:e.sent(),this._enforceIntroducing++,e.label=4;case 4:return[4,this.enforceComposing()];case 5:return e.sent(),this._enforceIntroducing++,[4,c.cocos.asyncwait(1e3)];case 6:e.sent(),e.label=7;case 7:return[4,this.enforcePurchasing()];case 8:e.sent(),this._enforceIntroducing++,e.label=9;case 9:return[4,this.enforceComposing()];case 10:e.sent(),this._enforceIntroducing++,e.label=11;case 11:return[4,this.enforceComposing()];case 12:return e.sent(),this._enforceIntroducing++,[4,c.cocos.asyncwait(1e3)];case 13:e.sent(),e.label=14;case 14:return[4,this.enforcePlaying()];case 15:e.sent(),this._enforceIntroducing++,e.label=16;case 16:return[2]}})})},__decorate([y(cc.Button)],t.prototype,"storeButton",void 0),__decorate([y(cc.Button)],t.prototype,"recycleButton",void 0),__decorate([y(cc.Button)],t.prototype,"recommendedCarButton",void 0),__decorate([y(cc.Sprite)],t.prototype,"recommendedCarSprite",void 0),__decorate([y(cc.Label)],t.prototype,"recommendedCarLevelLabel",void 0),__decorate([y(cc.Label)],t.prototype,"recommendedCarPriceLabel",void 0),__decorate([y(cc.Label)],t.prototype,"cashDepositLabel",void 0),__decorate([y(cc.Label)],t.prototype,"cashProfitingLabel",void 0),__decorate([y(i.default)],t.prototype,"displayStage",void 0),__decorate([y([o.default])],t.prototype,"displayBoxes",void 0),__decorate([y(cc.Animation)],t.prototype,"composingEffect",void 0),__decorate([y(cc.Animation)],t.prototype,"unlockingEffect",void 0),__decorate([y([cc.Label])],t.prototype,"profitingLabels",void 0),__decorate([y([cc.Label])],t.prototype,"headerProfitingLabels",void 0),__decorate([y(cc.Button)],t.prototype,"debugResetStorageButton",void 0),__decorate([y(cc.Node)],t.prototype,"bottomArea",void 0),__decorate([y(cc.Node)],t.prototype,"headerArea",void 0),__decorate([y(cc.Node)],t.prototype,"guidingHand",void 0),__decorate([y(cc.Node)],t.prototype,"guidingArrow",void 0),n=__decorate([w],t)}(cc.Component);n.default=S,cc._RF.pop()},{DisplayBox:"DisplayBox",DisplayStage:"DisplayStage",GameScene:"GameScene",Global:"Global",Panel:"Panel",Storage:"Storage",adBox:"adBox",gameline:"gameline",gamewall:"gamewall",libcocos:"libcocos",libwechat:"libwechat",libwechat_review:"libwechat_review",privacy:"privacy",redPack:"redPack",redPackIcon:"redPackIcon"}],PPGameRank:[function(e,t,n){"use strict";cc._RF.push(t,"2a5d4jvC4xLNryXQqvC6Oiw","PPGameRank"),Object.defineProperty(n,"__esModule",{value:!0}),n.PPGameRank=void 0;var o=e("PPGameSdk"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"ranking",{get:function(){return this._rankingLabel.string},set:function(e){this._rankingLabel.string=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userName",{get:function(){return this._userNameLabel.string},set:function(e){this._userNameLabel.string=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headPortrait",{get:function(){return this._headPortraitSprite.spriteFrame},set:function(e){this._headPortraitSprite.spriteFrame=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rankingValue",{get:function(){return this._rankingValueLabel.string},set:function(e){this._rankingValueLabel.string=e},enumerable:!1,configurable:!0}),t.create=function(e){var n,o,i,a=new cc.Node("pp_rank_item"),r=a.addComponent(t);return a.addComponent(cc.Sprite).spriteFrame=e,(n=new cc.Node("label_ranking")).parent=a,n.setPosition(-200,-6),(o=n.addComponent(cc.Label)).fontSize=34,r._rankingLabel=o,(n=new cc.Node("sprite_head_portrait")).parent=a,n.setPosition(-130,0),n.setContentSize(56,56),(i=n.addComponent(cc.Sprite)).sizeMode=cc.Sprite.SizeMode.CUSTOM,r._headPortraitSprite=i,(n=new cc.Node("label_user_name")).parent=a,n.setPosition(10,-4),n.setContentSize(180,46),(o=n.addComponent(cc.Label)).fontSize=36,o.overflow=cc.Label.Overflow.SHRINK,o.enableWrapText=!1,r._userNameLabel=o,(n=new cc.Node("label_ranking_value")).parent=a,n.setPosition(180,-6),n.setContentSize(116,42),(o=n.addComponent(cc.Label)).fontSize=32,o.overflow=cc.Label.Overflow.SHRINK,o.enableWrapText=!1,r._rankingValueLabel=o,r},t}(cc.Component),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._rankingItems=[],t}return __extends(t,e),t.show=function(){if(this._instance?this._instance.onLoad():this._instance=this.create(),this._instance&&!this._instance.node.parent){this._instance.node.parent=cc.Canvas.instance.node,this._instance.node.zIndex=this.zIndex;var e=this._instance._background;e.getNumberOfRunningActions()||(e.opacity=0,e.scale=.2,e.runAction(cc.spawn(cc.fadeIn(.4),cc.scaleTo(.4,1).easing(cc.easeBackOut()))))}},t.hide=function(){var e=this;if(this._instance&&this._instance.node.parent){var t=this._instance._background;if(t.getNumberOfRunningActions())return;t.runAction(cc.sequence(cc.spawn(cc.fadeOut(.4),cc.scaleTo(.4,.2).easing(cc.easeBackIn())),cc.callFunc(function(){e._instance.node.removeFromParent(!1)})))}},t.uploadPlayerRecord=function(e){return o.PPGameSdk.requestUserUpdating(e)},t.create=function(){var e=o.PPGameSdk.ppGameRankSpriteAtlas;if(!e)return console.warn("PPGAME_RANK_CREATE: failed"),console.warn("Invalid texture assets"),null;var n,a,r,c,s,l,d=cc.Canvas.instance,h=!1;d.node.width>d.node.height&&(h=!0);var u=new cc.Node("pp_rank_item"),p=u.addComponent(t);u.setContentSize(h?cc.size(1136,640):cc.size(640,1136)),(n=new cc.Node("sprite_touch_blocker")).color=cc.Color.BLACK,n.opacity=150,n.parent=u,n.addComponent(cc.BlockInputEvents),n.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame("sprite_white_pixel"),(s=n.addComponent(cc.Widget)).top=s.bottom=s.left=s.right=0,s.isAlignTop=s.isAlignBottom=s.isAlignLeft=s.isAlignRight=!0,s.target=cc.Canvas.instance.node,(n=new cc.Node("sprite_background")).parent=u,n.y=h?60:80,n.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame(h?"sprite_game_rank_horizontal":"sprite_game_rank"),p._background=a=n,(n=new cc.Node("sprite_title")).parent=a,n.setPosition(0,h?200:400),n.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame("sprite_title"),(n=new cc.Node("button_close")).parent=a,n.setPosition(h?cc.v2(500,-310):cc.v2(262,-593.5)),n.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame("button_close"),n.on("click",this.hide,this),n.addComponent(cc.Button).transition=cc.Button.Transition.SCALE,(n=new cc.Node("button_play_with_friends")).parent=a,n.setPosition(0,h?-300:-505),n.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame("button_play_with_friends"),n.on("click",function(){o.PPGameSdk.sendGameInvitation()}),n.addComponent(cc.Button).transition=cc.Button.Transition.SCALE,(n=new cc.Node("scrollview")).parent=a,n.setContentSize(a.getContentSize()),(l=n.addComponent(cc.ScrollView)).brake=.75,l.bounceDuration=.23,l.horizontal=!1,p._scrollview=l,(n=new cc.Node("mask")).parent=l.node,n.setContentSize(a.getContentSize()),(r=n.addComponent(cc.Mask)).type=cc.Mask.Type.IMAGE_STENCIL,r.spriteFrame=e.getSpriteFrame(h?"sprite_game_rank_horizontal":"sprite_game_rank"),p._mask=r,(n=new cc.Node("layout")).parent=r.node,n.anchorY=1,n.width=a.width,(c=n.addComponent(cc.Layout)).type=cc.Layout.Type.VERTICAL,c.resizeMode=cc.Layout.ResizeMode.CONTAINER,l.content=c.node;for(var _=0;_<10;++_){var g=i.create(e.getSpriteFrame(h?"sprite_lighter_row_horizontal":"sprite_lighter_row"));g.node.parent=c.node,g.getComponent(cc.Sprite).enabled=!(_%2),p._rankingItems[_]=g}var m=i.create(e.getSpriteFrame(h?"sprite_darker_row_horizontal":"sprite_darker_row"));return m.node.parent=a,m.node.setPosition(0,h?-210:-400),p._myRankingItem=m,u.scale=h?d.node.height/u.height:d.node.width/u.width,p},t.prototype.onLoad=function(){var e=this;o.PPGameSdk.requestRankListData().then(function(t){for(var n=e._rankingItems,o=n.length;o<t.list.length;++o){var a=i.create(n[0].getComponent(cc.Sprite).spriteFrame);a.node.parent=n[0].node.parent,a.getComponent(cc.Sprite).enabled=!(o%2),n[o]=a}var r=function(e){n[e].node.active=!0,n[e].ranking=(e+1).toString(),n[e].rankingValue=t.list[e].level,n[e].userName=t.list[e].name,t.list[e].photo&&cc.loader.load({url:t.list[e].photo,type:"png"},function(t,o){n[e].headPortrait=new cc.SpriteFrame(o)})};for(o=0;o<t.list.length;++o)r(o);for(o=t.list.length||0;o<n.length;++o)n[o].node.active=!1;var c=e._myRankingItem;if("undefined"!=typeof FBInstant){c.ranking=t.me>100?"100+":t.me,c.userName=FBInstant.player.getName();var s=FBInstant.player.getPhoto();s&&cc.loader.load({url:s,type:"png"},function(e,t){c.headPortrait=new cc.SpriteFrame(t)})}else c.ranking="0",c.userName="TEST",c.rankingValue="0"})},t.prototype.update=function(){if(this._scrollview.isScrolling){for(var e=this._mask,t=e.node.getBoundingBox(),n=e.node.parent.convertToWorldSpaceAR(cc.v2(t.x,t.y)),o=e.node,i=1;o;)i*=o.scale,o=o.parent;t.x=n.x,t.y=n.y,t.width*=i,t.height*=i;for(var a=0,r=this._rankingItems;a<r.length;a++){var c=r[a];c.node.opacity=t.intersects(c.node.getBoundingBoxToWorld())?255:0}}},t.prototype.onDestroy=function(){t._instance=null},t.zIndex=100,t}(cc.Component);n.PPGameRank=a,cc._RF.pop()},{PPGameSdk:"PPGameSdk"}],PPGameSdk:[function(e,t,n){"use strict";cc._RF.push(t,"f51510fQ+VN0LvuZdqmK1N4","PPGameSdk"),Object.defineProperty(n,"__esModule",{value:!0}),n.PPGameSdk=void 0;var o=/[\{\}]/g;function i(e){var t=(e=e.slice(1,-1)).split(","),n=parseFloat(t[0]),o=parseFloat(t[1]);return new cc.Size(n,o)}function a(e){var t=(e=e.slice(1,-1)).split(","),n=parseFloat(t[0]),o=parseFloat(t[1]);return new cc.Vec2(n,o)}function r(e){return e.split(" ").map(parseFloat)}function c(e,t){var n,c,s=e.metadata,l=e.frames,d=new cc.SpriteAtlas,h=d._spriteFrames;for(var u in l){var p=l[u],_=!1,g=void 0,m=void 0,f=void 0;0===s.format?(_=!1,g="{"+p.originalWidth+","+p.originalHeight+"}",m="{"+p.offsetX+","+p.offsetY+"}",f="{{"+p.x+","+p.y+"},{"+p.width+","+p.height+"}}"):1===s.format||2===s.format?(_=p.rotated,g=p.sourceSize,m=p.offset,f=p.frame):3===s.format&&(_=p.textureRotated,g=p.spriteSourceSize,m=p.spriteOffset,f=p.textureRect);var v=new cc.SpriteFrame;if(v.setTexture(t,(c=f.replace(o,"").split(","),new cc.Rect(c[0]?parseFloat(c[0]):0,c[1]?parseFloat(c[1]):0,c[2]?parseFloat(c[2]):0,c[3]?parseFloat(c[3]):0)),!!_,a(m),i(g)),p.triangles){var w=r(p.vertices),y=r(p.verticesUV);v.vertices={triangles:(n=p.triangles,n.split(" ").map(parseFloat)),x:[],y:[],u:[],v:[]};for(var b=0;b<w.length;b+=2)v.vertices.x.push(w[b]),v.vertices.y.push(w[b+1]);for(b=0;b<y.length;b+=2)v.vertices.u.push(y[b]),v.vertices.v.push(y[b+1])}h[cc.path.mainFileName(u)]=v}return d}function s(e,t,n,o,i){return void 0===t&&(t="get"),void 0===n&&(n=null),void 0===o&&(o={}),void 0===i&&(i=""),new Promise(function(a,r){var c=new XMLHttpRequest;for(var s in c.open(t,e,!0),c.responseType=i,o)c.setRequestHeader(s,o[s]);c.onload=function(){c.status>=200&&c.status<300?a(c.response):r("XHR_RES_ERROR")},c.onerror=function(){r("XHR_REQ_ERROR")},c.send(n)})}function l(e){return s(e,"get",null,{},"blob").then(function(e){return new Promise(function(t){var n=new FileReader;n.onloadend=function(e){t(e.target.result)},n.readAsDataURL(e)})})}function d(e){return l(e).then(function(e){return new Promise(function(t){var n=new Image;n.src=e,n.onload=function(){var e=new cc.Texture2D;e.initWithElement(n),t(e)}})})}function h(e){return __awaiter(this,void 0,Promise,function(){var t,n,o,i,a;return __generator(this,function(r){switch(r.label){case 0:return o=(n=cc.plistParser).parse,[4,s(e,"get",null,{})];case 1:return t=o.apply(n,[r.sent()]),i=t.metadata.realTextureFileName||t.metadata.textureFileName,[4,d(cc.path.join(cc.path.dirname(e),i))];case 2:return a=r.sent(),[2,c(t,a)]}})})}var u="undefined"!=typeof FBInstant,p=function(){return u||console.error("INVALID_PLATFORM"),u};n.PPGameSdk=new(function(){function e(){this._ppGameWallArguments=[]}return Object.defineProperty(e.prototype,"ppGameWallSpriteAtlas",{get:function(){return this._ppGameWallSpriteAtlas},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ppGameRankSpriteAtlas",{get:function(){return this._ppGameRankSpriteAtlas},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ppGameWallArguments",{get:function(){return this._ppGameWallArguments},enumerable:!1,configurable:!0}),e.prototype.initializeSdk=function(e,t,n,o){return __awaiter(this,void 0,void 0,function(){var i=this;return __generator(this,function(){return this._initializingPromise||(this._initializingPromise=__awaiter(i,void 0,void 0,function(){var i,a,r=this;return __generator(this,function(c){switch(c.label){case 0:return u&&(t&&(this._rewardedVideoId=t,this._preloadedRewardedVideoAd=this.loadRewardedVideoAd()),n&&(this._interstitialId=n,this._preloadedInterstitialAd=this.loadInterstitialAd()),o&&(this._gameType=o,this._defaultSharingImage="https://detectivecdn.p8games.com/instantgame/share/"+o+".jpg",this._defaultSharingText="I've got a fantastic game that you may wanna try.")),[4,Promise.all([h("https://detectivecdn.p8games.com/fbgame/sdk/pp_game_wall.plist").catch(function(e){return console.error(e),null}),h("https://detectivecdn.p8games.com/fbgame/sdk/pp_game_rank.plist").catch(function(e){return console.error(e),null})])];case 1:return i=c.sent(),this._ppGameWallSpriteAtlas=i[0],this._ppGameRankSpriteAtlas=i[1],e?(this._appId=e,[4,s("https://detective.p8games.com/fbGame?id="+e,"get",null,{},"json")]):[3,5];case 2:return(a=c.sent())?(a.gameType&&(this._gameType=a.gameType),a.shareImg&&(this._defaultSharingImage=a.shareImg),a.shareTxt&&(this._defaultSharingText=a.shareTxt),a.promotion.length&&(this._ppGameWallArguments=a.promotion),a.videoAd&&(this._rewardedVideoId=a.videoAd),a.insertAd&&(this._interstitialId=a.insertAd),this._ppGameWallArguments?[4,Promise.all(a.promotion.map(function(e){return d(e.icon).catch(function(e){return console.error(e),null})}))]:[3,4]):[3,4];case 3:c.sent().forEach(function(e,t){return r._ppGameWallArguments[t].icon=e?new cc.SpriteFrame(e):null}),c.label=4;case 4:return[3,6];case 5:console.warn("Invalid game id."),console.warn("Use suggested initialization parameters.(if exists):",{suggestedVideoId:t,suggestedIntersititialId:n,suggestedGameType:o}),c.label=6;case 6:if(u&&(this._rewardedVideoId&&this._rewardedVideoId!=t&&(this._preloadedRewardedVideoAd=this.loadRewardedVideoAd()),this._interstitialId&&this._interstitialId!=n&&(this._preloadedInterstitialAd=this.loadInterstitialAd()),this._gameType&&setTimeout(function(){var e=encodeURIComponent(FBInstant.player.getID()),t=encodeURIComponent(FBInstant.player.getName()),n=encodeURIComponent(FBInstant.player.getPhoto());s("https://detective.p8games.com/fbgame/"+r._gameType+"/FBUserInfo?id="+e+"&name="+t+"&photo="+n,"get").then(function(){console.log("REPORT_USER_INFO: succeeded"),console.log("id: "+e),console.log("name: "+t),console.log("photo: "+n)}).catch(function(e){console.warn("REPORT_USER_INFO: failed"),console.warn(e)})},1)),!this._appId)throw"INVALID_ID";return console.log("PPGAME_SDK_INIT: succeeded"),console.log("GameId: "+this._appId),console.log("GameType: "+this._gameType),console.log("GameWall: "+this._ppGameWallArguments),[2]}})})),[2,this._initializingPromise]})})},e.prototype.shareGame=function(e){return void 0===e&&(e={}),__awaiter(this,void 0,Promise,function(){var t,n,o;return __generator(this,function(i){switch(i.label){case 0:return p()?(n=(t=FBInstant).shareAsync,o={intent:e.intent||"SHARE"},[4,l(e.imageUrl||this._defaultSharingImage)]):[2];case 1:return[4,n.apply(t,[(o.image=i.sent(),o.text=e.text||this._defaultSharingText,o.data=e.data,o)])];case 2:return i.sent(),[2]}})})},e.prototype.sendGameInvitation=function(e){return void 0===e&&(e={}),__awaiter(this,void 0,Promise,function(){var t,n,o;return __generator(this,function(i){switch(i.label){case 0:return p()?[4,FBInstant.context.chooseAsync(e)]:[2];case 1:return i.sent(),n=(t=FBInstant).updateAsync,o={text:e.text||this._defaultSharingText},[4,l(e.imageUrl||this._defaultSharingImage)];case 2:return[4,n.apply(t,[(o.image=i.sent(),o.action=e.action||"CUSTOM",o.template=e.template||"play_turn",o.strategy=e.strategy||"IMMEDIATE",o.notification=e.notification||"PUSH",o.cta=e.cta,o.data=e.data,o)])];case 3:return i.sent(),[2]}})})},e.prototype.showRewardedVideoAd=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){switch(e.label){case 0:if(console.log("showRewardedVideoAd"),!p())return[2];if(!this._rewardedVideoId)throw"INVALID_ID";return console.log("PPGAME_SDK: trying to show rewarded video advertisement."),[4,this._preloadedRewardedVideoAd];case 1:return[4,e.sent().showAsync()];case 2:return e.sent(),this._preloadedRewardedVideoAd=this.loadRewardedVideoAd(),[2]}})})},e.prototype.showInterstitialAd=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){switch(e.label){case 0:if(console.log("showInterstitialAd"),!p())return[2];if(!this._interstitialId)throw"INVALID_ID";return console.log("PPGAME_SDK: trying to show interstitial advertisement."),[4,this._preloadedInterstitialAd];case 1:return[4,e.sent().showAsync()];case 2:return e.sent(),this._preloadedInterstitialAd=this.loadInterstitialAd(),[2]}})})},e.prototype.requestRankListData=function(){return __awaiter(this,void 0,Promise,function(){var e;return __generator(this,function(){if(!this._appId)throw"UNINITIALIZED";return e=u?FBInstant.player.getID():"0",[2,s("https://detective.p8games.com/fbgame/"+this._gameType+"/leaderboard?id="+e,"get",null,{},"json")]})})},e.prototype.requestUserUpdating=function(e){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(){if(!this._appId)throw"UNINITIALIZED";return u?[2,s("https://detective.p8games.com/fbgame/"+this._gameType+"/updateData?id="+FBInstant.player.getID()+"&level="+e)]:[2]})})},e.prototype.loadRewardedVideoAd=function(){return __awaiter(this,void 0,Promise,function(){var e,t,n,o;return __generator(this,function(i){switch(i.label){case 0:t=null,n=0,i.label=1;case 1:if(!(n<10))return[3,8];i.label=2;case 2:return i.trys.push([2,5,,6]),[4,FBInstant.getRewardedVideoAsync(this._rewardedVideoId)];case 3:return[4,(e=i.sent()).loadAsync()];case 4:return i.sent(),[3,6];case 5:return o=i.sent(),t=o,[3,7];case 6:return t=null,[3,8];case 7:return++n,[3,1];case 8:if(t)throw console.warn("PPGAME_SDK_AD: Failed loading rewarded video ad."),console.warn(t),t;return[2,e]}})})},e.prototype.loadInterstitialAd=function(){return __awaiter(this,void 0,Promise,function(){var e,t,n,o;return __generator(this,function(i){switch(i.label){case 0:t=null,n=0,i.label=1;case 1:if(!(n<10))return[3,8];i.label=2;case 2:return i.trys.push([2,5,,6]),[4,FBInstant.getInterstitialAdAsync(this._interstitialId)];case 3:return[4,(e=i.sent()).loadAsync()];case 4:return i.sent(),[3,6];case 5:return o=i.sent(),t=o,[3,7];case 6:return t=null,[3,8];case 7:return++n,[3,1];case 8:if(t)throw console.warn("PPGAME_SDK_AD: Failed loading interstitial ad."),console.warn(t),t;return[2,e]}})})},e}()),cc._RF.pop()},{}],PPGameWall:[function(e,t,n){"use strict";cc._RF.push(t,"154ccd+2XFLSJDo99sE4QMW","PPGameWall"),Object.defineProperty(n,"__esModule",{value:!0}),n.PPGameWall=void 0;var o=e("PPGameSdk"),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._buttonNodes=[],t}return __extends(t,e),t.show=function(){if(cc.sys.os==cc.sys.OS_IOS)return console.log("Phone pad game wall is not available on IOS system.");var e=o.PPGameSdk.ppGameWallArguments;if(!e||!e.length)return console.error("INVALID_GAME_LIST");this._instance||(this._instance=this.create()),this._instance&&(this._instance.node.parent||(this._instance.node.parent=cc.Canvas.instance.node,this._instance.node.zIndex=this.zIndex))},t.hide=function(){this._instance&&this._instance.node.parent&&this._instance.node.removeFromParent(!1)},t.create=function(){var e=o.PPGameSdk.ppGameWallSpriteAtlas;if(!e)return console.warn("PPGAME_WALL_CREATE: failed"),console.warn("Invalid texture assets"),null;var n=cc.Canvas.instance,i=!1;n.fitHeight||n.fitWidth||console.warn("PPGAME_SDK: Please make sure the adaption of screen is properly set up, otherwise this widget might not be dispalyed well."),n.node.width>n.node.height&&(i=!0);var a=new cc.Node("pp_game_wall");a.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame(i?"sprite_game_wall_horizontal":"sprite_game_wall"),a.addComponent(cc.Widget),a.addComponent(cc.BlockInputEvents);var r=new cc.Node("sprite_more_games");r.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame(i?"sprite_more_games_horizontal":"sprite_more_games"),r.setPosition(i?cc.v2(9.5,265):cc.v2(-265,9.5)),r.parent=a;for(var c=a.addComponent(t),s=0;s<4;++s){var l=new cc.Node("button_"+s);l.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame("button_default"),l.addComponent(cc.Button).transition=cc.Button.Transition.SCALE,l.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM,l.setPosition(i?cc.v2(6,165-134*s):cc.v2(134*s-165,-6)),l.parent=a,c._buttonNodes[s]=l}var d=a.getComponent(cc.Widget);return i?(a.scale=n.node.height/a.height,d.isAlignRight=!0,d.right=0):(a.scale=n.node.width/a.width,d.isAlignBottom=!0,d.bottom=0),d.target=cc.Canvas.instance.node,d.updateAlignment(),c},t.prototype.onLoad=function(){var e=o.PPGameSdk.ppGameWallArguments||[];this._buttonNodes.forEach(function(t,n){e[n]&&(t.getComponent(cc.Sprite).spriteFrame=e[n].icon,t.on("click",function(){return"undefined"!=typeof FBInstant&&FBInstant.switchGameAsync(e[n].gameId)}))})},t.prototype.onDestroy=function(){t._instance=null},t.zIndex=100,t}(cc.Component);n.PPGameWall=i,cc._RF.pop()},{PPGameSdk:"PPGameSdk"}],Panel:[function(e,t,n){"use strict";cc._RF.push(t,"67325b5/gVPJrB54SsD9b4p","Panel"),Object.defineProperty(n,"__esModule",{value:!0}),n.FadingCallback=n.PopingCallback=n.SlidingCallback=n.PANEL_EVT_BTN_CLK=n.PANEL_EVT_HIDE=n.PANEL_EVT_SHOW=void 0;var o=cc._decorator,i=o.ccclass,a=o.property;n.PANEL_EVT_SHOW="on-panel-show",n.PANEL_EVT_HIDE="on-panel-hide",n.PANEL_EVT_BTN_CLK="on-button-click",n.SlidingCallback=function(e,t,n){return new Promise(function(e){if("show"==n){var o=t.getComponent(cc.Widget);o&&(o.target=cc.Canvas.instance.node,o.updateAlignment()),t.opacity=0,t.runAction(cc.sequence(cc.moveBy(0,0,t.height),cc.fadeIn(0),cc.moveBy(.6,0,-t.height).easing(cc.easeBackOut()),cc.callFunc(e)))}else t.runAction(cc.sequence(cc.moveBy(.6,0,t.height).easing(cc.easeBackIn()),cc.callFunc(e)))})},n.PopingCallback=function(e,t,n){return new Promise(function(e){"show"==n?(t.opacity=0,t.scale=.2,t.runAction(cc.sequence(cc.spawn(cc.fadeIn(.4),cc.scaleTo(.4,1).easing(cc.easeBackOut())),cc.callFunc(e)))):t.runAction(cc.sequence(cc.spawn(cc.fadeOut(.4),cc.scaleTo(.4,.2).easing(cc.easeBackIn())),cc.callFunc(e)))})},n.FadingCallback=function(e,t,n){return new Promise(function(e){"show"==n?(t.opacity=0,t.scale=1,t.runAction(cc.sequence(cc.fadeIn(.4),cc.callFunc(e)))):t.runAction(cc.sequence(cc.fadeOut(.4),cc.callFunc(e)))})};var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animatingCallback=n.PopingCallback,t._createdPath=null,t._animating=!1,t.touchBlocker=null,t.background=null,t.blockerOpacity=150,t.closeButtons=[],t.menuButtons=[],t}var o;return __extends(t,e),o=t,t.create0=function(e,t){return __awaiter(this,void 0,Promise,function(){var n,i=this;return __generator(this,function(){return(n=this._allPanels.get(e))||(n=new Promise(function(n,a){cc.loader.loadRes("Panels/"+e,cc.Prefab,function(r,c){if(r)i._allPanels.delete(e),a(r);else{var s=cc.instantiate(c).getComponent(o);s._createdPath=e,t&&(s.animatingCallback=t),console.log("Panel.created",e),n(s)}})}),this._allPanels.set(e,n)),[2,n]})})},t.create=function(e,t){return __awaiter(this,void 0,Promise,function(){var n,i=this;return __generator(this,function(){return(n=this._allPanels.get(e))||(n=new Promise(function(n,a){cc.loader.loadRes("Panels/"+e,cc.Prefab,function(r,c){if(i._allPanels.delete(e),r)a(r);else{var s=cc.instantiate(c).getComponent(o);s._createdPath=e,t&&(s.animatingCallback=t),console.log("Panel.created",e),n(s)}})}),this._allPanels.set(e,n)),[2,n]})})},t.showWithArguments=function(e){for(var t=e.path,n=e.animating,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return __awaiter(this,void 0,Promise,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.create(t,n)];case 1:return(e=i.sent()).show.apply(e,o),[2]}})})},t.showWithCallbacks=function(e,t){for(var o=e.path,i=e.animating,a=[],r=2;r<arguments.length;r++)a[r-2]=arguments[r];return __awaiter(this,void 0,Promise,function(){var e,r,c,s,l;return __generator(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this.create(o,i)];case 1:return e=d.sent(),r=t.onPanelShow,c=t.onPanelHide,s=t.onButtonClick,r&&e.node.once(n.PANEL_EVT_SHOW,r,e),s&&e.node.on(n.PANEL_EVT_BTN_CLK,s,e),e.node.once(n.PANEL_EVT_HIDE,function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];s&&e.node.off(n.PANEL_EVT_BTN_CLK,s,e),c&&c.call.apply(c,__spreadArrays([e],t))}),e.show.apply(e,a),[3,3];case 2:if(l=d.sent(),!t.onError)throw l;return t.onError.call(e,l),[3,3];case 3:return[2]}})})},t.showWithPromise=function(e){for(var t=e.path,n=e.animating,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return __awaiter(this,void 0,Promise,function(){var e=this;return __generator(this,function(){return[2,new Promise(function(i,a){e.showWithCallbacks.apply(e,__spreadArrays([{path:t,animating:n},{onPanelHide:i,onError:a}],o))})]})})},t.findByPath=function(e){return this._allPanels.get(e)||Promise.resolve(null)},t.hideByPath=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this._allPanels.get(e).then(function(e){if(!e)return console.warn("target panel doesn't exist");e.node.parent||console.warn("target panel is currently hidding"),e.hide.apply(e,t)})},t.exists=function(e){return Boolean(this._allPanels.get(e))},t.prototype.show=function(){for(var e,t=this,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(console.log("Panel.show",this._createdPath,i),this.node.parent)throw"INVALID_STATE";if(this._animating)throw"BUSY_INVOKING";cc.Canvas.instance.node.addChild(this.node,o.Z_INDEX),(e=this.node).emit.apply(e,__spreadArrays([n.PANEL_EVT_SHOW],i)),this.node.parent.emit(n.PANEL_EVT_SHOW,this),this.animatingCallback&&(this._animating=!0,this.animatingCallback(this.node,this.background,"show").then(function(){t._animating=!1})),console.log("Panel.showed",this._createdPath)},t.prototype.hide=function(){for(var e,t=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(!this.node.parent)throw"INVALID_STATE";if(this._animating)throw"BUSY_INVOKING";(e=this.node).emit.apply(e,__spreadArrays([n.PANEL_EVT_HIDE],o)),this.node.parent.emit(n.PANEL_EVT_HIDE,this),this.animatingCallback?(this._animating=!0,this.animatingCallback(this.node,this.background,"hide").then(function(){t._animating=!1,t.node.removeFromParent(!1)})):this.node.removeFromParent(!1)},t.prototype.onLoad=function(){var e=this;console.log("Panel.onLoad()"),this.touchBlocker.opacity=this.blockerOpacity,this.touchBlocker.on("click",function(){return e.hide(null)}),this.menuButtons.forEach(function(t,o){t&&t.node&&t.node.on("click",function(){return e.node.emit(n.PANEL_EVT_BTN_CLK,o)})}),this.closeButtons.forEach(function(t,n){t&&t.node&&t.node.on("click",function(){return e.hide(n)})});var t=cc.view.getDesignResolutionSize(),o=cc.Canvas.instance.node.getContentSize();o.width/o.height<t.width/t.height?this.node.setScale(o.width/t.width):this.node.setScale(o.height/t.height);var i=this.touchBlocker.getComponent(cc.Widget);i&&(i.target=cc.Canvas.instance.node,i.updateAlignment())},t.prototype.onDestroy=function(){o._allPanels.delete(this._createdPath)},t.Z_INDEX=20,t._allPanels=new Map,__decorate([a(cc.Node)],t.prototype,"touchBlocker",void 0),__decorate([a(cc.Node)],t.prototype,"background",void 0),__decorate([a],t.prototype,"blockerOpacity",void 0),__decorate([a([cc.Button])],t.prototype,"closeButtons",void 0),__decorate([a([cc.Button])],t.prototype,"menuButtons",void 0),o=__decorate([i],t)}(cc.Component);n.default=r,cc._RF.pop()},{}],PresetCars:[function(e,t,n){"use strict";cc._RF.push(t,"9630aSrJdJJp55IJbSsZTha","PresetCars"),Object.defineProperty(n,"__esModule",{value:!0}),n.g_loadCarResources=void 0;var o=e("Global"),i=e("libcocos"),a=[null,"Chery QQ","Honda CR-V","Chevrolet N200","Buick Regal","Toyota Camry","Ford Mondeo","Honda Odyssey","Ford Edge","Volkswagen Sharan","Toyota Highlander","BMW x1","Mercedes Benz VITO","Cadillac XTS","Land Rover Evoque","Chrysler 300C","Jeep Wrangler Rubicon","Land Rover Freelander","BMW Z4","Land Rover Discovery 4","Audi Q7","BMW X5","BMW 7 Series","Sarin Komaro","Audi A8L","Lorinser M","Brabus S","GMC-YUKON","BMW M6","Aston Martin V8","Porsche Boxster","Volkswagen Hybrid","Audi R8","Lotus Exige","Mercedes Benz S-class","Range Rover sport","Maserati Ghibli","Jaguar XJ","Porsche Cayenne","Porsche Panamera","lincoln Navigator","Mitsuoka Galue","Porsche 911","Maserati Quattroporte","KTMX-Bow","Lotus Evora-400","GMC-Savana","Saleen Mustang ","Benz RV","Morgan Roadster","Benz G-Class","Mitsuoka Orochi","McLaren 570s","Maserati GT","Morgan Plus8","Morgan Aero-8","Maserati GranCabrio"];n.g_loadCarResources=function(e){return i.cocos.loadResDir("Cars",cc.SpriteFrame,e).then(function(e){var t=new Array,n=new Array;e.forEach(function(e){e.name.endsWith("x")||(e.name.startsWith("npccar")?o.npcCars[Number.parseInt(e.name.substring(6))]=e:e.name.endsWith("a")?n[Number.parseInt(e.name.substring(3))]=e:t[Number.parseInt(e.name.substring(3))]=e)});for(var i=1;i<t.length;++i)o.presetCars[i]={level:i,name:a[i],perspective:t[i],topview:n[i]},window.show_car_name||(o.presetCars[i].name="")})},cc._RF.pop()},{Global:"Global",libcocos:"libcocos"}],Queue:[function(e,t,n){"use strict";cc._RF.push(t,"5fbddCt60NMFr+AhgPNtHEW","Queue"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e||(e=32),this._head=0,this._rear=0,"number"!=typeof e||t.length?(this._elements=new(Array.bind.apply(Array,__spreadArrays([void 0,e],t))),this._length=this.size):(this._elements=new Array(e),this._length=0)}return Object.defineProperty(e.prototype,"front",{get:function(){if(this._length)return this._elements[this._head]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._elements.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"array",{get:function(){for(var e=this.size,t=new Array(this._length),n=0;n<this._length;++n)t[n]=this._elements[(n+this._head)%e];return t},enumerable:!1,configurable:!0}),e.prototype.push=function(e){this._length==this.size&&this.resize(),this._length+=1,this._elements[this._rear++]=e,this._rear=this._rear%this.size},e.prototype.pop=function(){if(this._length){this._length-=1;var e=this._elements[this._head++];return this._head=this._head%this.size,e}},e.prototype.resize=function(e){e=e||2*this.size;for(var t=new Array(e),n=0;n<e&&this._length;++n)t[n]=this.pop();this._head=0,this._rear=n%t.length,this._length=n,this._elements=t},e.prototype.clear=function(){this._head=0,this._rear=0,this._length=0},e}();n.default=o,cc._RF.pop()},{}],RacingCar:[function(e,t,n){"use strict";cc._RF.push(t,"3a29eIzrP5HuKQRM+9KjvbE","RacingCar"),Object.defineProperty(n,"__esModule",{value:!0}),n.currentCarPosition=n.bulletDamage=n.magnetFlag=n.powerFlag=n.speedFlag=n.bonusFlag=n.CAR_EVT_GETTING_COIN=n.CAR_EVT_MOVING=void 0;var o=e("GameScene"),i=e("Global"),a=e("libcocos"),r=cc._decorator,c=r.ccclass,s=r.property;n.CAR_EVT_MOVING="on-car-moving",n.CAR_EVT_GETTING_COIN="on-getting-coin",n.bonusFlag=!1,n.speedFlag=!1,n.powerFlag=!1,n.magnetFlag=!1,n.bulletDamage=0,n.currentCarPosition=null;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._level=1,t.extraSpeedPercentage=0,t._isTouching=!1,t._basicSpeed=60,t._targetXPosition=0,t._horizontalSpeed=0,t._meterRecord=0,t._shootingInterval=[0,.12],t._isAlive=!0,t._collectedCoins=0,t._collectedChests=0,t._bonusTimer=0,t._speedTimer=0,t._powerTimer=0,t._magnetTimer=0,t.dashAnimation=null,t.collisionAnimation=null,t.explosionAnimation=null,t.magnetAnimation=null,t.carSprite=null,t.N2OVolumeSprite=null,t.shadowSprite=null,t.bulletContainerNode=null,t.plane_sprite=null,t.restore_spriteFrame=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e,this.carSprite.spriteFrame=i.presetCars[e].topview,this.shadowSprite.spriteFrame=i.presetCars[e].topview},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentSpeed",{get:function(){var e=this._speedRange[0],t=this._speedRange[1],o=this._basicSpeed*(e+this.extraSpeedPercentage*(t-e));return n.speedFlag&&(o+=60),o},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"meterRecord",{get:function(){return this._meterRecord},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"collectedCoins",{get:function(){return this._collectedCoins},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"collectedChests",{get:function(){return this._collectedChests},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAlive",{get:function(){return this._isAlive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInvincible",{get:function(){return this.node.y>300},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cannonLevel",{get:function(){return this._level<=10?[0,1,1,1,2,3,4,5,6,7,8][this._level]:this._level},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;n.bonusFlag=!1,n.powerFlag=!1,n.speedFlag=!1,n.magnetFlag=!1,this.collisionAnimation.on("finished",function(){e.collisionAnimation.node.active=!1})},t.prototype.start=function(){this._speedRange=i.g_presetLevelFormula(o.default.instance.currentLevel).speedRange,n.bulletDamage=i.g_bulletDamageFormula(this.cannonLevel),this.carSprite.node.children[(this.cannonLevel-1)%10].active=!0,o.isCashLevel&&this.onGameItem(i.ItemType.BONUS,"start")},t.prototype.update=function(e){if(o.isGameEnded&&(e*=.1),!o.isGamePaused){if(this._bonusTimer>0?(5==this._bonusTimer&&this.onGameItem(i.ItemType.BONUS,"start"),this._bonusTimer-=e):this._bonusTimer<0&&(this.onGameItem(i.ItemType.BONUS,"end"),this._bonusTimer=0),this._speedTimer>0?(5==this._speedTimer&&this.onGameItem(i.ItemType.N2O,"start"),this._speedTimer-=e):this._speedTimer<0&&(this.onGameItem(i.ItemType.N2O,"end"),this._speedTimer=0),this._powerTimer>0?(5==this._powerTimer&&this.onGameItem(i.ItemType.POWER,"start"),this._powerTimer-=e):this._powerTimer<0&&(this.onGameItem(i.ItemType.POWER,"end"),this._powerTimer=0),this._magnetTimer>0?(5==this._magnetTimer&&this.onGameItem(i.ItemType.MAGNET,"start"),this._magnetTimer-=e):this._magnetTimer<0&&(this.onGameItem(i.ItemType.MAGNET,"end"),this._magnetTimer=0),this._isTouching){var t=this._horizontalSpeed;Math.abs(this.node.x-this._targetXPosition)>t?this._targetXPosition>this.node.x?this.node.x+=t:this.node.x-=t:this.node.x=this._targetXPosition}var r=e*this.currentSpeed*1e3*i.PTMRatio/60/60;if(n.speedFlag)this.node.y<500?this.node.y+=r/8:this.node.y=500;else if(this.node.y>300?this.node.y-=r/4:(this.node.y=300,this.dashAnimation.node.active=!1),this._shootingInterval[0]-=e,this._shootingInterval[0]<=0){this._shootingInterval[0]=this._shootingInterval[1],a.cocos.audio.stopEffect("Sounds/shooting"),a.cocos.audio.playEffect("Sounds/shooting");var c=Math.floor((this.cannonLevel-1)/5)+1;c<14&&n.powerFlag&&(c+=1);var s="sprite_bullet_"+c;switch((this.cannonLevel-1)%10+1){case 1:this.doShootBullet(0,100,s);break;case 2:this.doShootBullet(-32,100,s),this.doShootBullet(32,100,s);break;case 3:this.doShootBullet(-32,100,s),this.doShootBullet(32,100,s),this.doShootBullet(-105,10,s,30),this.doShootBullet(105,10,s,-30);break;case 4:this.doShootBullet(-32,100,s),this.doShootBullet(0,100,s),this.doShootBullet(32,100,s),this.doShootBullet(-105,10,s,30),this.doShootBullet(105,10,s,-30);break;case 5:this.doShootBullet(-32,100,s),this.doShootBullet(0,100,s),this.doShootBullet(32,100,s),this.doShootBullet(-98,28,s,30),this.doShootBullet(-118,14,s,30),this.doShootBullet(98,28,s,-30),this.doShootBullet(118,14,s,-30);break;case 6:this.doShootBullet(-32,100,s),this.doShootBullet(32,100,s);break;case 7:this.doShootBullet(-32,100,s),this.doShootBullet(0,100,s),this.doShootBullet(32,100,s);break;case 8:this.doShootBullet(-32,100,s),this.doShootBullet(0,100,s),this.doShootBullet(32,100,s),this.doShootBullet(-105,10,s,30),this.doShootBullet(105,10,s,-30);break;case 9:this.doShootBullet(-32,100,s),this.doShootBullet(-10,100,s),this.doShootBullet(10,100,s),this.doShootBullet(32,100,s),this.doShootBullet(-105,10,s,30),this.doShootBullet(105,10,s,-30);break;case 10:this.doShootBullet(-32,100,s),this.doShootBullet(-10,100,s),this.doShootBullet(10,100,s),this.doShootBullet(32,100,s),this.doShootBullet(-98,28,s,30),this.doShootBullet(-118,14,s,30),this.doShootBullet(98,28,s,-30),this.doShootBullet(118,14,s,-30)}}this.node.emit(n.CAR_EVT_MOVING,r),this._meterRecord+=r/i.PTMRatio,this.N2OVolumeSprite.node.active&&(this.N2OVolumeSprite.node.setPosition(this.node.x,this.node.y+150),this.N2OVolumeSprite.fillRange=this._speedTimer/5),n.currentCarPosition=this.node.getBoundingBoxToWorld().center}},t.prototype.onTouchBegan=function(e){o.isGameEnded||(this._isTouching=!0,this.onTouchMoved(e))},t.prototype.onTouchEnded=function(){this._isTouching=!1},t.prototype.onTouchMoved=function(e){o.isGameEnded||(this._targetXPosition=this.node.parent.convertToNodeSpaceAR(e.getLocationInView()).x,this._targetXPosition>255?this._targetXPosition=255:this._targetXPosition<-255&&(this._targetXPosition=-255),this._horizontalSpeed=Math.abs(this._targetXPosition-this.node.x),this._horizontalSpeed>50?this._horizontalSpeed=50:this._horizontalSpeed<5&&(this._horizontalSpeed=5))},t.prototype.onCollisionEnter=function(e,t){switch(e.node.name){case"game_item_coin":this._collectedCoins+=1,this.node.emit(n.CAR_EVT_GETTING_COIN);break;case"game_item_diamond":this._collectedCoins+=10,this.node.emit(n.CAR_EVT_GETTING_COIN);break;case"game_item_power":this._powerTimer=5;break;case"game_item_n2o":this._speedTimer=5;break;case"game_item_bonus":this._bonusTimer=5;break;case"game_item_magnet":this._magnetTimer=5;break;case"game_item_chest":this._collectedChests+=1;break;case"sprite_finish_line":this._isAlive=!1,cc.Canvas.instance.node.emit(o.GAME_EVT_VICTORY),this.clearItemStates();break;case"sprite_bomb":if(this._isAlive){if(e.node.active=!1,this.isInvincible||o.isGameEnded)break;this.onExplosion()}break;case"common_vehicle":if(e.getComponent("CommonVehicle").healthValue&&!this.isInvincible){var i=t.node.getBoundingBoxToWorld(),a=e.node.getBoundingBoxToWorld();i.center.y<=a.center.y&&this.onExplosion()}}},t.prototype.onCollisionStay=function(){},t.prototype.onCollisionExit=function(){},t.prototype.doRevive=function(){this._isAlive=!0,this.carSprite.node.active=!0,this.dashAnimation.node.active=!0,this.shadowSprite.node.active=!0,this._speedTimer=5},t.prototype.doShootBullet=function(e,t,n,o){var i;void 0===o&&(o=0);for(var a=0,r=this.bulletContainerNode.children;a<r.length;a++){var c=r[a];if(c.name==n&&!c.active){i=c;break}}i||((i=cc.instantiate(this.bulletContainerNode.getChildByName(n))).parent=this.bulletContainerNode);var s=1600*Math.cos((o+90)/180*Math.PI),l=1600*Math.sin((o+90)/180*Math.PI);i.active=!0,i.angle=o,i.setPosition(this.node.x+e*this.node.scale,this.node.y+t*this.node.scale),i.runAction(cc.sequence(cc.moveBy(1,s,l),cc.callFunc(function(){i.active=!1})))},t.prototype.onExplosion=function(){a.cocos.audio.playEffect("Sounds/explosion"),this._isAlive=!1,this.clearItemStates(),this.carSprite.node.active=!1,this.dashAnimation.node.active=!1,this.shadowSprite.node.active=!1,this.explosionAnimation.node.active=!0,this.explosionAnimation.play(),cc.Canvas.instance.node.emit(o.GAME_EVT_FAILURE)},t.prototype.clearItemStates=function(){this._bonusTimer&&(this._bonusTimer=0,this.onGameItem(i.ItemType.BONUS,"end")),this._speedTimer&&(this._speedTimer=0,this.onGameItem(i.ItemType.N2O,"end")),this._powerTimer&&(this._powerTimer=0,this.onGameItem(i.ItemType.POWER,"end")),this._magnetTimer&&(this._magnetTimer=0,this.onGameItem(i.ItemType.MAGNET,"end"))},t.prototype.onGameItem=function(e,t){switch(e){case i.ItemType.N2O:"start"==t?(a.cocos.audio.playEffect("Sounds/acceleration",!0),this.N2OVolumeSprite.node.active||(this.restore_spriteFrame=this.carSprite.spriteFrame,this.carSprite.spriteFrame=this.plane_sprite,this.shadowSprite.spriteFrame=this.plane_sprite),this.N2OVolumeSprite.node.active=!0,this.dashAnimation.node.active=!0,n.speedFlag=!0):(a.cocos.audio.stopEffect("Sounds/acceleration"),this.N2OVolumeSprite.node.active=!1,n.speedFlag=!1,this.carSprite.spriteFrame=this.restore_spriteFrame,this.shadowSprite.spriteFrame=this.restore_spriteFrame);break;case i.ItemType.BONUS:n.bonusFlag="start"==t;break;case i.ItemType.POWER:"start"==t?(n.powerFlag=!0,n.bulletDamage*=5):(n.powerFlag=!1,n.bulletDamage=i.g_bulletDamageFormula(this.cannonLevel));break;case i.ItemType.MAGNET:"start"==t?(this.magnetAnimation.node.active=!0,n.magnetFlag=!0):(this.magnetAnimation.node.active=!1,n.magnetFlag=!1)}},__decorate([s(cc.Animation)],t.prototype,"dashAnimation",void 0),__decorate([s(cc.Animation)],t.prototype,"collisionAnimation",void 0),__decorate([s(cc.Animation)],t.prototype,"explosionAnimation",void 0),__decorate([s(cc.Animation)],t.prototype,"magnetAnimation",void 0),__decorate([s(cc.Sprite)],t.prototype,"carSprite",void 0),__decorate([s(cc.Sprite)],t.prototype,"N2OVolumeSprite",void 0),__decorate([s(cc.Sprite)],t.prototype,"shadowSprite",void 0),__decorate([s(cc.Node)],t.prototype,"bulletContainerNode",void 0),__decorate([s(cc.SpriteFrame)],t.prototype,"plane_sprite",void 0),__decorate([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{GameScene:"GameScene",Global:"Global",libcocos:"libcocos"}],RacingRoad:[function(e,t,n){"use strict";cc._RF.push(t,"53e29qHbTRD36SU63tr5kOP","RacingRoad"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("Global"),i=e("RacingCar"),a=e("CommonVehicle"),r=e("GameItem"),c=e("GameScene"),s=e("libutils"),l=e("libcocos"),d=cc._decorator,h=d.ccclass,u=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._site=0,t._counter=0,t._enemyWaves=0,t._totalWaves=30,t._trailerCount=0,t.racingCar=null,t.segmentContainer=null,t.vehicleContainer=null,t.itemContainer=null,t.itemPrefabs=[],t.roadSegments=[],t.roadFrames=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"levelProgress",{get:function(){return this._enemyWaves/this._totalWaves},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.racingCar.node.on(i.CAR_EVT_MOVING,function(t){e.segmentContainer.y-=t,e.vehicleContainer.y=e.segmentContainer.y}),this.vehicleContainer.on(a.VEHICLE_EVT_EXPLOSION,this.onVehicleExplosion,this)},t.prototype.randomRoad=function(e){this._counter++;var t=50*(this._counter-2),n=s.utils.randomInt(0,101),o=e.getChildByName("scenery_"+this._site),i=[o.getChildByName("road5"),o.getChildByName("road6")];if(i[0].active=!1,i[1].active=!1,n<=t){var a=i[s.utils.randomInt(0,2)];a.active=!0,a.scaleX=s.utils.randomInt(0,101)<=50?1:-1,a.scaleY=s.utils.randomInt(0,101)<=50?1:-1,a.x=s.utils.random(-254,255),this._counter=0}},t.prototype.start=function(){var e=c.default.instance.currentLevel,t=e%5;this._site=t;for(var n=Math.floor((e-1)/5)%this.roadFrames.length,i=0;i<3;++i){var a=cc.instantiate(this.roadSegments[t]);a.setPosition(0,1e3*i),a.parent=this.segmentContainer,l.cocos.searchNodeByPath(a,"main_road/saidao_1").getComponent(cc.Sprite).spriteFrame=this.roadFrames[n],this.randomRoad(a)}var r=o.g_presetLevelFormula(e);this._totalWaves=r.enemyWaves,this._enemyGroup=r.enemies},t.prototype.update=function(){if(!(c.isGamePaused||(c.isGameEnded,this.segmentContainer.children.length<3))){var e=this.segmentContainer.children[0];e.y+this.segmentContainer.y<=-1e3&&(e.y+=3e3,e.removeFromParent(!1),this.segmentContainer.addChild(e),this.randomRoad(e),this._enemyWaves<this._totalWaves&&Math.ceil((e.y-2e3)/3e3)>this._enemyWaves?(this._enemyWaves+=1,this.createEnemyWave(e.y)):this._enemyWaves==this._totalWaves&&(this._enemyWaves++,e.getChildByName("sprite_finish_line").active=!0))}},t.prototype.createEnemyWave=function(e){for(var t=this,n=[],i=this._enemyGroup,r=0;r<5;++r)for(var l=100*Math.random(),d=0;d<i.length;++d){if(l<i[d].percentage){c.isBossLevel&&i[d].type==o.VehicleType.NORMAL_GRAY?n.push(Math.random()<.5?o.VehicleType.NORMAL_BLUE:o.VehicleType.NORMAL_RED):i[d].type==o.VehicleType.TRAILER?this._trailerCount<1?(this._trailerCount++,n.push(o.VehicleType.TRAILER)):n.push(o.VehicleType.NORMAL_GRAY):n.push(i[d].type);break}l-=i[d].percentage}for(r=0;r<2*n.length;++r){var h=s.utils.randomInt(0,n.length),u=s.utils.randomInt(0,n.length),p=n[h];n[h]=n[u],n[u]=p}n.map(function(n,o){return a.default.create(n).then(function(n){n.node.parent||(n.node.parent=t.vehicleContainer),n.node.setPosition(130*o-260,e+1600*Math.random()),n.node.active=!0})})},t.prototype.onVehicleExplosion=function(e,t,n){var s=this;c.default.instance.node.emit(a.VEHICLE_EVT_EXPLOSION);var l=!1,d=new Array;switch(t){case o.VehicleType.NORMAL_GRAY:for(var h=0;h<(i.bonusFlag?3:1);++h)d.push(o.ItemType.COIN);break;case o.VehicleType.NORMAL_RED:case o.VehicleType.NORMAL_BLUE:for(h=0;h<(i.bonusFlag?3:2);++h)d.push(o.ItemType.COIN);break;case o.VehicleType.ITEMS:var u=[o.ItemType.POWER,o.ItemType.N2O,o.ItemType.MAGNET];c.isCashLevel||u.push(o.ItemType.BONUS),d.push(u[Math.floor(Math.random()*u.length)]);break;case o.VehicleType.EXPLOSIVE:l=!0;break;case o.VehicleType.COINS:for(h=0;h<6;++h)d.push(o.ItemType.COIN);break;case o.VehicleType.TRAILER:d.push(o.ItemType.CHEST)}l&&!n&&this.vehicleContainer.children.forEach(function(e){var t=e.getComponent(a.default);t&&!t.isOffscreen&&t.healthValue&&t.explode()});var p=this.itemContainer.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.position)),_=function(e,t){for(var n=e.length,o=0;o<n;++o){var i=Math.random()*Math.PI/2+Math.PI/4,a=Math.cos(i)*t,c=Math.sin(i)*t,l=r.default.create(e[o],s.itemPrefabs[e[o]]);l.node.parent=s.itemContainer,l.node.setPosition(p),l.initialSpeed=cc.v2(a,c)}};_(d.filter(function(e){return e==o.ItemType.COIN}),i.speedFlag?400:300),_(d.filter(function(e){return e==o.ItemType.DIAMOND}),i.speedFlag?300:200),_(d.filter(function(e){return e!=o.ItemType.COIN&&e!=o.ItemType.DIAMOND}),i.speedFlag?200:100)},__decorate([u(i.default)],t.prototype,"racingCar",void 0),__decorate([u(cc.Node)],t.prototype,"segmentContainer",void 0),__decorate([u(cc.Node)],t.prototype,"vehicleContainer",void 0),__decorate([u(cc.Node)],t.prototype,"itemContainer",void 0),__decorate([u([cc.Prefab])],t.prototype,"itemPrefabs",void 0),__decorate([u([cc.Prefab])],t.prototype,"roadSegments",void 0),__decorate([u([cc.SpriteFrame])],t.prototype,"roadFrames",void 0),__decorate([h],t)}(cc.Component);n.default=p,cc._RF.pop()},{CommonVehicle:"CommonVehicle",GameItem:"GameItem",GameScene:"GameScene",Global:"Global",RacingCar:"RacingCar",libcocos:"libcocos",libutils:"libutils"}],ResultMenu:[function(e,t,n){"use strict";cc._RF.push(t,"d126e8Zv+hPULPF00O1dz3F","ResultMenu"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("Panel"),i=e("Global"),a=e("libwechat"),r=e("libwechat_review"),c=e("gameRecord"),s=cc._decorator,l=s.ccclass,d=s.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.background=null,t.sections=[],t.sharingButton=null,t.sp_luping_share=null,t.sp_share=null,t.image_share=null,t._videoPath="",t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.on(o.PANEL_EVT_SHOW,this.onPanelShow,this),this.node.on(o.PANEL_EVT_HIDE,this.onPanelHide,this),this.sharingButton&&this.sharingButton.node.on("click",function(){console.log("wechat share to friends"),e._videoPath?c.gameRecord.shareVideo("\u6781\u54c1\u98de\u8f66\uff0c\u75af\u72c2\u8fc7\u5173"):a.wechat.shareAppMessage()})},t.prototype.onPanelShow=function(e){if(this.title.y+=400,cc.tween(this.title).by(1,{position:cc.v2(0,-400)},{easing:"elasticOut"}).start(),4==this.sections.length)this.background.getComponent(cc.Animation).play(),this.sections[0].getComponent(cc.Label).string=e.time+"s",this.sections[1].getComponent(cc.Label).string=""+e.destroying,this.sections[2].getComponent(cc.Label).string=""+e.coins,this.sections[3].getComponent(cc.Label).string=i.g_value2String(e.cash),this.node.getChildByName("sprite_background").getChildByName("level").children[1].getComponent(cc.Label).string=""+e.level,r.wechat_review.isReview||!a.wechat.getConfig("result_video")?a.wechat.showInterstitialAd():a.wechat.showRewardedVideoAd().catch(function(){a.wechat.showInterstitialAd()}),this.image_share&&(this.image_share.spriteFrame=e.videoPath?this.sp_luping_share:this.sp_share),this._videoPath=e.videoPath;else{this._videoPath="",console.log("Failure show",e),this.sections[0].getComponent(cc.Label).string=i.g_value2String(e.cash);var t=e.progress;t>=1&&(t=.95);var n=this.node,o=n.getChildByName("sprite_background").getChildByName("sprite_failure_title");t<.4?(o.children[0].active=!1,o.children[1].active=!1):t<.7?(o.children[0].active=!0,o.children[1].active=!1):(o.children[0].active=!0,o.children[1].active=!0),n.getChildByName("sprite_background").getChildByName("level").children[1].getComponent(cc.Label).string=""+e.level,n.getChildByName("sprite_background").getChildByName("2img_probox").children[2].getComponent(cc.Label).string=Math.floor(100*t)+"%",n.getChildByName("sprite_background").getChildByName("2img_probox").children[0].getComponent(cc.Sprite).fillRange=t,n.getChildByName("sprite_background").getChildByName("2img_probox").children[1].x=324*t-168}},t.prototype.onPanelHide=function(){},__decorate([d(cc.Node)],t.prototype,"title",void 0),__decorate([d(cc.Node)],t.prototype,"background",void 0),__decorate([d([cc.Node])],t.prototype,"sections",void 0),__decorate([d(cc.Button)],t.prototype,"sharingButton",void 0),__decorate([d(cc.SpriteFrame)],t.prototype,"sp_luping_share",void 0),__decorate([d(cc.SpriteFrame)],t.prototype,"sp_share",void 0),__decorate([d(cc.Sprite)],t.prototype,"image_share",void 0),__decorate([l],t)}(cc.Component);n.default=h,cc._RF.pop()},{Global:"Global",Panel:"Panel",gameRecord:"gameRecord",libwechat:"libwechat",libwechat_review:"libwechat_review"}],ReviveMenu:[function(e,t,n){"use strict";cc._RF.push(t,"7ccdfLKEn9JBLha/f3TDwc7","ReviveMenu"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("Panel"),i=e("libwechat"),a=e("libwechat_review"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._counting=0,t._type=null,t.coutingLabel=null,t.noticeLabel=null,t.reviveButton=null,t.skipButton=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.on(o.PANEL_EVT_SHOW,this.onPanelShow,this),this.node.on(o.PANEL_EVT_HIDE,this.onPanelHide,this),this.reviveButton.node.on("click",function(){var t=e.getComponent(o.default);i.wechat.showRewardedVideoAd().then(function(){return t.hide(1)})})},t.prototype.update=function(e){this._counting>0?(this._counting-=e,this.coutingLabel.string=""+Math.ceil(this._counting)):this._counting<0&&(this._counting=0,this.skipButton.node.active=!0),this.coutingLabel.node.parent.getChildByName("1img_pro").getComponent(cc.Sprite).fillRange=-this._counting/5},t.prototype.onPanelShow=function(e){a.wechat_review.isReview||!i.wechat.getConfig("result_video")?i.wechat.showInterstitialAd():i.wechat.showRewardedVideoAd().catch(function(){i.wechat.showInterstitialAd()}),this._type=e.type,this._counting=e.counting,this.skipButton.node.active=!1,(a.wechat_review.isReview||0==e.counting)&&(this._counting=0,this.skipButton.node.active=!0)},t.prototype.onPanelHide=function(){},__decorate([s(cc.Label)],t.prototype,"coutingLabel",void 0),__decorate([s(cc.Label)],t.prototype,"noticeLabel",void 0),__decorate([s(cc.Button)],t.prototype,"reviveButton",void 0),__decorate([s(cc.Button)],t.prototype,"skipButton",void 0),__decorate([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{Panel:"Panel",libwechat:"libwechat",libwechat_review:"libwechat_review"}],RoadSegment:[function(e,t){"use strict";cc._RF.push(t,"45322YtpmpEvJ5wBFBtNvKh","RoadSegment"),cc._RF.pop()},{}],Storage:[function(e,t,n){"use strict";cc._RF.push(t,"73c7d7FWXdG5YHvXK1M6fWK","Storage"),Object.defineProperty(n,"__esModule",{value:!0}),n.g_loadStorage=n.g_saveStorage=void 0;var o="undefined"!=typeof FBInstant,i="ppgame_car_racing_alpha";n.g_saveStorage=function(e){return __awaiter(this,void 0,Promise,function(){var t,n;return __generator(this,function(a){switch(a.label){case 0:return t=Date.now(),cc.sys.localStorage.setItem(i,JSON.stringify(e)),console.log("spent "+(Date.now()-t)+"ms in saving local storage"),o?(t=Date.now(),[4,FBInstant.player.setDataAsync((n={},n[i]=JSON.stringify(e),n))]):[3,2];case 1:a.sent(),console.log("spent "+(Date.now()-t)+"ms in saving facebook cloud storage"),a.label=2;case 2:return[2]}})})},n.g_loadStorage=function(){return __awaiter(this,void 0,Promise,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return o?[4,FBInstant.player.getDataAsync([i])]:[3,2];case 1:e=t.sent()[i],t.label=2;case 2:if(e||(e=cc.sys.localStorage.getItem(i)),!e)return[2];try{return[2,JSON.parse(e)]}catch(e){console.warn("Error broken storage."),console.warn(e)}return[2]}})})},cc._RF.pop()},{}],StoreMenu:[function(e,t,n){"use strict";cc._RF.push(t,"8740b/Fv4FApbnjoUoC2WlP","StoreMenu"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("ListView"),i=e("Panel"),a=e("Global"),r=e("MainScene"),c=e("libwechat"),s=cc._decorator,l=s.ccclass,d=s.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._price=0,t._level=0,t.carLevelLabel=null,t.carPriceLabel=null,t.carImageSprite=null,t.cashSprite=null,t.purchaseButton=null,t.videoAdSprite=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"purchasable",{get:function(){return this.purchaseButton.interactable},set:function(e){this.purchaseButton.interactable=e,e?(this.cashSprite.node.opacity=255,this.carImageSprite.setMaterial(0,t.unlockedMaterial),this.carImageSprite.node.color=cc.Color.WHITE):(this.cashSprite.node.opacity=0,this.carPriceLabel.string="\u672a\u89e3\u9501",this.carImageSprite.setMaterial(0,t.disabledMaterial),this.carImageSprite.node.color=cc.color().fromHEX("#66e8ec")),e||(this.carPriceLabel.string="\u672a\u89e3\u9501")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"free",{get:function(){return Boolean(this.videoAdSprite.node.opacity)},set:function(e){this.videoAdSprite.node.opacity=e?255:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"price",{get:function(){return this._price},set:function(e){this._price=e,this.carPriceLabel.string=a.g_value2String(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e,this.carLevelLabel.string=""+e,this.carImageSprite.spriteFrame=a.presetCars[e].perspective},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.carLevelLabel=this.node.getChildByName("label_car_level").getComponent(cc.Label),this.purchaseButton=this.node.getChildByName("button_purchase").getComponent(cc.Button),this.carPriceLabel=this.purchaseButton.node.getChildByName("label_price").getComponent(cc.Label),this.videoAdSprite=this.purchaseButton.node.getChildByName("sprite_video_ad").getComponent(cc.Sprite),this.cashSprite=this.purchaseButton.node.getChildByName("sprite_cash").getComponent(cc.Sprite),this.carImageSprite=this.node.getChildByName("sprite_car_image").getComponent(cc.Sprite),this.purchaseButton.node.on("click",function(){return e.node.emit("on-purchase-button",e.level,e.free)})},t}(cc.Component),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listView=null,t.disabledMaterial=null,t.unlockedMaterial=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.on(i.PANEL_EVT_SHOW,this.onPanelShow,this),h.disabledMaterial=this.disabledMaterial,h.unlockedMaterial=this.unlockedMaterial},t.prototype.onPanelShow=function(e){var t=this;this._storeItems||(this.listView.length=a.presetCars.length-1,this._storeItems=this.listView.nodes.map(function(e){return e.addComponent(h)}),this.listView.nodes.forEach(function(e){return e.on("on-purchase-button",function(e,n){var o=r.default.instance;n?c.wechat.showRewardedVideoAd().then(function(){o.doPurchaseCar(e,n),t.updateStoreItems()}):(o.doPurchaseCar(e),t.updateStoreItems())})})),this._listOfPrices=e.listOfPrices,this._maximumLevel=e.maximumLevel,this.updateStoreItems()},t.prototype.updateStoreItems=function(){var e=this;this._storeItems.forEach(function(t,n){var o=n+1;t.level=o,t.price=e._listOfPrices[n],1==o||o<=e._maximumLevel-3?(t.purchasable=!0,t.free=!1):o==e._maximumLevel-2?(t.purchasable=!0,t.free=!0):(t.purchasable=!1,t.free=!1)})},__decorate([d(o.default)],t.prototype,"listView",void 0),__decorate([d(cc.Material)],t.prototype,"disabledMaterial",void 0),__decorate([d(cc.Material)],t.prototype,"unlockedMaterial",void 0),__decorate([l],t)}(cc.Component);n.default=u,cc._RF.pop()},{Global:"Global",ListView:"ListView",MainScene:"MainScene",Panel:"Panel",libwechat:"libwechat"}],UnlockMenu:[function(e,t,n){"use strict";cc._RF.push(t,"521bb6L0f9OB5ahC8pL1KfP","UnlockMenu"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("Panel"),i=e("Global"),a=cc._decorator,r=a.ccclass,c=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.carImageSprite=null,t.carLevelLabel=null,t.carNameLabel=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.on(o.PANEL_EVT_SHOW,this.onPanelShow,this)},t.prototype.onPanelShow=function(e){this.carImageSprite.spriteFrame=i.presetCars[e].perspective,this.carLevelLabel.string=""+e,this.carNameLabel.string=i.presetCars[e].name},__decorate([c(cc.Sprite)],t.prototype,"carImageSprite",void 0),__decorate([c(cc.Label)],t.prototype,"carLevelLabel",void 0),__decorate([c(cc.Label)],t.prototype,"carNameLabel",void 0),__decorate([r],t)}(cc.Component);n.default=s,cc._RF.pop()},{Global:"Global",Panel:"Panel"}],WXGameWall:[function(e,t,n){"use strict";var o;cc._RF.push(t,"571d5Zy6otDnIVaT/GJKYsk","WXGameWall"),Object.defineProperty(n,"__esModule",{value:!0}),n.wechatGameWall=void 0;var i="undefined"!=typeof wx;function a(e,t,n,o,i){return void 0===t&&(t="get"),void 0===n&&(n=null),void 0===o&&(o={}),void 0===i&&(i=""),new Promise(function(a,r){var c=new XMLHttpRequest;for(var s in c.open(t,e,!0),c.responseType=i,o)c.setRequestHeader(s,o[s]);c.onload=function(){c.status>=200&&c.status<300?a(c.response):r("XHR_RES_ERROR")},c.onerror=function(){r("XHR_REQ_ERROR")},c.send(n)})}var r=0;n.wechatGameWall=new((o=function(){function e(){this._Single=null,this._Line=null,this._Wall=null,this.gridWidth=120,this.gridHeight=120,this.offSet=4,this.iconFrameGroup=[],this.iconIdGroup=[],this.iconNameGroup=[],this.totalImgNum=9,this.buttonGroup1=[],this.buttonGroup2=[],this.buttonGroup3=[],this.wallData=null,this.nameHeight=25,this.tittleHeight=50,this.bigOffSet=30,this.tittleFontSize=30,this.nameFontSize=26,this._grayBg=null,this._scale=1,this.firstIdx1=0,this.firstIdx2=0,this.closeButton=null,this.wallType=0,this.singleScale=1}return e.prototype.init=function(){var e=cc.view.getDesignResolutionSize(),t=cc.view.getFrameSize();t.width/t.height<e.width/e.height?this._scale=t.width/e.width/(t.height/e.height):this._scale=t.height/e.height/(t.width/e.width)},e.prototype.initGameWall=function(e,t,o,i,r){return void 0===t&&(t=cc.v2(0,0)),void 0===o&&(o=cc.v2(0,0)),void 0===i&&(i=cc.v2(0,0)),void 0===r&&(r=null),__awaiter(this,void 0,void 0,function(){var c,s,l,d,h;return __generator(this,function(){return n.wechatGameWall._wallMask1?[2]:(this.init(),n.wechatGameWall.iconFrameGroup=[],n.wechatGameWall.iconIdGroup=[],n.wechatGameWall.iconNameGroup=[],n.wechatGameWall.buttonGroup1=[],n.wechatGameWall.buttonGroup2=[],n.wechatGameWall.buttonGroup3=[],n.wechatGameWall.firstIdx1=0,n.wechatGameWall.firstIdx2=0,c=new cc.Node("wallMask1"),s=new cc.Node("wallMask2"),l=new cc.Node("wallMask3"),d=new cc.Node("wallMask4"),h=cc.Canvas.instance,a("https://detective.p8games.com/wxgame/gameList?appid="+e+"&count="+n.wechatGameWall.totalImgNum+"&name=1","get",null,{},"json").then(function(e){"string"==typeof e&&(e=JSON.parse(e)),n.wechatGameWall.wallData=e;for(var a=0;a!=e.length;a++)n.wechatGameWall.loadIcons(e[a].icon,e[a].appid,e[a].name);var u=cc.size(n.wechatGameWall.gridWidth+n.wechatGameWall.offSet,n.wechatGameWall.gridHeight+n.wechatGameWall.offSet);cc.size(5*(n.wechatGameWall.gridWidth+n.wechatGameWall.offSet)+n.wechatGameWall.offSet,n.wechatGameWall.gridHeight+2*n.wechatGameWall.offSet);var p=(cc.winSize.width-6*n.wechatGameWall.offSet)/5+2*n.wechatGameWall.offSet;cc.size(3*(n.wechatGameWall.gridWidth+n.wechatGameWall.offSet)+n.wechatGameWall.offSet,3*(n.wechatGameWall.gridHeight+n.wechatGameWall.offSet)+2*n.wechatGameWall.offSet);var _=cc.size(3*(n.wechatGameWall.gridWidth+n.wechatGameWall.bigOffSet)+n.wechatGameWall.bigOffSet,3*(n.wechatGameWall.gridHeight+n.wechatGameWall.bigOffSet)+2*n.wechatGameWall.bigOffSet+3*n.wechatGameWall.nameHeight+n.wechatGameWall.tittleHeight);c.addComponent(cc.Mask),s.addComponent(cc.Mask),c.setPosition(t),s.setPosition(o),l.setPosition(i),c.setContentSize(u),s.setContentSize(cc.size(cc.winSize.width,p)),l.setContentSize(_),h.node.addChild(c),h.node.addChild(s),h.node.addChild(d),h.node.addChild(l),c.zIndex=1e4,s.zIndex=1e4,l.zIndex=1e4,d.zIndex=1e4;var g=new cc.Node("wallBg1"),m=new cc.Node("wallBg2"),f=new cc.Node("wallBg3"),v=new cc.Node("wallBg4"),w=new cc.Texture2D,y=new cc.SpriteFrame;w.initWithData(new Uint8Array([0,0,0]),cc.Texture2D.PixelFormat.RGB888,1,1),y.setTexture(w),y.setRect(cc.rect(0,0,u.width,u.height)),g.addComponent(cc.Sprite).spriteFrame=y,g.setPosition(cc.v2(0,0)),g.addComponent(cc.BlockInputEvents),c.addChild(g),y.setRect(cc.rect(0,0,cc.winSize.width,p)),m.addComponent(cc.Sprite).spriteFrame=y,m.setPosition(cc.v2(0,0)),m.addComponent(cc.BlockInputEvents),s.addChild(m);var b=new cc.Texture2D,C=new cc.SpriteFrame;b.initWithData(new Uint8Array([255,255,255]),cc.Texture2D.PixelFormat.RGB888,1,1),C.setTexture(b),C.setRect(cc.rect(0,0,_.width,_.height)),f.addComponent(cc.Sprite).spriteFrame=C,f.setPosition(cc.v2(0,0)),f.addComponent(cc.BlockInputEvents),l.addChild(f),y.setRect(cc.rect(0,0,cc.winSize.width,cc.winSize.height)),v.addComponent(cc.Sprite).spriteFrame=y,v.setPosition(cc.v2(0,0)),v.opacity=200,v.addComponent(cc.BlockInputEvents),d.addChild(v);var S=new cc.Node("grayLabel");S.addComponent(cc.Label).string="\u6e38\u620f\u63a8\u8350",S.getComponent(cc.Label).fontSize=40,S.setPosition(cc.v2(0,l.height/2+60)),S.color=cc.color(255,200,20),S.getComponent(cc.Label).enableBold=!0,l.addChild(S),n.wechatGameWall._Single=c,n.wechatGameWall._Line=s,n.wechatGameWall._Wall=l,n.wechatGameWall._grayBg=d,n.wechatGameWall._Single.opacity=0,n.wechatGameWall._Line.opacity=0,n.wechatGameWall._Wall.opacity=0,n.wechatGameWall._grayBg.active=!1,n.wechatGameWall.load_callback=r}),[2,!0])})})},Object.defineProperty(e.prototype,"showWallTimes",{get:function(){return r},enumerable:!1,configurable:!0}),e.prototype.loadIcons=function(e,t,o){var i=t,a=o;cc.loader.load({url:e,type:"jpg"},function(e,t){var o=new cc.SpriteFrame(t);n.wechatGameWall.iconFrameGroup.push(o),n.wechatGameWall.iconIdGroup.push(i),n.wechatGameWall.iconNameGroup.push(a),n.wechatGameWall.totalImgNum==n.wechatGameWall.iconFrameGroup.length&&(n.wechatGameWall.initSigle(),n.wechatGameWall.initLine(),n.wechatGameWall.initWall(),n.wechatGameWall.load_callback&&n.wechatGameWall.load_callback())})},e.prototype.initSigle=function(){for(var e=0;e!=n.wechatGameWall.iconFrameGroup.length;e++){var t=new cc.Node("appButton");t.addComponent(cc.Sprite).spriteFrame=n.wechatGameWall.iconFrameGroup[e],t.scale=12/14,t.addComponent(cc.Button),t.setPosition(cc.v2(e*(n.wechatGameWall.gridWidth+n.wechatGameWall.offSet),0));var o={appId:n.wechatGameWall.iconIdGroup[e]};t.attr(o),n.wechatGameWall._Single.addChild(t),n.wechatGameWall.buttonGroup1.push(t),t.on(cc.Node.EventType.TOUCH_END,n.wechatGameWall.goToGame)}n.wechatGameWall.buttonRoll1(),n.wechatGameWall._Single.active=!1,n.wechatGameWall._Single.scale=n.wechatGameWall.singleScale},e.prototype.release=function(){},e.prototype.buttonRoll1=function(){n.wechatGameWall._Single.runAction(cc.sequence(cc.delayTime(5),cc.callFunc(function(){for(var e=0;e!=n.wechatGameWall.buttonGroup1.length;e++)n.wechatGameWall.buttonGroup1[e].runAction(cc.moveBy(.2,cc.v2(0-n.wechatGameWall.gridWidth-n.wechatGameWall.offSet,0)))}),cc.delayTime(.2),cc.callFunc(function(){var e=n.wechatGameWall.firstIdx1-1;-1==e&&(e=8);var t=n.wechatGameWall.buttonGroup1[e].x+n.wechatGameWall.offSet+n.wechatGameWall.gridWidth;n.wechatGameWall.buttonGroup1[n.wechatGameWall.firstIdx1].setPosition(cc.v2(t,0)),n.wechatGameWall.firstIdx1++,n.wechatGameWall.firstIdx1>n.wechatGameWall.buttonGroup1.length-1&&(n.wechatGameWall.firstIdx1=0),n.wechatGameWall.buttonRoll1()}),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,0)))},e.prototype.initLine=function(){for(var e=(cc.winSize.width-6*n.wechatGameWall.offSet)/5,t=0;t!=n.wechatGameWall.iconFrameGroup.length;t++){var o=new cc.Node("appButton");o.addComponent(cc.Sprite).spriteFrame=n.wechatGameWall.iconFrameGroup[t],o.addComponent(cc.Button),o.setContentSize(e,e),o.scale=e/140;var i=-cc.winSize.width/2+n.wechatGameWall.offSet+e/2+t*(e+n.wechatGameWall.offSet);o.setPosition(cc.v2(i,0));var a={appId:n.wechatGameWall.iconIdGroup[t]};o.attr(a),n.wechatGameWall._Line.addChild(o),n.wechatGameWall.buttonGroup2.push(o),o.on(cc.Node.EventType.TOUCH_END,n.wechatGameWall.goToGame)}n.wechatGameWall.buttonRoll2(),n.wechatGameWall._Line.active=!1},e.prototype.buttonRoll2=function(){var e=(cc.winSize.width-6*n.wechatGameWall.offSet)/5;n.wechatGameWall._Line.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){for(var t=e+n.wechatGameWall.offSet,o=cc.winSize.width/2+2*t,i=0;i!=n.wechatGameWall.buttonGroup2.length;i++){var a=n.wechatGameWall.buttonGroup2[i];a.x>=o?(a.x-=t,a.active=!1):(a.active=!0,n.wechatGameWall.buttonGroup2[i].runAction(cc.moveBy(.2,cc.v2(-t,0))))}}),cc.delayTime(.4),cc.callFunc(function(){var t=n.wechatGameWall.buttonGroup2.length;n.wechatGameWall.buttonGroup2[n.wechatGameWall.firstIdx2].x=-cc.winSize.width/2+n.wechatGameWall.offSet+e/2+(t-1)*(e+n.wechatGameWall.offSet),n.wechatGameWall.firstIdx2++,n.wechatGameWall.firstIdx2>=t&&(n.wechatGameWall.firstIdx2=0),n.wechatGameWall.buttonRoll2()})))},e.prototype.initWall=function(){var e=new cc.Node("closeButton");e.addComponent(cc.Button),e.setContentSize(cc.size(100,40)),e.setPosition(cc.v2(0,0-n.wechatGameWall._Wall.height/2-30)),n.wechatGameWall._Wall.addChild(e),e.on(cc.Node.EventType.TOUCH_END,n.wechatGameWall.hideWall);var t=new cc.Node("buttonFont");t.setPosition(cc.v2(0,-10)),t.addComponent(cc.Label).string="\u70b9\u51fb\u9000\u51fa",t.getComponent(cc.Label).fontSize=n.wechatGameWall.nameFontSize,t.getComponent(cc.Label).enableUnderline=!0,t.getComponent(cc.Label).underlineHeight=2,t.color=cc.color(250,250,250),e.addChild(t),n.wechatGameWall.closeButton=e;for(var o=0;o!=n.wechatGameWall.iconFrameGroup.length;o++){var i=new cc.Node("appButton");i.addComponent(cc.Sprite).spriteFrame=n.wechatGameWall.iconFrameGroup[o],i.addComponent(cc.Button),i.scale=12/14;var a=Math.floor(o/3),r=o-3*a,c=0-n.wechatGameWall._Wall.width/2+n.wechatGameWall.gridWidth/2+n.wechatGameWall.bigOffSet+(n.wechatGameWall.gridWidth+n.wechatGameWall.bigOffSet)*r,s=n.wechatGameWall._Wall.height/2-n.wechatGameWall.gridHeight/2-n.wechatGameWall.bigOffSet-((n.wechatGameWall.gridHeight+n.wechatGameWall.bigOffSet+n.wechatGameWall.nameHeight)*a+n.wechatGameWall.tittleHeight);i.setPosition(cc.v2(c,s));var l={appId:n.wechatGameWall.iconIdGroup[o]};i.attr(l),n.wechatGameWall._Wall.addChild(i),n.wechatGameWall.buttonGroup3.push(i),i.on(cc.Node.EventType.TOUCH_END,n.wechatGameWall.goToGame);var d=new cc.Node("appName");d.setPosition(cc.v2(0,0-n.wechatGameWall.gridHeight/2-2*n.wechatGameWall.nameHeight)),d.addComponent(cc.Label).string=n.wechatGameWall.iconNameGroup[o],d.getComponent(cc.Label).fontSize=n.wechatGameWall.nameFontSize,d.color=cc.color(0,0,0),i.addChild(d)}n.wechatGameWall._Wall.active=!1},e.prototype.setWallActionType=function(e){0==e||1==e||2==e?n.wechatGameWall.wallType=e:console.log("we don't have type : "+e)},e.prototype.setSingleScale=function(e){n.wechatGameWall._Single?(n.wechatGameWall._Single.scale=e*this._scale,n.wechatGameWall.singleScale=e*this._scale):n.wechatGameWall.singleScale=e*this._scale},e.prototype.goToGame=function(e){var t=e.target.appId;console.log(t),i&&wx.navigateToMiniProgram({appId:t,extraData:{foo:"bar"},envVersion:"release",success:function(){console.log(" open app !!! ")}})},e.prototype.showSingle=function(e){if(void 0===e&&(e=null),n.wechatGameWall._Single)return e?n.wechatGameWall._Single.setPosition(e):n.wechatGameWall._Single.parent.single_pos&&n.wechatGameWall._Single.setPosition(n.wechatGameWall._Single.parent.single_pos),255!=n.wechatGameWall._Single.opacity&&(n.wechatGameWall._Single.opacity=255),n.wechatGameWall._Single.scale!=n.wechatGameWall.singleScale&&(n.wechatGameWall._Single.scale=n.wechatGameWall.singleScale),n.wechatGameWall._Single.active=!0},e.prototype.showLine=function(e){if(void 0===e&&(e=void 0),n.wechatGameWall._Line)return 255!=n.wechatGameWall._Line.opacity&&(n.wechatGameWall._Line.opacity=255),"number"==typeof e&&(n.wechatGameWall._Line.y=e),n.wechatGameWall._Line.active=!0},e.prototype.showWall=function(e){if(void 0===e&&(e=null),n.wechatGameWall._Wall){r++,n.wechatGameWall._Wall.zIndex=1e4,e&&n.wechatGameWall._Wall.setPosition(e),255!=n.wechatGameWall._Wall.opacity&&(n.wechatGameWall._Wall.opacity=255),n.wechatGameWall._grayBg.active||(n.wechatGameWall._grayBg.active=!0);var t=n.wechatGameWall._Wall.getPosition();n.wechatGameWall._Wall.setPosition(cc.v2(-cc.winSize.width/2-n.wechatGameWall._Wall.width/2,n.wechatGameWall._Wall.y)),n.wechatGameWall._Wall.active=!0,n.wechatGameWall._Wall.runAction(cc.moveTo(.2,t)),n.wechatGameWall.closeButton.on(cc.Node.EventType.TOUCH_END,n.wechatGameWall.hideWall)}},e.prototype.hideSingle=function(){if(n.wechatGameWall._Single)return n.wechatGameWall._Single.active=!1},e.prototype.hideLine=function(){if(n.wechatGameWall._Line)return n.wechatGameWall._Line.active=!1},e.prototype.hideWall=function(){n.wechatGameWall._Wall&&(n.wechatGameWall._grayBg.active&&(n.wechatGameWall._grayBg.active=!1),n.wechatGameWall._Wall.runAction(cc.sequence(cc.moveTo(.2,cc.v2(-cc.winSize.width/2-n.wechatGameWall._Wall.width/2,n.wechatGameWall._Wall.y)),cc.callFunc(function(){n.wechatGameWall._Wall.active=!1}))),n.wechatGameWall.closeButton.off(cc.Node.EventType.TOUCH_END,n.wechatGameWall.hideWall),"function"==typeof n.wechatGameWall._onHideWall_callback&&n.wechatGameWall._onHideWall_callback(),cc.Canvas.instance.node.emit("hide-wall"))},e.prototype.onHideWall=function(e){this._onHideWall_callback=e},e}())._wallMask1=null,o._wallMask2=null,o._wallMask3=null,o._wallMask4=null,o),cc._RF.pop()},{}],adBox:[function(e,t,n){"use strict";cc._RF.push(t,"c3caa6knmNBxrOk/4aNZIHU","adBox"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass;o.property;var a=e("libcocos"),r=e("libwechat"),c=e("libwechat_review"),s=e("bannerAd"),l=function(e){function t(){var t=e.call(this)||this;return t.event_handle=null,t._native_ad_active=!1,t.tips_label=null,t.unlock_btn_node=null,t._maxProgress=100,t._boxProgress=0,t._adOutValue=0,t._bannerOut=!1,t._close_resolve=null,t._video_valid=!1,t}var n;return __extends(t,e),n=t,t.prototype.onEnable=function(){this.event_handle=r.wechat.on(r.WX_EVT_GAME_SHOW,this.onShow,this),n.isShow=!0},t.prototype.onDisable=function(){r.wechat.off(r.WX_EVT_GAME_SHOW,this.event_handle,this),n.isShow=!1,this._close_resolve&&this._close_resolve(),this._close_resolve=null},t.prototype.onShow=function(){r.wechat.hideBannerAd()},t.checkAdBox=function(e){void 0===e&&(e=1);var t=r.wechat.getConfig("ad_box"),n=void 0===t?1:parseInt(t);return 1==e?(this.pop_counter++,1==n||n>0&&this.pop_counter%n==1):!!n},t.checkStartAdBox=function(){return!(c.wechat_review.isReview||this.auto_poped||!r.wechat.getConfig("start_ad_box")||(this.auto_poped=!0,0))},t.prototype.start=function(){this.node.getChildByName("adButton").on(cc.Node.EventType.TOUCH_END,this.boxTouch,this);var e=this.node.getChildByName("adButton").children[0];e.scale=.7,cc.tween(e).repeatForever(cc.tween().to(.1,{scale:.77},{easing:"sineOut"}).to(.15,{scale:.7},{easing:"sineIn"})).start(),this.node.getChildByName("bgNode").on("click",this.onClose,this),this.tips_label||(this.tips_label=this.node.getChildByName("tips_label")),cc.tween(this.tips_label).repeatForever(cc.tween().to(.5,{opacity:150}).to(.5,{opacity:255})).start()},t.prototype.adBoxShow=function(e){return void 0===e&&(e=null),__awaiter(this,void 0,void 0,function(){var e,t,o,i,a,c,l,d,h,u,p=this;return __generator(this,function(){if(e=r.wechat.wxCoordProjection(this.node.getChildByName("banner")),s.bannerAd.setTagTop("hb",e.top),n._native_ad||"undefined"==typeof wx||void 0===window["adunit-line-adbox"]||(t=wx.createCustomAd({adUnitId:window["adunit-line-hb"],adIntervals:30,style:{top:e.top,left:(r.wechat.getSystemInfo().screenWidth-360)/2}}),n._native_ad=t,t.onLoad(function(){console.log("hb line banner loaded"),p.showNativeAd()})),this._video_valid=!1,setTimeout(function(){p.preloadRewardVideoAd()},2e3),this._boxProgress=35,this.setProgress(),this.node.getChildByName("adButton").active=!0,this.node.getChildByName("boxNode").active=!0,this.node.getChildByName("boxNodeOpen").active=!1,this.tips_label||(this.tips_label=this.node.getChildByName("tips_label")),this.node.getChildByName("enterProgress").active=!0,this.tips_label.active=!1,this.node.zIndex=10002,this.node.active=!0,o=cc.winSize.width,i=cc.winSize.height,o/=this.node.scale,i/=this.node.scale,this.node.getChildByName("bgNode").setContentSize(o,i),n._show_counter++,a=this.node.getChildByName("adButton"),2==r.wechat.getConfig("ad_box_type")){switch(c=r.wechat.getConfig("ad_box_button_position")||{type:"bottom",y:.1},l=c.type||"center",d=c.x||0,h=c.y||0,d>-1&&d<1&&(d*=cc.winSize.width),h>-1&&h<1&&(h*=cc.winSize.height),l){case"center":break;case"bottom":h+=-cc.winSize.height/2;break;case"right":d+=cc.winSize.width/2}console.log("-----------------ad box button postion",c),d/=this.node.scale,h/=this.node.scale,a.setPosition(cc.v2(d,h))}else(u=r.wechat.getConfig("button_position"))||(u=1),1==u||n._show_counter%u==1?a.y=-i/2+90/this.node.scale:a.y=this.node.getChildByName("enterProgress").y-100;return this._bannerOut=!1,this._adOutValue=this.randomNum(1*this._maxProgress/2,3*this._maxProgress/5),this._native_ad_active=!1,this.hideNativeAd(),r.wechat.showBannerAd("hb").catch(function(){console.log("fail to show banner of hb page"),p._native_ad_active=!0,p.showNativeAd()}),[2,new Promise(function(e){p._close_resolve=e})]})})},t.prototype.preloadRewardVideoAd=function(){var e=this;r.wechat.loadRewardedVideoAd().then(function(){e._video_valid=!0,console.log("rewardVideoAd loaded")}).catch(function(t){"rewarded video ad is showing"===t?setTimeout(function(){e.preloadRewardVideoAd()},1e3):console.log("fail to load rewardVideoAd",t)})},t.prototype.showNativeAd=function(){var e=this;console.log("hb showNativeAd",!!n._native_ad,this.node.isValid,this.node.active,this._native_ad_active);var t=n._native_ad;t&&(this.node.isValid&&this.node.active&&this._native_ad_active?t.show().then(function(){e.node.isValid&&e.node.active&&e._native_ad_active||t.hide()}):t.isShow()&&t.hide())},t.prototype.hideNativeAd=function(){this._native_ad_active=!1,n._native_ad&&n._native_ad.isShow()&&n._native_ad.hide()},t.prototype.onVideoShow=function(){this._boxProgress=this._maxProgress,this.setProgress(),this.node.getChildByName("adButton").active=!1,this.node.getChildByName("boxNode").active=!1,this.node.getChildByName("boxNodeOpen").active=!0,this.node.getChildByName("boxNodeOpen").runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))},t.prototype.boxTouch=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n=this;return __generator(this,function(o){switch(o.label){case 0:if(this.node.getChildByName("boxNode").runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.05,-10),cc.rotateTo(.05,0))),this._boxProgress+=10,!(this._boxProgress>=this._adOutValue)||this._bannerOut)return[3,13];switch(this._bannerOut=!0,r.wechat.getConfig("ad_box_type")){case 3:return[3,1];case 2:return[3,5]}return[3,10];case 1:return[4,r.wechat.showCustomBanner("ad_box")];case 2:return o.sent()?[3,4]:(r.wechat.hideCustomBanner(),[4,r.wechat.showBannerAd("hb2").catch(function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,r.wechat.startRewardedVideoAd()];case 1:return e.sent(),[2]}})})})]);case 3:o.sent(),o.label=4;case 4:return[3,12];case 5:return(e=!this._video_valid)?[3,7]:[4,r.wechat.startRewardedVideoAd()];case 6:e=!o.sent(),o.label=7;case 7:return e?[4,r.wechat.showBannerAd("hb2").catch(function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(){return r.wechat.showCustomBanner("ad_box"),[2]})})})]:[3,9];case 8:o.sent(),o.label=9;case 9:return[3,12];case 10:return[4,r.wechat.showBannerAd("hb2").catch(function(){return __awaiter(n,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return(e=!this._video_valid)?[3,2]:[4,r.wechat.startRewardedVideoAd()];case 1:e=!t.sent(),t.label=2;case 2:return e&&r.wechat.showCustomBanner("ad_box"),[2]}})})})];case 11:return o.sent(),[3,12];case 12:this._boxProgress=this._maxProgress,setTimeout(function(){n._boxProgress=n._maxProgress,n.setProgress(),n.node.getChildByName("adButton").active=!1,n.node.getChildByName("boxNode").active=!1,n.node.getChildByName("boxNodeOpen").active=!0,n.node.getChildByName("boxNodeOpen").runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))},500),t=this,this.node.runAction(cc.sequence(cc.delayTime(2.2),cc.callFunc(function(){t.tips_label.active=!0,t.node.getChildByName("enterProgress").active=!1}))),o.label=13;case 13:return this.setProgress(),[2]}})})},t.prototype.onClose=function(){this.node.getChildByName("tips_label").active&&(cc.Canvas.instance.node.emit("hideBanner"),console.log("send banner hide event"),this.node.active=!1,this.node.removeFromParent(),cc.Canvas.instance.node.emit("show-continue"))},t.prototype.update=function(){this._boxProgress>.5&&this._boxProgress<this._maxProgress?(this._boxProgress-=.5,this.setProgress()):this._boxProgress<this._maxProgress&&(this._boxProgress=0,this.setProgress())},t.prototype.setProgress=function(){this.node.getChildByName("enterProgress").getComponent(cc.ProgressBar).progress=this._boxProgress/this._maxProgress},t.prototype.randomNum=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.load=function(){return new Promise(function(e,t){a.cocos.loadRes("adBox/adBox",cc.Prefab).then(function(t){e(cc.instantiate(t))}).catch(function(e){t(e)})})},t._native_ad=null,t.isShow=!1,t.pop_counter=0,t.auto_poped=!1,t._show_counter=0,n=__decorate([i],t)}(cc.Component);n.default=l,cc._RF.pop()},{bannerAd:"bannerAd",libcocos:"libcocos",libwechat:"libwechat",libwechat_review:"libwechat_review"}],bannerAd:[function(e,t,n){"use strict";cc._RF.push(t,"52c008bJbpK0YIY4jLkZRx2","bannerAd"),Object.defineProperty(n,"__esModule",{value:!0}),n.bannerAd=void 0,n.bannerAd=new(function(){function e(){var e=this;this._refresh_time=1,this.sysinfo=null,this.top_of_tag={},this._inited=!1,this._active=!1,this.current_ad=null,this.next_ad_index=0,this._style={blink:0},this._blinking=0,this._tag="",this.banner_list=[],"undefined"!=typeof wx&&void 0!==wx.getSystemInfoSync&&(this.sysinfo=wx.getSystemInfoSync(),setInterval(function(){e.update(.1)},100))}return Object.defineProperty(e.prototype,"refresh_time",{get:function(){return this._refresh_time},set:function(e){this._refresh_time=e},enumerable:!1,configurable:!0}),e.prototype.init=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,o,i,a,r,c=this;return __generator(this,function(s){switch(s.label){case 0:if(console.log("bannerAd init",e),void 0===e)return[2];if("string"==typeof e&&(e=[e]),!e.length)return[2];if(this._inited)return[2];if(this._inited=!0,"undefined"==typeof wx||void 0===wx.createBannerAd)return[2];t=this.sysinfo,n=.234375*t.screenWidth,o=n/9*16,"undefined"!=typeof tt?o=300*n/104:"undefined"!=typeof qq&&(o=.92*t.screenWidth,n=o/16*9),i=function(i){var r;return __generator(this,function(s){switch(s.label){case 0:return"string"!=typeof e[i]?[3,2]:(r=wx.createBannerAd({adUnitId:e[i],adIntervals:30,style:{height:n,width:o,left:(t.screenWidth-o)/2,top:t.screenHeight-n}}),console.log("createBannerAd",e[i]),a.banner_list.push({index:i,ad:r,size:{width:r.style.realWidth,height:r.style.realHeight,valid:!1}}),r.my_index=i,r.onLoad(function(){console.log("banner "+i+" loaded",r.my_index),c.banner_list[i].valid=!0}),r.onError(function(e){console.log("banner "+i+" error:",e),c.banner_list[i].valid=!1}),r.onResize(function(e){e&&(r.style.realWidth!=e.width&&(r.style.realWidth=e.width),r.style.realHeight!=e.height&&(r.style.realHeight=e.height),c.onResize(r,e))}),[4,new Promise(function(e){setTimeout(function(){e()},5e3)})]);case 1:s.sent(),s.label=2;case 2:return[2]}})},a=this,r=0,s.label=1;case 1:return r<e.length?[5,i(r)]:[3,4];case 2:s.sent(),s.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(e){this._active!=e&&(this._active=e)},enumerable:!1,configurable:!0}),e.prototype.onResize=function(e,t){var n=this.getAds(e);n&&(n.size=t);var o=this.sysinfo,i=t.width;t.height,e.style.left=(o.windowWidth-i)/2,n&&this.setTop(n)},e.prototype.getAds=function(e){for(var t=0;t<this.banner_list.length;t++)if(e==this.banner_list[t].ad)return this.banner_list[t];return null},e.prototype.totalValid=function(){for(var e=0,t=0,n=this.banner_list.length;t<n;t++)this.banner_list[t].valid&&e++;return e},e.prototype.getNextAds=function(){var e=this.banner_list[this.next_ad_index];if(e&&e.valid)return e;if(this.next_ad_index++,this.next_ad_index>=this.banner_list.length){if(this.totalValid()<1)return null;this.next_ad_index=0}return this.getNextAds()},e.prototype.setTop=function(e){var t=this.sysinfo,n=e.ad,o=this.top_of_tag[this._tag];n.style.top="number"==typeof o?o:t.windowHeight-e.size.height},e.prototype.setTagTop=function(e,t){this.top_of_tag[e]=t},e.prototype.show=function(e){var t=this;return this._style={blink:"blink"==e?1:0},this._blinking=0,this._tag=e,this.banner_list.length?this.active?(this.current_ad&&this.current_ad.is_showed&&this.setTop(this.current_ad),Promise.resolve()):new Promise(function(e,n){var o=t.getNextAds();if(o){t.active=!0;var i=o.ad;t.current_ad=o,i.show().then(function(){t.setTop(o),o.is_showed=!0,o.show_dt=0,console.log("banner showed",o.index),t.active?cc.Canvas.instance.node.emit("on-banner-show"):(i.hide(),o.is_showed=!1,console.log("hide"),o.hide_resolve&&(o.hide_resolve(),o.hide_resolve=null),cc.Canvas.instance.node.emit("on-banner-hide")),e()}).catch(function(i){console.log("fail to show banner",i),o.valid=!1,t.active?n(i):e()})}else n("no banner ad")}):Promise.reject("no banner ad")},e.prototype.hide=function(){var e=this;return console.log("bannerAd.hide",this.active,!!this.current_ad,!!this.current_ad&&this.current_ad.is_showed),this.active?(this.active=!1,this.current_ad?this.current_ad.is_showed?(this.current_ad.ad.hide(),this.current_ad.is_showed=!1,this._refresh_time||this.next_ad_index++,cc.Canvas.instance.node.emit("on-banner-hide"),Promise.resolve()):new Promise(function(t){e.current_ad.hide_resolve=t}):Promise.resolve()):Promise.resolve()},e.prototype.showAds=function(e){var t=this,n=e.ad;n&&n.show().then(function(){t.setTop(e),e.is_showed=!0,t.active||(n.hide(),e.is_showed=!1,console.log("hide"),e.hide_resolve&&(e.hide_resolve(),e.hide_resolve=null)),e.show_dt=0,console.log("banner showed",e.index)}).catch(function(t){console.log("fail to show banner",t),e.valid=!1})},e.prototype.update=function(e){if(this.active&&this.current_ad&&this.refresh_time&&!(this.banner_list.length<1)){if(this._blinking){if(this._blinking-=e,this._blinking>0)return;return this._blinking=0,void this.showAds(this.current_ad)}var t=this.current_ad;if(t.is_showed&&(t.show_dt+=e,t.show_dt>=this.refresh_time)){t&&(t.ad.hide(),t.is_showed=!1),this.next_ad_index++;var n=this.getNextAds();this.current_ad=n,this._style.blink?this._blinking=this._style.blink:this.showAds(n)}}},e.prototype.remove_ad=function(e){for(var t=0;t<this.banner_list.length;t++)if(this.banner_list[t].ad==e)return void this.banner_list.splice(t,1)},e}()),cc._RF.pop()},{}],gameIcon:[function(e,t,n){"use strict";cc._RF.push(t,"2ad31lcUwtAvoZav3zkEJKH","gameIcon"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=e("libwechat"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sp=null,t.icon_type="",t._refresh_time=0,t._single_list=null,t._single_index=0,t._redirectId=0,t._appid="",t._gameName="",t._icon="",t._path="",t}var n;return __extends(t,e),n=t,Object.defineProperty(t.prototype,"redirectId",{get:function(){return this._redirectId},set:function(e){this._redirectId!=e&&(this._redirectId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appid",{get:function(){return this._appid},set:function(e){this._appid!=e&&(this._appid=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gameName",{get:function(){return this._gameName},set:function(e){this._gameName!=e&&(this._gameName=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"icon",{get:function(){return this._icon},set:function(e){var t=this;cc.sys.isNative||this._icon!=e&&(this._icon=e,this._icon?cc.loader.load({url:this._icon},function(e,n){n&&t.sp&&t.sp.node&&t.sp.node.isValid&&(t.sp.spriteFrame=new cc.SpriteFrame(n))}):this.sp.spriteFrame=null)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._path},set:function(e){this._path!=e&&(this._path=e)},enumerable:!1,configurable:!0}),t.prototype.setData=function(e){this.appid=e.appid,this.gameName=e.name,this.icon=e.icon,this.path=e.path,this.redirectId=e.redirectId},t.prototype.getData=function(){return{appid:this.appid,gameName:this.gameName,icon:this.icon,path:this.path,redirectId:this.redirectId}},t.prototype.start=function(){var e=this;if(!cc.sys.isNative){var t=this.node.getComponent(cc.Button);t||(t=this.node.addComponent(cc.Button)),this.node.on("click",this.onClick,this),"single"===this.icon_type?(this.refreshIcon(),cc.tween(this.node).repeatForever(cc.tween().to(.1,{angle:12}).to(.1,{angle:-12}).to(.1,{angle:12}).to(.1,{angle:-12}).to(.05,{angle:0}).delay(2.5).call(function(){e.refreshIcon()})).start()):"banner"===this.icon_type&&this.refreshIcon()}},t.prototype.onClick=function(){var e=this;if(cc.sys.platform===cc.sys.WECHAT_GAME){var t=this._appid,n=this._path;wx.navigateToMiniProgram({appId:t,path:n,envVersion:"release",success:function(){wx.request({url:"https://xyx.p8games.com/wxgame/navigate/log",data:{ad:1,game:r.wechat.game_id,appid:t,name:e._gameName}})}})}"single"!==this.icon_type&&"banner"!==this.icon_type||this.refreshIcon()},t.prototype.refreshIcon=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return cc.sys.isNative?[2]:(this._refresh_time=(new Date).getTime(),"single"!==this.icon_type?[3,3]:this._single_list?[3,2]:[4,r.wechat.requestGameListNew(9)]);case 1:(e=t.sent())[0]&&e.length>0&&(this._single_list=e),t.label=2;case 2:return this._single_list||(this._single_list=[""]),this.setData(this._single_list[this._single_index]),this._single_index++,this._single_index>=this._single_list.length&&(this._single_index=0),[3,5];case 3:return"banner"!==this.icon_type?[3,5]:[4,r.wechat.requestGameListNew(1)];case 4:(e=t.sent()).data&&e.data.length>0&&this.setData(e.data[0]),t.label=5;case 5:return[2]}})})},t.prototype.update=function(){if("single"===this.icon_type);else if("banner"===this.icon_type){var e=(new Date).getTime();this._refresh_time<e-6e4&&this.refreshIcon()}},t.showIcon=function(e){var t=this;r.wechat.showRightupNative(function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(){return[2]})})},function(){return __awaiter(t,void 0,void 0,function(){var t,o;return __generator(this,function(i){switch(i.label){case 0:return this.game_icon_prefab?[3,2]:(t=this,[4,cocos.loadRes("gamewall/gameicon1",cc.Prefab)]);case 1:t.game_icon_prefab=i.sent(),i.label=2;case 2:return o=cc.instantiate(this.game_icon_prefab),e.addChild(o),o.children[0].active=!1,o.addComponent(n).icon_type="single",this.game_icon_node=o,[2]}})})},e)},t.hideIcon=function(){r.wechat.hideRightupNative(),this.game_icon_node&&this.game_icon_node.isValid&&(this.game_icon_node.removeFromParent(),this.game_icon_node=null)},t.game_icon_prefab=null,t.game_icon_node=null,__decorate([a(cc.Sprite)],t.prototype,"sp",void 0),__decorate([a],t.prototype,"icon_type",void 0),n=__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{libwechat:"libwechat"}],gameRecord:[function(e,t,n){"use strict";cc._RF.push(t,"391b2HPqF5IT5AXttZknrMG","gameRecord"),Object.defineProperty(n,"__esModule",{value:!0}),n.gameRecord=void 0;var o=e("libwechat");n.gameRecord=new(function(){function e(){var e=this;this._recorder=null,this._recording=!1,this._videoPath=null,this._stop_callback=null,this._record_time=0,this._recorded_secs=0,"undefined"!=typeof tt&&void 0!==tt.getGameRecorderManager&&"devtools"!=o.wechat.getSystemInfo().appName&&(this._recorder=tt.getGameRecorderManager(),this._recorder&&(this._recorder.onStart(function(){e._recording=!0,e._record_time=(new Date).getTime()}),this._recorder.onStop(function(t){console.log("gameRecord onStop",t.videoPath);var n=(new Date).getTime();e._recorded_secs+=(n-e._record_time)/1e3,console.log("\u7ed3\u675f\u5f55\u5c4f",e._recorded_secs),e._recording=!1,e._recorded_secs<=30?(e._videoPath=t.videoPath,e._stop_callback&&e._stop_callback(t.videoPath)):e._recorder.clipVideo({path:t.videoPath,timeRange:[16,0],success:function(t){console.log(t.videoPath),e._videoPath=t.videoPath,e._stop_callback&&e._stop_callback(t.videoPath)},fail:function(e){console.error(e)}})}),this._recorder.onPause(function(){var t=((new Date).getTime()-e._record_time)/1e3;e._recorded_secs+=t,console.log("\u6682\u505c\u5f55\u5c4f+"+t+"\uff0c\u5171"+e._recorded_secs)}),this._recorder.onResume(function(){e._record_time=(new Date).getTime(),console.log("\u7ee7\u7eed\u5f55\u5c4f")})))}return e.prototype.startRecord=function(e){if(void 0===e&&(e=0),console.log("startRecord",e),this._recorder){if(this._recording)return;return this.reset(),this._recorder.start({duration:e||30}),!0}return!1},e.prototype.stopRecord=function(e){if(console.log("startRecord",!!e),this._recorder){if(!this._recording)return void(e&&e(this._videoPath));this._stop_callback=e,this._recorder.stop()}else e&&e(this._videoPath)},e.prototype.pauseRecord=function(){this._recorder&&this._recorder.pause()},e.prototype.resumeRecord=function(){this._recorder&&this._recorder.resume()},e.prototype.recordClip=function(e){var t=this;return new Promise(function(n){t._recorder?(e.complete=function(){n(0)},t._recorder.recordClip(e)):n(0)})},e.prototype.shareVideo=function(e,t){if("undefined"!=typeof tt){var o=t||[e];tt.shareAppMessage({title:e,channel:"video",extra:{videoTopics:o,videoPath:n.gameRecord.videoPath,withVideoId:!0},success:function(){tt.showModal({title:"\u5206\u4eab\u6210\u529f"})},fail:function(e){tt.showModal({title:"\u5206\u4eab\u5931\u8d25"}),console.log("\u5206\u4eab\u5931\u8d25:",JSON.stringify(e))}})}},e.prototype.reset=function(){this._stop_callback=null,this._record_time=0,this._recorded_secs=0,this._videoPath=null,this._recording=!1},Object.defineProperty(e.prototype,"videoPath",{get:function(){return this._videoPath},enumerable:!1,configurable:!0}),e}()),cc._RF.pop()},{libwechat:"libwechat"}],gameWall1:[function(e,t,n){"use strict";cc._RF.push(t,"db081DoScdEjoPwhtg7BOKy","gameWall1"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=e("libwechat"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label_sp1=null,t.label_sp2=null,t.game_list=null,t.total_game=30,t}return __extends(t,e),t.prototype.load_game_list=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return[4,r.wechat.requestGameList(10)];case 1:if(0===(e=n.sent()).code){for(this.game_list=e.data,console.log("----------game list",e.data),t=0;t<10;t++)this.game_list[10+t]=this.game_list[t],this.game_list[20+t]=this.game_list[t];this.show(this.game_list)}return[2]}})})},t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return 1!=cc.vv.DrawerPageGridAd?[3,2]:(this.node.getChildByName("topGameWall").active=!1,[4,this.load_game_list()]);case 1:return e.sent(),[3,3];case 2:this.node.getChildByName("bg").active=!1,this.node.getChildByName("topGameWall").active=!0,this.node.getChildByName("\u597d\u53cb\u70ed\u73a9\u5e95\u6846").active=!1,e.label=3;case 3:return[2]}})})},t.prototype.show=function(e){for(var t=0;t<this.total_game;t++)if(this.content.children[t]&&e[t]){this.content.children[t].getComponent("gameIcon").setData(e[t]),this.content.children[t].getChildByName("New Label").getComponent(cc.Label).string=e[t].name;var n=Math.random();this.content.children[t].getChildByName("img_label1-min").getComponent(cc.Sprite).spriteFrame=n<=.09?this.label_sp1:n<=.18?this.label_sp2:null}},t.prototype.setRowPos=function(e,t){e.y=-420*t+210},t.prototype.onBtnShow=function(){var e=this;if(this.node.active=!0,cc.pauseGame(),1==cc.vv.DrawerPageGridAd){var t=this.node.getChildByName("bg");this.content=t;var n=this.node.getContentSize().height,o=-(t.getContentSize().height-n)/2;t.y=o;for(var i=function(n){var o=t.children[n],i=Math.floor(n/3)+1,r=n%3+1;switch(a.setRowPos(o,i),r){case 1:o.x=-300;break;case 2:o.x=0;break;default:o.x=300}o.stopAllActions(),cc.tween(o).repeatForever(cc.tween().by(3,{position:cc.v2(0,420)}).call(function(){o.y>=210&&e.setRowPos(o,10)})).start()},a=this,c=0;c<this.total_game;c++)i(c);this.node.getChildByName("topGameWall").active=!1,this.node.getChildByName("New Button").active=!1,this.node.getChildByName("bg").active=!0,this.node.getChildByName("\u597d\u53cb\u70ed\u73a9\u5e95\u6846").active=!0,r.wechat.showBannerAd("leftGameWall")}else this.node.getChildByName("bg").active=!1,this.node.getChildByName("topGameWall").active=!0,this.node.getChildByName("\u597d\u53cb\u70ed\u73a9\u5e95\u6846").active=!1,this.node.getChildByName("New Button").active=!0,r.wechat.showGameWall(function(){e.game_list||e.load_game_list(),cc.vv.DrawerPageGridAd=1,e.onBtnShow()},this.node.getChildByName("topGameWall"),this.node.getChildByName("New Button"))},t.prototype.onBtnClose=function(){this.node.active=!1,this.node.parent.getChildByName("bg").active=!0,cc.resumeGame(),r.wechat.hideBannerAd(),r.wechat.hideGameWall()},__decorate([a(cc.SpriteFrame)],t.prototype,"label_sp1",void 0),__decorate([a(cc.SpriteFrame)],t.prototype,"label_sp2",void 0),__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{libwechat:"libwechat"}],gameline:[function(e,t,n){"use strict";cc._RF.push(t,"f3a9bOqdmxDV7ShGqXLCHVM","gameline"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=e("libwechat"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.game_list=null,t}return __extends(t,e),t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return[4,r.wechat.requestGameListNew(6)];case 1:return(e=n.sent())&&e[1]&&(this.game_list=e,this.show(this.game_list)),this.node.parent&&(t=this.node.parent.getContentSize().width)&&640!=t&&(this.node.scale=t/640),[2]}})})},t.prototype.onEnable=function(){this.node.zIndex=1e4,this.content.setContentSize(890,this.content.getContentSize().height);for(var e=0;e<6;e++)this.content.children[e].stopAllActions(),this.content.children[e].x=150*e-375;var t=function(e){var t=n.content.children[e];cc.tween(t).repeatForever(cc.tween().delay(1.5).by(.5,{position:cc.v2(-150,0)}).delay(.5).call(function(){t.x<=-675&&(t.x=225)})).start()},n=this;for(e=0;e<6;e++)t(e)},t.prototype.show=function(e){for(var t=0;t<6;t++)this.content.children[t]&&e[t]&&this.content.children[t].getComponent("gameIcon").setData(e[t])},t.showLine=function(){var e=this;if("undefined"!=typeof tt)return!0;console.log("------------------showLine native",!!this.native_ad,this.native_ad_loaded);var t=parseInt(r.wechat.getConfig("ppgame_rate"));isNaN(t)&&(t=0);var n=Math.floor(100*Math.random())+1;return n>t&&this.native_ad&&this.native_ad_loaded?(console.log("rand",n,t),this.native_ad.show().catch(function(n){n&&"the advertisement has shown"==n.errMsg||(e.native_ad=null,t>0&&cc.Canvas.instance.node.emit("show-line"))}),!0):0==t||void 0},t.hideLine=function(){this.native_ad&&this.native_ad_loaded&&this.native_ad.hide()},t.init=function(e,t){var n=this;if("undefined"==typeof wx||void 0===wx.createCustomAd){if("undefined"!=typeof wx&&void 0!==wx.createBlockAd&&!this.native_ad){var o=r.wechat.wxCoordProjection(t||new cc.Rect(0,0,0,0)),i=wx.getSystemInfoSync().screenWidth;this.native_ad=qq.createBlockAd({adUnitId:e,size:5,orientation:"landscape",style:{left:16,top:o.top}}),console.log("#################### block ad top",o.top,e),this.native_ad.onLoad(function(){n.native_ad_loaded=!0,console.log("#################### block ad onLoad")}),this.native_ad.onResize(function(e){console.log("#################### block ad onResize",e),n.native_ad.style.left=(i-e.width)/2}),this.native_ad.onError(function(e){console.error("block ad error",e)})}return!1}if(!this.native_ad){o=r.wechat.wxCoordProjection(t||new cc.Rect(0,0,0,0));var a=wx.getSystemInfoSync().screenWidth;this.native_ad=wx.createCustomAd({adUnitId:e,adIntervals:30,style:{top:o.top,left:(a-360)/2}}),console.log("--------------------native line top",o.top),this.native_ad.onLoad(function(){n.native_ad_loaded=!0,console.log("=======================native line ad onLoad")})}},t.load=function(){return new Promise(function(e,t){cc.loader.loadRes("gameline/gameline",cc.Prefab,function(n,o){n?t(n):e(cc.instantiate(o))})})},t.native_ad=null,t.native_ad_loaded=!1,__decorate([a(cc.Node)],t.prototype,"content",void 0),__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{libwechat:"libwechat"}],gamewall:[function(e,t,n){"use strict";cc._RF.push(t,"879fbrCbc5DF7m7RIFyS86a","gamewall"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("libwechat"),i=e("libcocos"),a=cc._decorator,r=a.ccclass;a.property;var c=0,s=function(e){function t(){var t=e.call(this)||this;return t._show_type="normal",t._onClose=null,t._show_resolve=null,t._pop_navigate=null,t._hide_dt=0,console.log("constructor(gameWall)"),!n._req_game_list_line&&c>0&&(n._req_game_list_line=o.wechat.requestGameList(c)),n.game_list||(n._req_game_list=o.wechat.requestGameListNew(30)),t}var n;return __extends(t,e),n=t,t.prototype.onDisable=function(){this._show_resolve&&(this._show_resolve(),this._show_resolve=null)},t.prototype.onEnable=function(){o.wechat.hideBannerAd(),o.wechat.showBannerAd("blink")},t.prototype.onLoad=function(){return __awaiter(this,void 0,void 0,function(){var e,t,a,r,s,l,d,h,u,p,_,g,m,f,v=this;return __generator(this,function(w){switch(w.label){case 0:return e=this.node.getChildByName("wall"),(t=this.node.getChildByName("button"))&&(t.on("click",function(){v.onBtnClose()}),cc.tween(t).repeatForever(cc.tween().to(.3,{scale:1.1},{easing:"sineOut"}).to(.4,{scale:1},{easing:"sineIn"}).call(function(){})).start()),a=this.node.getChildByName("block"),r=e.getChildByName("scrollView"),(s=new cc.Node).addComponent(cc.Sprite).spriteFrame=a.getComponent(cc.Sprite).spriteFrame,r.children[0].zIndex=2,r.addChild(s,1),s.setContentSize(625,925),s.color=a.color,a.getComponent(cc.Sprite).spriteFrame=null,!n.game_list_line&&c>0?(l=n,[4,n._req_game_list_line]):[3,2];case 1:l.game_list_line=w.sent(),w.label=2;case 2:return n.game_list?[3,4]:(d=n,[4,n._req_game_list]);case 3:d.game_list=w.sent(),w.label=4;case 4:if(e){if(n.game_list_line)for(h=e.getChildByName("scrollViewLine"),(u=h.getChildByName("view").getChildByName("content")).width=140*n.game_list_line.length-20+4,p=function(e){cc.loader.loadRes("gamewall/gameicon1",function(t,a){if(null==t&&a){var r=cc.instantiate(a);if(r){u.addChild(r),r.y=0,r.x=62+140*e,i.cocos.load({url:n.game_list_line[e].icon,type:"png"}).then(function(e){r.isValid&&e&&(r.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e))});var c=n.game_list_line[e].appid,s=n.game_list_line[e].path||"",l=n.game_list_line[e].name||"";r.addComponent(cc.Button),r.on("click",function(){cc.sys.platform===cc.sys.WECHAT_GAME?wx.navigateToMiniProgram({appId:c,path:s,envVersion:"release",success:function(){wx.request({url:"https://xyx.p8games.com/wxgame/navigate/log",data:{ad:2,game:o.wechat.game_id,appid:c,name:l}})}}):console.log("navigate to appid",c)})}}else cc.warn(t+" name load error!!!")})},f=0;f<n.game_list_line.length;f++)p(f);else e.getChildByName("scrollViewLine").active=!1,e.getChildByName("title1").active=!1,e.getChildByName("title2").active=!1,e.getChildByName("scrollView").getComponent(cc.Widget).enabled=!1,e.getChildByName("scrollView").y=0,e.getChildByName("scrollView").scale=.8;for(_=e.getChildByName("scrollView"),g=_.getChildByName("view").getChildByName("content"),n.game_list.length%3==0?g.height=250*Math.floor(n.game_list.length/3)-20+200:g.height=250*(Math.floor(n.game_list.length/3)+1)-20+200,m=function(e){cc.loader.loadRes("gamewall/gameicon2",function(t,a){if(null==t&&a){var r=cc.instantiate(a);if(r){g.addChild(r),r.x=e%3*200-200,r.y=-250*Math.floor(e/3)-115;var c=Math.floor(100*Math.random());c<15?r.getChildByName("bg").getChildByName("red1").active=!0:c<30&&(r.getChildByName("bg").getChildByName("red2").active=!0),i.cocos.load({url:n.game_list[e].icon,type:"png"}).then(function(e){r.isValid&&e&&(r.getChildByName("bg").getChildByName("icon").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e))}),r.getChildByName("bg").getChildByName("name").getComponent(cc.Label).string=n.game_list[e].name;var s=n.game_list[e].appid,l=n.game_list[e].path||"";r.addComponent(cc.Button),r.on("click",function(){cc.sys.platform===cc.sys.WECHAT_GAME?wx.navigateToMiniProgram({appId:s,path:l,envVersion:"release",success:function(){wx.request({url:"https://xyx.p8games.com/wxgame/navigate/log",data:{ad:2,game:o.wechat.game_id,appid:s,name:gameName}})}}):console.log("navigate to appid",s)})}}else cc.warn(t+" name load error!!!")})},f=0;f<n.game_list.length;f++)m(f)}return[2]}})})},t.init=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return"undefined"!=typeof tt||""!=this._init_state?[2]:e&&2==e.length?(this._init_state="initing",this.native_grid_adIds=e,this.createNative(),this._init_state="inited",[2]):(console.error("\u5e7f\u544aid\u6570\u7ec4\u9519\u8bef\u3002['id1', 'id2']"),[2])})})},t.load=function(){return new Promise(function(e,t){cc.loader.loadRes("gamewall/gamewall",cc.Prefab,function(n,o){n?t(n):e(cc.instantiate(o))})})},t.createNative=function(){if(!n.native_grid_ad&&"undefined"!=typeof wx&&void 0!==wx.getSystemInfoSync)if("undefined"==typeof qq){var e=wx.getSystemInfoSync(),t=e.screenWidth,o=e.screenHeight;n.small_native=o/t<1.875;var i=wx.getSystemInfoSync(),a=(i.screenHeight-1422*i.screenWidth/1080)/2;n.native_grid_ad=wx.createCustomAd({adUnitId:n.small_native?this.native_grid_adIds[0]:this.native_grid_adIds[1],adIntervals:30,style:{top:a,left:0}}),n.native_grid_ad.onLoad(function(){console.log("---------------native ad onload")}),n.native_grid_ad.onError(function(e){console.log("---------------native ad onError",e)})}else n.native_grid_ad=qq.createAppBox({adUnitId:window["adunit-box"]})},t.showMoreGames=function(){this.createNative(),n.native_grid_ad.load().then(function(){n.native_grid_ad.show()})},t.prototype.showNative=function(){var e=this;if(this.node.getChildByName("button"),"undefined"==typeof wx||void 0===wx.createCustomAd)return"undefined"!=typeof qq?(console.log("---------------try to show native"),this.node.getChildByName("wall").active=!1,this.node.getChildByName("button").active=!1,void n.native_grid_ad.load().then(function(){n.native_grid_ad.show().then(function(){console.log("---------------succ to show native"),n.native_grid_ad.offClose(),n.native_grid_ad.onClose(function(){if(e.node.active){var t=e.node.getChildByName("wall");cc.tween(t).by(.2,{position:cc.v3(-320,0)}).call(function(){e.node.active=!1,cc.Canvas.instance.node.emit("hide-wall",null)}).start()}})}).catch(function(t){console.log("---------------fail to show grid native",t),e.node.active=!1,cc.Canvas.instance.node.emit("hide-wall",e._show_type)})}).catch(function(t){console.log("---------------fail to load native",t),e.node.active=!1,cc.Canvas.instance.node.emit("hide-wall",e._show_type)})):void this.show_wall();this.node.getChildByName("button").active=!0;var t=parseInt(o.wechat.getConfig("ppgame_rate"));if(Math.floor(100*Math.random())<t)this.show_wall();else if(this.node.getChildByName("wall").x=0,n.createNative(),n.native_grid_ad){if(console.log("---------------try to show native"),this.node.getChildByName("wall").active=!1,n.native_grid_ad.isShow())return;n.native_grid_ad.show().then(function(){console.log("---------------succ to show native"),n.native_grid_ad.offHide(),n.native_grid_ad.onHide(function(){if(e.node.active){var t=e.node.getChildByName("wall");cc.tween(t).by(.2,{position:cc.v3(-320,0,0)}).call(function(){e.node.active=!1,cc.Canvas.instance.node.emit("hide-wall",null),e._onClose&&(e._onClose(),e._onClose=null)}).start()}})}).catch(function(t){console.log("---------------fail to show grid native",t),t&&"the advertisement has shown"!=t.errMsg&&e.show_wall()})}else this.show_wall()},t.prototype.hideNative=function(){n.native_grid_ad&&n.native_grid_ad.hide()},t.prototype.show=function(e,t){return void 0===e&&(e="normal"),void 0===t&&(t=null),__awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(){return this._show_type=e,this.node.active=!0,this.node.zIndex=10002,640!=cc.winSize.width&&(this.node.scale=cc.winSize.width/640),this.node.getChildByName("button").y=(-cc.winSize.height/2+100)/this.node.scale,[2,new Promise(function(e){n._onClose=t,n._show_resolve=e,n.showNative()})]})})},t.prototype.show_wall=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(){return(e=this.node.getChildByName("wall")).active=!0,cc.tween(e).to(.2,{position:cc.v3(0,0,0)}).start(),e.getChildByName("scrollViewLine").getChildByName("view").getChildByName("content").x=-260,n.gameListLineChange=-1.5,e.getChildByName("scrollView").getChildByName("view").getChildByName("content").y=400,n.gameListChange=1.5,this.node.getChildByName("button").y=(-cc.winSize.height/2+100)/this.node.scale,[2]})})},t.prototype.onBtnClose=function(){var e=this;if("undefined"!=typeof qq)return this.node.active=!1,void(this._show_resolve&&(this._show_resolve(),this._show_resolve=null));var t=this.node.getChildByName("wall");cc.tween(t).by(.2,{position:cc.v3(-320,0,0)}).call(function(){e.node.active=!1,cc.Canvas.instance.node.emit("hide-wall",e._show_type),e._onClose&&(e._onClose(),e._onClose=null)}).start(),this.hideNative()},t.prototype.start=function(){},t.prototype.update=function(e){if(this.node&&this.node.active){this._hide_dt+=e,this._hide_dt>1&&(o.wechat.hideCustomBanner(),this._hide_dt=0);var t=this.node.getChildByName("wall");if(t){var i=t.getChildByName("scrollView").getChildByName("view").getChildByName("content");i.y+=n.gameListChange,i.y<400&&n.gameListChange<0&&(n.gameListChange=-n.gameListChange),i.y>i.height-400&&n.gameListChange>0&&(n.gameListChange=-n.gameListChange)}}},t.game_list_line=null,t.game_list=null,t.gameListLineChange=0,t.gameListChange=0,t._req_game_list_line=null,t._req_game_list=null,t._init_state="",t.native_grid_adIds=null,t.native_grid_ad=null,t.small_native=!0,n=__decorate([r],t)}(cc.Component);n.default=s,cc._RF.pop()},{libcocos:"libcocos",libwechat:"libwechat"}],libcocos:[function(e,t,n){"use strict";cc._RF.push(t,"5450atIXJRLPJ7BfPpZOz6u","libcocos"),Object.defineProperty(n,"__esModule",{value:!0}),n.cocos=void 0,n.cocos=new(function(){function e(){this.audio=new(function(){function e(){this._audioClips=new Map,this._effectMap=new Map}return e.prototype.playMusic=function(e,t){void 0===t&&(t=!0),this.loadAudioClip(e).then(function(e){return cc.audioEngine.playMusic(e,t)})},e.prototype.stopMusic=function(){cc.audioEngine.stopMusic()},e.prototype.playEffect=function(e,t){var n=this;void 0===t&&(t=!1),this.loadAudioClip(e).then(function(o){var i=n._effectMap;i.get(e)||i.set(e,[]);var a=i.get(e),r=cc.audioEngine.playEffect(o,t);a.push(r),t||setTimeout(function(){var e=a.indexOf(r);e>-1&&a.splice(e,1)},1e3*cc.audioEngine.getDuration(r))})},e.prototype.stopEffect=function(e){for(var t=0,n=this._effectMap.get(e)||[];t<n.length;t++){var o=n[t];cc.audioEngine.stop(o)}this._effectMap.set(e,[])},e.prototype.setMusicVolume=function(e){var t=cc.audioEngine.getMusicVolume(),n=0,o=setInterval(function(){(n+=.02)>=1?(clearInterval(o),cc.audioEngine.setMusicVolume(e)):cc.audioEngine.setMusicVolume(t+(e-t)*n)},20);return t},e.prototype.loadAudioClip=function(e){var t=this,o=this._audioClips.get(e);return o?new Promise(function(e){return e(o)}):n.cocos.loadRes(e,cc.AudioClip).then(function(n){return t._audioClips.set(e,n),n})},e}())}return e.prototype.preloadScene=function(e,t){return new Promise(function(n,o){cc.director.preloadScene(e,t,function(e,t){e?o(e):n(t)})})},e.prototype.loadScene=function(e){return new Promise(function(t,n){cc.director.loadScene(e,t)||n("Failed loading scene.")})},e.prototype.load=function(e,t){return new Promise(function(n,o){cc.loader.load(e,t,function(e,t){e?o(e):n(t)})})},e.prototype.loadRes=function(e,t,n){return new Promise(function(o,i){cc.loader.loadRes(e,t,n,function(e,t){e?i(e):o(t)})})},e.prototype.loadResArray=function(e,t,n){return new Promise(function(o,i){cc.loader.loadResArray(e,t,n,function(e,t){e?i(e):o(t)})})},e.prototype.loadResDir=function(e,t,n){return new Promise(function(o,i){cc.loader.loadResDir(e,t,n,function(e,t){e?i(e):o(t)})})},e.prototype.traverse=function(e,t){for(var n=new Array(e);n.length;){var o=n.pop();t(o),n.push.apply(n,o.children)}},e.prototype.searchNodeByName=function(e,t){for(var n=new Array(e);n.length;){var o=n.pop();if(o.name==t)return o;n.push.apply(n,o.children)}},e.prototype.searchNodeByPath=function(e,t){t.replace(/\\/g,"/");for(var n=e,o=0,i=t.split("/").filter(function(e){return e});o<i.length;o++){var a=i[o];if(!(n=n.getChildByName(a)))break}return n},e.prototype.asyncwait=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Promise(function(n){return cc.Canvas.instance.scheduleOnce(function(){return n.apply(void 0,t)},e/1e3)})},e.prototype.resizeCanvas=function(e){var t=cc.view.getDesignResolutionSize(),n=cc.view.getFrameSize(),o=cc.Canvas.instance;n.height/n.width>t.height/t.width?(o.fitHeight=!0,o.fitWidth=!1):(o.fitHeight=!1,o.fitWidth=!0),o.node.width/o.node.height<t.width/t.height?e.setScale(o.node.width/t.width):e.setScale(o.node.height/t.height)},e.prototype.getWorldPosition=function(e){var t=e.getPosition();return e.parent&&(t=e.parent.convertToNodeSpaceAR(t)),t},e.prototype.getWorldRectangle=function(e){var t=e.x-e.width*e.anchorX,n=e.y-e.height*e.anchorY;if(e.parent){var o=e.parent.convertToWorldSpaceAR(cc.v2(t,n));t=o.x,n=o.y}return cc.rect(t,n,e.width,e.height)},e}()),cc._RF.pop()},{}],libfacebook:[function(e,t,n){"use strict";cc._RF.push(t,"48586SN5hFMQZ8GAAjVgzyL","libfacebook"),Object.defineProperty(n,"__esModule",{value:!0}),n.facebook=n._FB_INSTANT=void 0,n._FB_INSTANT="undefined"!=typeof FBInstant,n.facebook=new(function(){function e(){}return e.prototype.initialize=function(e,t,o){n._FB_INSTANT&&(this._rewardedVideoId=e,this._interstitialId=t,this._sharingParameters=o,e&&(this._preloadedRewardedVideoAd=this.loadRewardedVideoAd()),t&&(this._preloadedInterstitialAd=this.loadInterstitialAd()),console.warn("Facebook Instant Game SDK Version "+FBInstant.getSDKVersion()))},e.prototype.showRewardedVideoAd=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return n._FB_INSTANT?[4,this._preloadedRewardedVideoAd]:[2];case 1:return[4,e.sent().showAsync()];case 2:return e.sent(),this._preloadedRewardedVideoAd=this.loadRewardedVideoAd(),[2]}})})},e.prototype.showInterstitialAd=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return n._FB_INSTANT?[4,this._preloadedInterstitialAd]:[2];case 1:return[4,e.sent().showAsync()];case 2:return e.sent(),this._preloadedInterstitialAd=this.loadInterstitialAd(),[2]}})})},e.prototype.shareAppMessage=function(e,t,o,i){if(!n._FB_INSTANT)return Promise.resolve();var a=this._sharingParameters(e,t,o,i);return this.toBase64(a.image).then(function(e){return FBInstant.shareAsync({intent:a.intent,text:a.title,image:e,data:a.query}).catch(function(e){console.warn("to base64 error:",e)})})},e.prototype.toBase64=function(e){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("get",e,!0),o.responseType="blob",o.onload=function(){if(o.status>=200&&o.status<300){var e=o.response,i=new FileReader;i.onloadend=function(e){t(e.target.result)},i.readAsDataURL(e)}else n("xhr response error")},o.onerror=function(){n("xhr request error")},o.send()})},e.prototype.loadRewardedVideoAd=function(){return __awaiter(this,void 0,Promise,function(){var e,t,n;return __generator(this,function(o){switch(o.label){case 0:o.label=1;case 1:return o.trys.push([1,3,,4]),[4,FBInstant.getRewardedVideoAsync(this._rewardedVideoId)];case 2:return e=o.sent(),[3,4];case 3:return t=o.sent(),console.warn("Failed getting rewarded video ad instance."),console.warn(t),[3,0];case 4:return[3,5];case 5:o.label=6;case 6:return o.trys.push([6,8,,9]),[4,e.loadAsync()];case 7:return o.sent(),[3,9];case 8:if(n=o.sent(),console.warn("Failed loading rewarded video ad."),console.warn(n),"ADS_NO_FILL"==n.code)throw n;return[3,5];case 9:return[3,10];case 10:return[2,e]}})})},e.prototype.loadInterstitialAd=function(){return __awaiter(this,void 0,Promise,function(){var e,t,n;return __generator(this,function(o){switch(o.label){case 0:o.label=1;case 1:return o.trys.push([1,3,,4]),[4,FBInstant.getInterstitialAdAsync(this._interstitialId)];case 2:return e=o.sent(),[3,4];case 3:return t=o.sent(),console.warn("Failed getting interstitial ad instance."),console.warn(t),[3,0];case 4:return[3,5];case 5:o.label=6;case 6:return o.trys.push([6,8,,9]),[4,e.loadAsync()];case 7:return o.sent(),[3,9];case 8:if(n=o.sent(),console.warn("Failed loading interstitial ad."),console.warn(n),"ADS_NO_FILL"==n.code)throw n;return[3,5];case 9:return[3,10];case 10:return[2,e]}})})},e.prototype.chooseContext=function(e,t,o){return n._FB_INSTANT?FBInstant.context.chooseAsync({filter:e,minSize:t,maxSize:o}).then(function(){return FBInstant.context.getID()}):Promise.resolve(null)},e}()),cc._RF.pop()},{}],libutils:[function(e,t,n){"use strict";cc._RF.push(t,"910c1kxMlNNcaR2Br3BUhtp","libutils"),Object.defineProperty(n,"__esModule",{value:!0}),n.utils=void 0,n.utils=new(function(){function e(){}return e.prototype.random=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.random()*(t-e)+e},e.prototype.randomInt=function(e,t){return Math.floor(this.random(e,t))},e.prototype.randomSet=function(e,t,n){for(var o=new Array(t-e),i=e;i<t;++i)o[i]=i;for(i=0;i<o.length;++i){var a=this.randomInt(0,o.length),r=this.randomInt(0,o.length),c=o[a];o[a]=o[r],o[r]=c}return o.splice(n),o},e.prototype.randomObj=function(e){return e[this.randomInt(0,e.length)]},e.prototype.asyncwait=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Promise(function(n){return setTimeout.apply(void 0,__spreadArrays([n,e],t))})},e}()),cc._RF.pop()},{}],libwechat_review:[function(e,t,n){"use strict";function o(e){return 1011==e||1047==e||1017==e||1007==e||1008==e||1030==e}cc._RF.push(t,"80825pTk3JN/4KXrWaFKiF1","libwechat_review"),Object.defineProperty(n,"__esModule",{value:!0}),n.wechat_review=void 0;var i="ppgames-scene";n.wechat_review=new(function(e){function t(){var t,n=e.call(this)||this;if(n._channel=null,n._scene=0,n._is_review=!1,n._remote_review=!1,n.real_scene="",n.real_channel="",cc.sys.platform===cc.sys.WECHAT_GAME||cc.sys.platform==cc.sys.BYTEDANCE_GAME){var a=wx.getLaunchOptionsSync();if(a&&(console.log("got launchOption",a),a.query&&a.query.channel?(n._channel=a.query.channel,n.real_channel=a.query.channel):a.referrerInfo&&a.referrerInfo.appId&&(n._channel=a.referrerInfo.appId),n.real_scene=a.scene,o(a.scene)?(n._scene=a.scene,t=a.scene,cc.sys.localStorage.setItem(i,t),console.log("localStorage save scene:"+n._scene),n._is_review=!0):(n._scene=function(){var e=cc.sys.localStorage.getItem(i);return console.log("localStorage scene:"+e),e&&parseInt(e)?parseInt(e):0}(),n._is_review=o(n._scene))),n._channel)cc.sys.localStorage.setItem("ppgames-channel",n._channel),console.log("localStorage save channel:"+n._channel);else{var r=cc.sys.localStorage.getItem("ppgames-channel");console.log("localStorage channel:"+n._channel),r&&(n._channel=r)}console.log("is review",n.isReview)}return n}return __extends(t,e),Object.defineProperty(t.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scene",{get:function(){return this._scene},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remote_review",{set:function(e){this._remote_review=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReview",{get:function(){return!!this._remote_review||!this._channel&&this._is_review},enumerable:!1,configurable:!0}),t}(cc.EventTarget)),cc._RF.pop()},{}],libwechat:[function(e,t,n){"use strict";function o(e,t,n,o,i){return void 0===t&&(t="get"),void 0===n&&(n=null),void 0===o&&(o={}),void 0===i&&(i=""),new Promise(function(a,r){var c=new XMLHttpRequest;for(var s in c.open(t,e,!0),c.responseType=i,o)c.setRequestHeader(s,o[s]);c.onload=function(){c.status>=200&&c.status<300?a(c.response):r("XHR_RES_ERROR")},c.onerror=function(){r("XHR_REQ_ERROR")},c.send(n)})}cc._RF.push(t,"8080eHLAi1Acq5iynhjo6Lv","libwechat"),Object.defineProperty(n,"__esModule",{value:!0}),n.wechat=n.GAME_PLATFORM=n.ERR_MSG_USER_CANCELLED=n.ERR_MSG_UNSUPPORTED_FUNCTION=n.ERR_MSG_INVALID_ADVERTISEMENT_ID=n.WX_EVT_GAME_CLUB=n.WX_EVT_GAME_HIDE=n.WX_EVT_GAME_SHOW=n.WX_EVT_USER_INFO=n.WX_EVT_ERROR_EVT=void 0,n.WX_EVT_ERROR_EVT="wx-on-error-evt",n.WX_EVT_USER_INFO="wx-on-user-info",n.WX_EVT_GAME_SHOW="wx-on-game-show",n.WX_EVT_GAME_HIDE="wx-on-game-hide",n.WX_EVT_GAME_CLUB="wx-on-game-club",n.ERR_MSG_INVALID_ADVERTISEMENT_ID="invalid advertisement id",n.ERR_MSG_UNSUPPORTED_FUNCTION="unsupported function",n.ERR_MSG_USER_CANCELLED="user cancelled",n.GAME_PLATFORM="undefined"!=typeof FBInstant?"facebook":"undefined"!=typeof wx?"wechat":(cc.sys.platform!==cc.sys.MOBILE_BROWSER&&cc.sys.platform!==cc.sys.DESKTOP_BROWSER||(window.Request=function(){var e=location.search,t=new Object;if(-1!=e.indexOf("?"))for(var n=e.substr(1).split("&"),o=0;o<n.length;o++)t[n[o].split("=")[0]]=unescape(n[o].split("=")[1]);return t}()),"html");var i=e("bannerAd"),a=e("libwechat_review");n.wechat=new(function(e){function t(){var t,r,c,s,l,d=e.call(this)||this;d.request=o,d._game_config={},d._config_loaded=!1,d._req_config_promis=null,d.game_id=window.game_id||"11",d._get_config_nonce="",d.app_version=window.version||"1.0.3",d._game_times=0,d._batch_banner_ids=null,d._showing_video=!1,d._video_ad=null,d._sysinfo=null,d._custom_banner={},d._loadingNative=null,d._rightup_native=null,d._hide__rightup_native=!1,d._close_rightup_native=!1,d._close_callback=null,d.boardString="",d._sharingParameters=null,d._wxOpenId=null,d._is_new=!1;var h=d.game_id;d._get_config_nonce=(r=(t=new Date).getMonth()+1,c=t.getDate(),s=t.getHours(),""+((l=t.getMinutes())>10?l:"0"+l)+(s>10?s:"0"+s)+(c>10?c:"0"+c)+(r>10?r:"0"+r)+Math.floor(1e4*Math.random()+0));var u="https://xyx.p8games.com/wxgame/api/getConfig?game="+h+"&channelid="+a.wechat_review.real_channel+"&sceneid="+a.wechat_review.real_scene+"&nonce="+d._get_config_nonce;return"undefined"!=typeof wx&&void 0!==wx.onShow?(wx.onShow(function(e){d.emit(n.WX_EVT_GAME_SHOW,e),d.showInterstitialAd(),console.log("onShow, op:",e)}),wx.onHide(function(){return d.emit(n.WX_EVT_GAME_HIDE)}),d._req_config_promis=new Promise(function(e,t){wx.request({url:u,success:function(t){if(console.log("------------got config",t),d._config_loaded=!0,t.data){d._game_config=t.data,t.data.review&&(a.wechat_review.remote_review=!0);var n=d._game_config.banner_refresh;"number"==typeof n&&(i.bannerAd.refresh_time=n),e(!0)}else e(!1)},fail:function(e){console.log("------------fail to got config",e,u),a.wechat_review.remote_review=!0,d._config_loaded=!0,t(e)}})})):d._req_config_promis=new Promise(function(e,t){o(u,"get",null,{},"json").then(function(t){var n={data:t};console.log("------------got config",n),d._config_loaded=!0,n.data?(d._game_config=n.data,n.data.review&&(a.wechat_review.remote_review=!0),e(!0)):e(!1)}).catch(function(e){console.log("------------fail to got config",e,u),a.wechat_review.remote_review=!0,d._config_loaded=!0,t(e)})}),d}return __extends(t,e),Object.defineProperty(t.prototype,"wxCode",{get:function(){return this._wxCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wxUserInfo",{get:function(){return this._wxUserInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appId",{get:function(){return this._appId},enumerable:!1,configurable:!0}),t.prototype.ensureConfigLoaded=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this._config_loaded?[2,Promise.resolve()]:[4,this._req_config_promis];case 1:return e.sent(),[2]}})})},t.prototype.getConfig=function(e){return this._game_config?!("no_single"!=e&&"no_line"!=e||this.game_started&&"undefined"==typeof tt)||this._game_config[e]:void 0},t.prototype.getVersion=function(){return this.app_version+"."+this._get_config_nonce},t.prototype.showVersion=function(e){var t=new cc.Node,n=t.addComponent(cc.Label);return n.string="v"+this.getVersion(),n.fontSize=20,t.setAnchorPoint(0,1),t.setPosition(cc.v2(-cc.winSize.width/2+10,cc.winSize.height/2-10)),e.addChild(t),t},t.prototype.requestGameList=function(e){return void 0===e&&(e=9),__awaiter(this,void 0,Promise,function(){return __generator(this,function(){return[2,o("https://xyx.p8games.com/wxgame/gameList?appid="+this._appId+"&count="+e+"&name=1","get",null,{},"json")]})})},t.prototype.requestGameListNew=function(e){return void 0===e&&(e=9),__awaiter(this,void 0,Promise,function(){return __generator(this,function(){return[2,o("https://xyx.p8games.com/wxgame/gameList?appid="+this._appId+"&count="+e+"&name=1&noblack=1","get",null,{},"json")]})})},t.prototype.logNewUser=function(){"undefined"!=typeof wx&&this._wxOpenId&&(cc.sys.localStorage.getItem("pp-car-"+this._wxOpenId)||(this._is_new=!0,this.logEvent("new"),cc.sys.localStorage.setItem("pp-car-"+this._wxOpenId,"1")))},t.prototype.logStart=function(){this.logEvent("start",this._is_new?1:0)},t.prototype.logLevel=function(e){this.logEvent("level",e)},t.prototype.logEvent=function(e,t){void 0===t&&(t=0)},Object.defineProperty(t.prototype,"wxOpenId",{get:function(){return this._wxOpenId},enumerable:!1,configurable:!0}),t.prototype.initializeOpenId=function(e){var t=this;return new Promise(function(n,o){wx.login({success:function(i){wx.request({url:"https://xyx.p8games.com/code2session",data:{appid:e,code:i.code},success:function(e){t._wxOpenId=e.data.openid,cc.Canvas.instance.node.emit("openid",e.data.openid),console.log("--------------------got openid",e.data.openid),t.logNewUser(),n(t._wxOpenId)},fail:function(e){o(e)}})},fail:function(e){o(e)}})})},t.prototype.resetWxCode=function(){this._wxCode=new Promise(function(e,t){wx.login({success:function(t){e(t.code)},fail:function(e){t(e)}})})},Object.defineProperty(t.prototype,"game_started",{get:function(){return this._game_times>0},enumerable:!1,configurable:!0}),t.prototype.addGameTimes=function(){return++this._game_times},t.prototype.onNewGame=function(e){if(void 0===e&&(e=null),this._game_times++,a.wechat_review.isReview)e&&e(!1);else{if(console.log("onNewGame",this._game_times,this.getConfig("gamestart_video"),this.getConfig("levelstart_video")),1==this._game_times&&this.getConfig("gamestart_video")||this._game_times>1&&this.getConfig("levelstart_video"))return cc.audioEngine.pauseMusic(),void this.showRewardedVideoAd().then(function(){cc.audioEngine.resumeMusic(),e&&e(!0)}).catch(function(){cc.audioEngine.resumeMusic(),e&&e(!1)});e&&e(!1)}},t.prototype.onGameResult=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return a.wechat_review.isReview||!this.getConfig("result_video")?[2]:[4,this.showRewardedVideoAd().catch(function(){e.showInterstitialAd()})];case 1:return t.sent(),[2]}})})},t.prototype.resetWxUserInfo=function(e){this._wxUserInfo=new Promise(function(t,n){if(e)return t(e);wx.getUserInfo({withCredentials:!0,success:function(e){t(e)},fail:function(e){n(e)}})})},t.prototype.wxCoordProjection=function(e){var t,n=cc.Canvas.instance,o=cc.view.getDesignResolutionSize(),i=cc.view.getFrameSize();if(e instanceof cc.Node){if(t=e.getBoundingBox(),e.parent){var a=e.parent.convertToWorldSpaceAR(cc.v2(t.x,t.y));t.x=a.x,t.y=a.y}for(var r=e.parent;r;)t.width*=r.scaleX,t.height*=r.scaleY,r=r.parent}else t=e;if(t.y=n.node.height-t.yMax,n.node.width/n.node.height!=o.width/o.height){var c=i.height/n.node.height;return t.x*=c,t.y*=c,t.width*=c,t.height*=c,{left:t.x,top:t.y,width:t.width,height:t.height}}return i.width/i.height<o.width/o.height?(c=i.width/o.width,t.x*=c,t.y*=c,t.y+=(i.height-o.height*c)/2,t.width*=c,t.height*=c):(c=i.height/o.height,t.x*=c,t.x+=(i.width-o.width*c)/2,t.y*=c,t.width*=c,t.height*=c),{left:t.x,top:t.y,width:t.width,height:t.height}},t.prototype.initialize=function(e,t,n,o,a){return __awaiter(this,void 0,void 0,function(){var n,r=this;return __generator(this,function(c){switch(c.label){case 0:return"undefined"==typeof wx||void 0===wx.showShareMenu?[3,2]:(console.log("-----------wechat initialize"),this._appId=e,this._rewardedVideoId=t,this._interstitialId=o,this._sharingParameters=a,wx.showShareMenu({withShareTicket:!0}),[4,this.ensureConfigLoaded()]);case 1:c.sent(),wx.onShareAppMessage(function(){return r._sharingParameters()}),this._custom_banner.id=window["adunit-line-banner"],this._custom_banner.id&&window["adunit-single-banner"]&&this.init_custom_banner(this._custom_banner.id,window["adunit-single-banner"]),void 0===(n=this.getConfig("bannerid"))&&(n=window["adunit-banner"]),"string"==typeof n&&(n=[n]),i.bannerAd.init(n),c.label=2;case 2:return[2]}})})},t.prototype.loadRewardedVideoAd=function(){if(console.log("loadRewardedVideoAd"),"undefined"==typeof wx)return Promise.resolve();if(this._showing_video)return Promise.reject("rewarded video ad is showing");var e=this.getRewardedVideoAd();return e.onError(function(e){console.log("fail to load rewardedVideoAd",e)}),e.load()},t.prototype.showRewardedVideoAd=function(e){var t=this;return void 0===e&&(e=null),console.log("wechat showRewardedVideoAd"),"undefined"==typeof wx?(e&&e.onShow&&e.onShow(),Promise.resolve()):void 0!==wx.miniProgram?(wx.miniProgram.navigateTo({url:"/pages/webviewGame/blank?adType=incentive"}),new Promise(function(e){setTimeout(function(){e()},2e3)})):this._showing_video?Promise.reject():(!e||e.toast,this._showing_video=!0,new Promise(function(o,i){var a=t.getRewardedVideoAd();a.offError(),a.onError(function(e){wx.hideLoading(),t._showing_video=!1,i(e)}),a.offClose(),a.onClose(function(e){t._showing_video=!1,e.isEnded&&e.isEnded||void 0===e?(t.logEvent("video",1),o()):i(n.ERR_MSG_USER_CANCELLED)}),a.load().then(function(){a.show().then(function(){wx.hideLoading(),e&&e.onShow&&e.onShow()}).catch(function(e){console.warn("video failed to show"),t._showing_video=!1,i(e)})}).catch(function(e){console.warn("video failed loading"),t._showing_video=!1,wx.hideLoading(),i(e)})}))},t.prototype.showRewardedVideoAdNew=function(){var e=this;return console.log("wechat showRewardedVideoAd"),"undefined"==typeof wx?Promise.resolve({isEnded:!0,err:0,errmsg:""}):void 0!==wx.miniProgram?(wx.miniProgram.navigateTo({url:"/pages/webviewGame/blank?adType=incentive"}),new Promise(function(e){setTimeout(function(){e({isEnded:!0,err:0,errmsg:""})},2e3)})):this._showing_video?Promise.resolve({isEnded:!1,err:1,errmsg:"\u89c6\u9891\u64ad\u653e\u4e2d"}):(wx.showLoading({title:"\u52a0\u8f7d\u89c6\u9891",mask:!0}),this._showing_video=!0,new Promise(function(t){var n=e.getRewardedVideoAd();n.offError(),n.onError(function(){wx.hideLoading(),e._showing_video=!1,t({isEnded:!1,err:1,errmsg:"\u89c6\u9891\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"})}),n.offClose(),n.onClose(function(n){e._showing_video=!1,n.isEnded&&n.isEnded||void 0===n?(e.logEvent("video",1),t({isEnded:!0,err:0,errmsg:""})):t({isEnded:!1,err:2,errmsg:"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1"})}),n.load().then(function(){n.show().then(function(){wx.hideLoading()}).catch(function(){console.warn("video failed to show"),e._showing_video=!1,t({isEnded:!1,err:1,errmsg:"\u89c6\u9891\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"})})}).catch(function(){console.warn("video failed loading"),e._showing_video=!1,wx.hideLoading(),t({isEnded:!1,err:1,errmsg:"\u89c6\u9891\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"})})}))},t.prototype.startRewardedVideoAd=function(){var e=this;return new Promise(function(t){var n=t;e.showRewardedVideoAd({onShow:function(){n(!0),n=null}}).then(function(){}).catch(function(e){console.log("fail to start rewardVideoAd",e),n&&n(!1)})})},t.prototype.getRewardedVideoAd=function(){var e=this._video_ad;return e||(e=wx.createRewardedVideoAd({adUnitId:this._rewardedVideoId}),this._video_ad=e),e},t.prototype.loadInterstitialAd=function(){var e=this;return console.log("loadInterstitialAd"),new Promise(function(t,o){return"undefined"==typeof wx?t():wx.createInterstitialAd?e._interstitialId?void wx.createInterstitialAd({adUnitId:e._interstitialId}).onError(function(e){return o(e)}):o(new Error(n.ERR_MSG_INVALID_ADVERTISEMENT_ID)):o(new Error(n.ERR_MSG_UNSUPPORTED_FUNCTION))})},t.prototype.showInterstitialAd=function(){var e=this;if(console.log("wechat showInterstitialAd",this._interstitialId),!a.wechat_review.isReview)return"undefined"!=typeof wx&&void 0!==wx.miniProgram?(wx.miniProgram.navigateTo({url:"/pages/webviewGame/blank?adType=tablePlaque"}),Promise.resolve()):this._interstitialId?new Promise(function(t,o){if("undefined"==typeof wx)return t();if(!wx.createInterstitialAd)return o(new Error(n.ERR_MSG_UNSUPPORTED_FUNCTION));if(!e._interstitialId)return o(new Error(n.ERR_MSG_INVALID_ADVERTISEMENT_ID));var i=wx.createInterstitialAd({adUnitId:e._interstitialId});i.offLoad(),i.onLoad(function(e){console.log("wx interstitialAd onLoad",e),i.show().catch(function(e){console.log("wx interstitialAd show err",e)})}),i.offError(),i.onError(function(e){console.log("wx interstitialAd onError",e),o(e)}),i.offClose(),i.onClose(function(){return t()})}):Promise.resolve()},t.prototype.getSystemInfo=function(){return this._sysinfo||"undefined"!=typeof wx&&void 0!==wx.getSystemInfoSync&&(this._sysinfo=wx.getSystemInfoSync()),this._sysinfo},t.prototype.isWxIos=function(){return cc.sys.platform===cc.sys.WECHAT_GAME&&"ios"==this.getSystemInfo().platform},t.prototype.isWxAndroid=function(){return cc.sys.platform===cc.sys.WECHAT_GAME&&"android"==this.getSystemInfo().platform},t.prototype.getWxPlatform=function(){return cc.sys.platform!==cc.sys.WECHAT_GAME?"":this.getSystemInfo().platform},t.prototype.init_custom_banner_single=function(e){var t=this;if(console.log("init_custom_banner2",e),!this._custom_banner.ad_single&&void 0!==wx.createCustomAd){var n=this.getSystemInfo(),o=wx.createCustomAd({adUnitId:e,adIntervals:30,style:{top:n.screenHeight-125,left:(n.screenWidth-68)/2}});this._custom_banner.ad_single=o,o.onLoad(function(){console.log("single banner loaded"),t._custom_banner.loaded_single=!0,2==t._custom_banner.show?o.show().then(function(){2!=t._custom_banner.show&&o.hide()}):o.isShow()&&o.hide()}),o.onClose(function(){t._custom_banner.ad_single.destroy(),t._custom_banner.ad_single=null,t._custom_banner.loaded_single=!1,2==t._custom_banner.show&&(t._custom_banner.show=0),t.init_custom_banner_single(e)})}},t.prototype.init_custom_banner=function(e,t){var n=this;if(a.wechat_review.isReview||"undefined"==typeof wx||void 0===wx.createCustomAd)return null;if(!this._custom_banner.ad){var o=this.getSystemInfo();console.log("init_custom_banner",e);var i=wx.createCustomAd({adUnitId:e,adIntervals:30,style:{top:o.screenHeight-120,left:(o.screenWidth-360)/2}});this._custom_banner.ad=i,i.onLoad(function(){console.log("line banner loaded"),n._custom_banner.loaded=!0,1==n._custom_banner.show?i.show().then(function(){1!=n._custom_banner.show&&i.hide()}):i.isShow()&&i.hide()})}this.init_custom_banner_single(t),console.log("init_custom_banner succ")},t.prototype.showCustomBanner=function(e){var t=this;return void 0===e&&(e=""),console.log("showCustomBanner",e,this._custom_banner),new Promise(function(n){if("ad_box"==e){if(2==t._custom_banner.show)return void n(!0);t._custom_banner.ad&&t._custom_banner.ad.isShow()&&t._custom_banner.ad.hide(),t._custom_banner.show=2,t._custom_banner.ad_single&&t._custom_banner.loaded_single?t._custom_banner.ad_single.show().then(function(){2!=t._custom_banner.show&&t._custom_banner.ad_single.hide(),n(!0)}).catch(function(){n(!1)}):n(!1)}else{if(1==t._custom_banner.show)return void n(!0);t._custom_banner.ad_single&&t._custom_banner.ad_single.isShow()&&t._custom_banner.ad_single.hide(),t._custom_banner.show=1,t._custom_banner.ad&&t._custom_banner.loaded?t._custom_banner.ad.show().then(function(){1!=t._custom_banner.show&&t._custom_banner.ad.hide(),n(!0)}):n(!1)}})},t.prototype.hideCustomBanner=function(){this._custom_banner.show=0,this._custom_banner.ad&&this._custom_banner.ad.isShow()&&this._custom_banner.ad.hide(),this._custom_banner.ad_single&&this._custom_banner.ad_single.isShow()&&this._custom_banner.ad_single.hide()},t.prototype.showBannerAd=function(e){var t=this;return void 0===e&&(e=""),console.log("wechat.showBanner",e),new Promise(function(n,o){i.bannerAd.show(e).then(function(){n()}).catch(function(a){"hb"!=e&&"hb2"!=e&&"blink"!=e?(i.bannerAd.hide(),t.showCustomBanner(e),n()):o(a)})})},t.prototype.hideBannerAd=function(){return console.log("wechat.hideBanner"),this.hideCustomBanner(),i.bannerAd.hide()},t.prototype.shareAppMessage=function(e,t,o){var i=this;return"undefined"==typeof wx?Promise.resolve():new Promise(function(a,r){wx.shareAppMessage(i._sharingParameters(e,t,o));var c=Date.now();i.once(n.WX_EVT_GAME_SHOW,function(){Date.now()-c>3e3?a():r(new Error(n.ERR_MSG_USER_CANCELLED))})})},t.prototype.showLoadingNative=function(e,t){if(console.log("#### showLoadingNative"),"undefined"!=typeof wx)if(void 0!==wx.createCustomAd){var n=this.getSystemInfo(),o=n.screenWidth,i=(n.screenHeight/o*640-269-20)/640*o-104-15;if(console.log("#### showLoadingNative createCustomAd",i),this._loadingNative=wx.createCustomAd({adUnitId:"adunit-44323ff0bb876029",adIntervals:30,style:{top:i,left:30}}),console.log("#### showLoadingNative show"),!this._loadingNative)return void(t&&t("unknown"));this._loadingNative.onClose(function(){cc.Canvas.instance.node.emit("close-native")}),this._loadingNative.show().then(function(){console.log("this._loadingNative.show() succ"),e&&e()}).catch(function(e){t&&t(e)})}else t&&t("none")},t.prototype.hideLoadingNative=function(){this._loadingNative&&(this._loadingNative.destroy(),this._loadingNative=null)},t.prototype.showRightupNative=function(e,t,n){var o=this;if(void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),this._hide__rightup_native=!1,"undefined"!=typeof wx&&void 0!==wx.createCustomAd&&!this._close_rightup_native&&window["adunit-single"]){var i=parseInt(this.getConfig("ppgame_rate"));if(isNaN(i)&&(i=0),Math.floor(100*Math.random())<i)return this._rightup_native&&this._rightup_native.isShow()&&this._rightup_native.hide(),void(t&&t());if(this._close_callback=t,!this._rightup_native||void 0===wx.createCustomAd){var a=this.wxCoordProjection(n);this._rightup_native=wx.createCustomAd({adUnitId:window["adunit-single"]||"adunit-44323ff0bb876029",adIntervals:30,style:{top:a.top,left:a.left}}),this._rightup_native.onClose(function(){console.log("close native single",!!o._close_callback),o._rightup_native=null,o._close_rightup_native=!0,cc.Canvas.instance.node.emit("close-native"),o._close_callback&&o._close_callback()})}console.log("#### showRightupNative show"),this._rightup_native?this._rightup_native.isShow()?e&&e():this._rightup_native.show().then(function(){console.log("showRightupNative show() succ"),e&&e(),o._hide__rightup_native&&o._rightup_native.hide()}).catch(function(n){if(console.log("fail to show native",n),n&&"the advertisement has shown"==n.errMsg)return e&&e(),void(o._hide__rightup_native&&o._rightup_native.hide());t&&t()}):t&&t()}else t&&t()},t.prototype.setRightupNativePos=function(e){if(this._rightup_native){var t=this.wxCoordProjection(e);console.log("set postion",this._rightup_native,t),this._rightup_native.style.left=t.left,this._rightup_native.style.top=t.top}},t.prototype.hideRightupNative=function(){this._hide__rightup_native=!0,this._rightup_native&&this._rightup_native.hide()},t.prototype.randomNum=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.prototype.setClipBoard=function(){if("undefined"!=typeof wx&&(window.debug||!a.wechat_review.isReview&&0!=this.getConfig("clipboard"))){var e=this.getConfig("clipboardarray")||[];if(e.length>0){var t=e[this.randomNum(0,e.length-1)];console.log("get board array ",t),wx.setClipboardData({data:t,success:function(){console.log("set board array ",t),wx.hideToast()}})}else{var n=this.getConfig("clipboardUrl")||"https://fetch.tokenet.site/t7lr7mwqtsqkeww7bmo943z71chi5";console.log("send request ",n);var o=this.getConfig("clipboard");if(2==o){var i=cc.sys.localStorage.getItem("clipboardvisitday");if(i&&i==(new Date).getFullYear()+"-"+(new Date).getMonth()+"-"+(new Date).getDate()){var r=cc.sys.localStorage.getItem("clipboardtextsaved");return void wx.setClipboardData({data:r,success:function(e){console.log("set clipboard",e.data),wx.hideToast()},fail:function(e){console.log("fail to set clipboard",e)}})}}new Promise(function(e,t){wx.request({url:n,success:function(t){if(t.data){var n=void 0;2==o?0==t.data.code&&(console.log("get request board ",t.data.data),n=t.data.data,cc.sys.localStorage.setItem("clipboardvisitday",(new Date).getFullYear()+"-"+(new Date).getMonth()+"-"+(new Date).getDate()),cc.sys.localStorage.setItem("clipboardtextsaved",n)):"ok"==t.data.status&&(console.log("get request board ",t.data.text),n=t.data.text),n&&wx.setClipboardData({data:n,success:function(e){console.log("set clipboard",e.data),wx.hideToast()},fail:function(e){console.log("fail to set clipboard",e)}}),e(!0)}else e(!1)},fail:function(e){console.log("get request board error ",e),t(e)}})})}}},t.prototype.isMiniprogram=function(){return"undefined"!=typeof wx&&void 0!==wx.miniProgram},t}(cc.EventTarget)),cc._RF.pop()},{bannerAd:"bannerAd",libwechat_review:"libwechat_review"}],my_anim:[function(e,t,n){"use strict";cc._RF.push(t,"7ec50aP9tdBMI7Du32PgDAK","my_anim"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sps=[],t.sp=null,t.loop=!1,t.frames_every_sec=10,t.auto_play=!0,t.auto_hide=!1,t.playing=!1,t.frame_index=0,t.frame_time=1/t.frames_every_sec,t.dt=t.frame_time,t.started=!1,t.need_to_play=!1,t.callback=null,t}return __extends(t,e),t.prototype.start=function(){if(this.started=!0,this.auto_play||this.need_to_play){if(this.sps.length<1||!this.sp)return void(this.need_to_play=!1);this.play(this.need_to_play?this.callback:null),this.need_to_play=!1}},t.prototype.play=function(e){void 0===e&&(e=null),this.callback=e,this.started?this.playing&&this.loop||(this.playing=!0,this.frame_index=0,this.frame_time=1/this.frames_every_sec,this.dt=0,this.sp.spriteFrame=this.sps[0],this.callback=e):this.need_to_play=!0},t.prototype.turn=function(e){this.playing=!!e},t.prototype.update=function(e){if(this.playing&&(this.dt+=e,this.dt>=this.frame_time)){if(this.frame_index>=this.sps.length){if(!this.loop)return this.playing=!1,this.auto_hide&&(this.node.active=!1),void(this.callback&&(this.callback(),this.callback=null));this.frame_index=0}this.dt-=this.frame_time,this.sp.spriteFrame=this.sps[this.frame_index++]}},__decorate([a([cc.SpriteFrame])],t.prototype,"sps",void 0),__decorate([a(cc.Sprite)],t.prototype,"sp",void 0),__decorate([a],t.prototype,"loop",void 0),__decorate([a],t.prototype,"frames_every_sec",void 0),__decorate([a],t.prototype,"auto_play",void 0),__decorate([a],t.prototype,"auto_hide",void 0),__decorate([i],t)}(cc.Component);n.default=r,cc._RF.pop()},{}],privacy:[function(e,t,n){"use strict";cc._RF.push(t,"1f388LsfbNFkp1mKGX8Vkon","privacy"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("libcocos"),i=e("libwechat"),a=cc._decorator,r=a.ccclass,c=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.privacy_content=null,t.title_label=null,t.privacy_node=null,t.protocol_node=null,t._confirm_resolve=null,t}var n;return __extends(t,e),n=t,t.prototype.start=function(){var e=this;this.node.getChildByName("PrivacyView").getChildByName("btn_yes").on("click",function(){cc.sys.localStorage.setItem("pp-privacy",1),e.node.removeFromParent(),e._confirm_resolve&&e._confirm_resolve(1)}),this.node.getChildByName("PrivacyView").getChildByName("btn_not").on("click",function(){qq.showModal({title:"\u662f\u5426\u4e0d\u540c\u610f\uff1f",content:"\u4e0d\u540c\u610f\u5219\u65e0\u6cd5\u7ee7\u7eed\u6e38\u620f\uff0c\u76f4\u63a5\u9000\u51fa\uff0c\u60a8\u8981\u8fd9\u4e48\u505a\u5417\uff1f",success:function(e){e.confirm?qq.exitMiniProgram():e.cancel}})}),this.node.getChildByName("PrivacyView").getChildByName("btn_detail").on("click",function(){e.privacy_content.active=!0,e.protocol_node.active=!0,e.privacy_node.active=!1,e.title_label.string="\u7528\u6237\u534f\u8bae"}),this.node.getChildByName("PrivacyView").getChildByName("btn_detail2").on("click",function(){e.privacy_content.active=!0,e.protocol_node.active=!1,e.privacy_node.active=!0,e.title_label.string="\u9690\u79c1\u653f\u7b56"}),this.privacy_content.getChildByName("btn_close").on("click",function(){e.privacy_content.active=!1,e.node.getChildByName("PrivacyView").active||e.node.removeFromParent()})},t.show=function(e){return console.log("show privacy",cc.sys.localStorage.getItem("pp-privacy")),"undefined"==typeof qq||cc.sys.localStorage.getItem("pp-privacy")?Promise.resolve(null):new Promise(function(t){o.cocos.loadRes("privacy/privacy",cc.Prefab).then(function(n){var o=cc.instantiate(n);e.addChild(o),t(o)})})},t.confirm=function(e){return console.log("show privacy",cc.sys.localStorage.getItem("pp-privacy")),"undefined"==typeof qq||cc.sys.localStorage.getItem("pp-privacy")?Promise.resolve(1):new Promise(function(t){o.cocos.loadRes("privacy/privacy",cc.Prefab).then(function(o){var i=cc.instantiate(o);e.addChild(i),i.getComponent(n)._confirm_resolve=t})})},t.showPrivacy=function(e){return console.log("show privacy"),i.wechat.hideBannerAd(),new Promise(function(t){o.cocos.loadRes("privacy/privacy",cc.Prefab).then(function(o){var i=cc.instantiate(o);i.getChildByName("PrivacyView").active=!1,i.getChildByName("web").active=!0;var a=i.getComponent(n);a.protocol_node.active=!1,a.privacy_node.active=!0,a.title_label.string="\u9690\u79c1\u653f\u7b56",e.addChild(i),t(i)})})},t.showProtocol=function(e){return i.wechat.hideBannerAd(),new Promise(function(t){o.cocos.loadRes("privacy/privacy",cc.Prefab).then(function(o){var i=cc.instantiate(o);i.getChildByName("PrivacyView").active=!1,i.getChildByName("web").active=!0;var a=i.getComponent(n);a.protocol_node.active=!0,a.privacy_node.active=!1,a.title_label.string="\u7528\u6237\u534f\u8bae",e.addChild(i),t(i)})})},__decorate([c(cc.Node)],t.prototype,"privacy_content",void 0),__decorate([c(cc.Label)],t.prototype,"title_label",void 0),__decorate([c(cc.Node)],t.prototype,"privacy_node",void 0),__decorate([c(cc.Node)],t.prototype,"protocol_node",void 0),n=__decorate([r],t)}(cc.Component);n.default=s,cc._RF.pop()},{libcocos:"libcocos",libwechat:"libwechat"}],redPackIcon:[function(e,t,n){"use strict";cc._RF.push(t,"654d2pCyjNE968UL/NYbJbb","redPackIcon"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("libcocos"),i=e("redPack"),a=e("redPackPage"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t}var n;return __extends(t,e),n=t,t.prototype.refresh=function(){var e=i.RedPackData.Inst.balance,t="";e%10==0&&(t=e%100==0?".00":"0"),this.label.string=""+e/100+t},t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return cc.tween(this.node).repeatForever(cc.tween().to(.1,{angle:12}).to(.1,{angle:-12}).to(.1,{angle:12}).to(.1,{angle:-12}).to(.05,{angle:0}).delay(2)).start(),i.RedPackData.Inst.logined?[3,2]:[4,i.RedPackData.Inst.login()];case 1:t.sent(),t.label=2;case 2:return this.refresh(),this.node.on("click",function(){a.default.show(cc.Canvas.instance.node,e.node.zIndex+1,cc.v2(0,0),e)}),[2]}})})},t.showIcon=function(e,t,i){return __awaiter(this,void 0,void 0,function(){var a,r;return __generator(this,function(c){switch(c.label){case 0:return[4,o.cocos.loadRes("redpack/redpackicon",cc.Prefab)];case 1:return a=c.sent(),r=cc.instantiate(a),e.addChild(r,i),t&&r.setPosition(t),n.inst=r,cc.Canvas.instance.node.emit("hongbao_icon",r),[2,r]}})})},t.inst=null,__decorate([s(cc.Label)],t.prototype,"label",void 0),n=__decorate([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{libcocos:"libcocos",redPack:"redPack",redPackPage:"redPackPage"}],redPackPage:[function(e,t,n){"use strict";cc._RF.push(t,"495d4/2xztDUYiJYPvqZ7g6","redPackPage"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("libcocos"),i=e("redPack"),a=e("redPackWithdraw"),r=cc._decorator,c=r.ccclass,s=r.property,l=window.hongbao_jumpto||"wxbec9976952c43d8c",d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.selected=0,t.hongbao_labels=[],t.withdraw_btn=null,t.hongbao_icon=null,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"Inst",{get:function(){return this._inst},enumerable:!1,configurable:!0}),t.prototype.start=function(){var e=this;this.node.getChildByName("redpack").getChildByName("btn_withdraw").on("click",function(){if(console.log("withdraw",e.selected),e.selected)if(i.RedPackData.Inst.vd_count>=i.RedPackData.hongbaoReq(e.selected-1))if("self"==l)a.default.show(e.node.parent,e.node.zIndex+1,e.selected);else{console.log("navigate to",l);var t=e.selected,n=e;wx.navigateToMiniProgram({appId:l,path:"?hb=1",extraData:{openid:i.RedPackData.Inst.openid,amount:i.RedPackData.hongbaoAmount(e.selected-1),nonce:Math.random().toString(36).slice(-8)},envVersion:"trial",success:function(){t<=2&&(i.RedPackData.Inst.vd_count-=i.RedPackData.hongbaoReq(t-1),n.set_vd_count(i.RedPackData.Inst.vd_count))}})}else"undefined"!=typeof wx&&wx.showToast({title:"\u4f60\u9886\u53d6\u7684\u7ea2\u5305\u6570\u91cf\u8fd8\u4e0d\u591f",icon:"none",duration:2e3}),console.log("vd count",i.RedPackData.Inst.vd_count)});var t=this.node.getChildByName("redpack").getChildByName("redpacks").children,n=t[0].children[0],o=this.node.getChildByName("redpack").getChildByName("req").getComponent(cc.Label),r=this.node.getChildByName("redpack").getChildByName("btn_withdraw").getComponent(cc.Button);this.withdraw_btn=r;var c=this.node.getChildByName("redpack").getChildByName("hongbao_labels").children;this.hongbao_labels=[];for(var s=function(a){t[a].on("click",function(){e.selected!=a+1&&(e.selected=a+1,n.parent=t[a],console.log("select",e.selected),o.string=i.RedPackData.Inst.vd_count+"/"+i.RedPackData.hongbaoReq(a),o.node.color=(new cc.Color).fromHEX(i.RedPackData.Inst.vd_count>=i.RedPackData.hongbaoReq(a)?"#FFE2B1":"#FF0000"),r.interactable=i.RedPackData.Inst.balance>=i.RedPackData.hongbaoAmount(a))});var s=c[a].getComponent(cc.Label);s.string=i.RedPackData.hongbaoAmount(a)/100+"\u5143",d.hongbao_labels[a]=s},d=this,h=0;h<6;h++)s(h);if(t[0].emit("click"),this.node.children[0].on("click",function(){e.node.removeFromParent()}),this.label.string=i.RedPackData.Inst.balance/100+"\u5143",window.hb_debug){var u=new cc.Node;u.addComponent(cc.Button),u.setContentSize(100,60),u.addComponent(cc.Label).string="test",this.node.addChild(u),u.x=250,u.y=0,u.on("click",function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.set_vd_count(++i.RedPackData.Inst.vd_count),[4,i.RedPackData.Inst.addHongbao(10)];case 1:return e.sent()>0&&(this.label.string=i.RedPackData.Inst.balance/100+"\u5143",this.node.getChildByName("redpack").getChildByName("btn_withdraw").getComponent(cc.Button).interactable=i.RedPackData.Inst.balance>=i.RedPackData.hongbaoAmount(this.selected-1)),[2]}})})})}},Object.defineProperty(t.prototype,"balance",{set:function(e){console.log("redpack page balance",e),this.label.string=e/100+"\u5143",this.hongbao_icon.refresh()},enumerable:!1,configurable:!0}),t.prototype.set_vd_count=function(){var e=this.node.getChildByName("redpack").getChildByName("req").getComponent(cc.Label);e&&(e.string=i.RedPackData.Inst.vd_count+"/"+i.RedPackData.hongbaoReq(this.selected-1),e.node.color=(new cc.Color).fromHEX(i.RedPackData.Inst.vd_count>=i.RedPackData.hongbaoReq(this.selected-1)?"#FFE2B1":"#FF0000")),this.withdraw_btn&&(this.withdraw_btn.interactable=i.RedPackData.Inst.balance>=i.RedPackData.hongbaoReq(this.selected-1))},t.prototype.onShow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,i.RedPackData.Inst.reqBalance()];case 1:return e.sent(),this.set_vd_count(i.RedPackData.Inst.vd_count),[2]}})})},t.prototype.onEnable=function(){i.RedPackData.Inst.redpack_page=this,n._inst=this},t.prototype.onDisable=function(){i.RedPackData.Inst.redpack_page=null,n._inst=null},t.show=function(e,t,i,a){return void 0===t&&(t=0),__awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(c){switch(c.label){case 0:return[4,new Promise(function(e,t){o.cocos.loadRes("redpack/redpackpage",cc.Prefab).then(function(t){e(cc.instantiate(t))}).catch(function(e){t(e)})})];case 1:return(r=c.sent()).getComponent(n).hongbao_icon=a,r.setPosition(i),e.addChild(r,t),[2]}})})},t._inst=null,__decorate([s(cc.Label)],t.prototype,"label",void 0),n=__decorate([c],t)}(cc.Component);n.default=d,cc._RF.pop()},{libcocos:"libcocos",redPack:"redPack",redPackWithdraw:"redPackWithdraw"}],redPackWithdraw:[function(e,t,n){"use strict";cc._RF.push(t,"547fbJ1wMlIvY9VMiRSHhiG","redPackWithdraw"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("libcocos"),i=e("redPack"),a=cc._decorator,r=a.ccclass,c=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t._openid="",t._his_openid="",t._amount=0,t._selected=0,t}var n;return __extends(t,e),n=t,t.prototype.start=function(){var e=this,t=!0;this.node.children[1].getChildByName("5button_tixian_o").on("click",function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t?(t=!1,this._selected>0?[4,i.RedPackData.Inst.withdraw(this._selected)]:[3,2]):[2];case 1:return e.sent()&&this.node.removeFromParent(),[3,4];case 2:return[4,i.RedPackData.Inst.withdraw_other(this._openid,this._his_openid,this._amount)];case 3:e.sent()&&this.node.removeFromParent(),e.label=4;case 4:return t=!0,[2]}})})}),this.node.children[0].on("click",function(){e.node.removeFromParent()})},t.prototype.onEnable=function(){n.isShow=!0},t.prototype.onDisable=function(){n.isShow=!1},Object.defineProperty(t.prototype,"amount",{set:function(e){e&&(this._amount=e,this.label.string="\uffe5"+this._amount/100)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selected",{set:function(e){e&&(this._selected=e,this.label.string="\uffe5"+i.RedPackData.hongbaoAmount(this._selected-1)/100)},enumerable:!1,configurable:!0}),t.show=function(e,t,i){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(r){switch(r.label){case 0:return[4,new Promise(function(e,t){o.cocos.loadRes("redpack/redpackwithdraw",cc.Prefab).then(function(t){e(cc.instantiate(t))}).catch(function(e){t(e)})})];case 1:return(a=r.sent()).getComponent(n).selected=i,a.setPosition(cc.v2(0,0)),e.addChild(a,t),[2]}})})},t.show_other=function(e,t,a,r){return __awaiter(this,void 0,void 0,function(){var c,s;return __generator(this,function(l){switch(l.label){case 0:return[4,new Promise(function(e,t){o.cocos.loadRes("redpack/redpackwithdraw",cc.Prefab).then(function(t){e(cc.instantiate(t))}).catch(function(e){t(e)})})];case 1:return c=l.sent(),s=c.getComponent(n),[4,i.RedPackData.Inst.login()];case 2:return l.sent(),s._openid=i.RedPackData.Inst.openid,s._his_openid=a,s._selected=0,s.amount=r,c.setPosition(cc.v2(0,0)),e.addChild(c,t),[2]}})})},t.isShow=!1,__decorate([c(cc.Label)],t.prototype,"label",void 0),n=__decorate([r],t)}(cc.Component);n.default=s,cc._RF.pop()},{libcocos:"libcocos",redPack:"redPack"}],redPack:[function(e,t,n){"use strict";cc._RF.push(t,"58f77Vuv8RNzY3PYa1voDex","redPack"),Object.defineProperty(n,"__esModule",{value:!0}),n.RedPackData=void 0;var o=e("bannerAd"),i=e("libcocos"),a=e("libwechat"),r=e("redPackIcon"),c=cc._decorator,s=c.ccclass;c.property;var l="https://xyx.p8games.com/wxgame/redpack";function d(){return Math.random().toString(36).slice(-8)}function h(e,t){return e+Math.floor(Math.random()*(t-e+1))}function u(e,t,n,o,i){return void 0===t&&(t="get"),void 0===n&&(n=null),void 0===o&&(o={}),void 0===i&&(i=""),new Promise(function(a,r){var c=new XMLHttpRequest;for(var s in c.open(t,e,!0),c.responseType=i,o)c.setRequestHeader(s,o[s]);c.onload=function(){c.status>=200&&c.status<300?a(JSON.parse(c.response)):r({err:"XHR_RES_ERROR"})},c.onerror=function(){r({err:"XHR_REQ_ERROR"})},c.send(n)})}var p=[100,500,1e3,2e3,5e3,1e4],_=[20,100,200,400,1e3,2e3],g=cc.sys.platform===cc.sys.WECHAT_GAME,m=function(){function e(){this.redpack_page=null,this.auto_poped=!1,this._openid="",this._balance=0,this._server_diff_time=0,this._hb_time=0,this._vd_count=0,this.logined=!1,this._withdraw_time=0;var e=parseInt(cc.sys.localStorage.getItem("pp_planes_vd_count"));isNaN(e)||(this._vd_count=e);var t=parseInt(cc.sys.localStorage.getItem("pp_planes_hb_time"));isNaN(t)||(this._hb_time=t)}return Object.defineProperty(e,"Inst",{get:function(){return this._inst||(this._inst=new e),this._inst},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"openid",{get:function(){return this._openid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"balance",{get:function(){return this._balance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vd_count",{get:function(){return this._vd_count},set:function(e){this._vd_count=e,cc.sys.localStorage.setItem("pp_planes_vd_count",this._vd_count)},enumerable:!1,configurable:!0}),e.hongbaoReq=function(e){return _[e]},e.hongbaoAmount=function(e){return p[e]},Object.defineProperty(e.prototype,"hb_time",{set:function(e){this._hb_time=e,cc.sys.localStorage.setItem("pp_planes_hb_time",this._hb_time)},enumerable:!1,configurable:!0}),e.prototype.wxlogin=function(){return new Promise(function(e,t){wx.login({success:function(t){e({code:t.code})},fail:function(e){t({err:e})}})})},e.prototype.time=function(){return Math.floor((new Date).getTime()/1e3)+this._server_diff_time},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,o,i,r;return __generator(this,function(c){switch(c.label){case 0:return!g||this.logined?[2]:[4,this.wxlogin()];case 1:return(e=c.sent()).code?[4,u(l+"/login?appid="+a.wechat.appId+"&code="+e.code+"&nonce="+d())]:(console.error("wxlogin fail",e),[2]);case 2:if(t=c.sent(),console.log("hb login resp",t),t.errmsg||t.err)return[2,t];if(!this.logined){if(n=a.wechat.getConfig("hongbao_req"))for(i=0;i<6;i++)r=parseInt(n[i]),isNaN(r)||(_[i]=r);if(o=a.wechat.getConfig("hongbao_list"))for(i=0;i<6;i++)r=parseInt(o[i]),isNaN(r)||(p[i]=100*r)}return this.logined=!0,this._server_diff_time=t.time-Math.floor((new Date).getTime()/1e3),this._openid=t.openid,this._balance=t.balance,this.redpack_page&&(this.redpack_page.balance=this._balance),[2,t]}})})},e.prototype.reqBalance=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return console.log("reqBalance",this._openid),this._openid?[4,u(l+"/balance?openid="+this._openid+"&time="+this.time()+"&nonce="+d())]:[2];case 1:return(e=t.sent()).errmsg||e.err||(this._balance=e.balance,this.redpack_page&&(this.redpack_page.balance=this._balance)),console.log("reqBalance res",e),[2,e]}})})},e.prototype.randomAmount=function(){var e=h(1,5),t=a.wechat.getConfig("hongbao");if(t){var n=t.split(","),o=parseInt(n[0]),i=parseInt(n[1]);!isNaN(o)&&!isNaN(i)&&o<=i&&o>0&&(e=h(o,i))}return e},e.prototype.addHongbao=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return this._openid?[4,u(l+"/addredpack?openid="+this._openid+"&amount="+e+"&time="+this.time()+"&nonce="+d())]:[2,0];case 1:return(t=n.sent()).err||t.errmsg?(console.log("fail to add hongbao",t),t.errmsg&&wx.showToast({title:t.errmsg,icon:"none",duration:2e3}),[2,0]):(this._balance=t.balance,this.redpack_page&&(this.redpack_page.balance=this._balance),[2,e])}})})},e.prototype.withdraw=function(e){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(o){switch(o.label){case 0:return this._openid?(t=p[e-1],console.log("withdraw",e,t),t>this._balance?(wx.showToast({title:"\u4f59\u989d\u4e0d\u8db3",icon:"none",duration:2e3}),[2,!1]):this._hb_time&&this._hb_time>(new Date).getTime()?(console.log("next",this._hb_time),wx.showToast({title:"\u6bcf\u5929\u53ea\u80fd\u63d0\u73b0\u4e00\u6b21\uff0c\u660e\u5929\u518d\u63d0\u5427",icon:"none",duration:2e3}),[2,!1]):e>2?(wx.showToast({title:"\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",icon:"none",duration:2e3}),[2,!1]):this._withdraw_time>(new Date).getTime()-1e4?(wx.showToast({title:"\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",icon:"none",duration:2e3}),[2]):(this._withdraw_time=(new Date).getTime(),[4,u(l+"/withdraw?appid="+a.wechat.appId+"&openid="+this._openid+"&amount="+t+"&time="+this.time()+"&nonce="+d())])):[2,!1];case 1:return(n=o.sent()).err||n.errmsg?n.errmsg?(wx.showToast({title:n.errmsg,icon:"none",duration:2e3}),[2,!1]):[2]:(this._balance=n.balance,this.vd_count=this._vd_count-_[e-1],this.redpack_page&&(this.redpack_page.balance=this._balance,this.redpack_page.set_vd_count(this._vd_count)),wx.showToast({title:"\u63d0\u73b0\u6210\u529f",icon:"none",duration:2e3}),this.hb_time=(new Date).getTime()+1e3*n.next,[2,!0])}})})},e.prototype.withdraw_other=function(e,t,n){return __awaiter(this,void 0,void 0,function(){var o;return __generator(this,function(i){switch(i.label){case 0:return this._openid?this._withdraw_time>(new Date).getTime()-1e4?(wx.showToast({title:"\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",icon:"none",duration:2e3}),[2]):(this._withdraw_time=(new Date).getTime(),[4,u(l+"/withdraw?appid="+a.wechat.appId+"&dst_openid="+e+"&openid="+t+"&amount="+n+"&time="+this.time()+"&nonce="+d())]):[2,!1];case 1:return(o=i.sent()).err||o.errmsg?o.errmsg?(wx.showToast({title:o.errmsg,icon:"none",duration:2e3}),[2,!1]):[2]:(wx.showToast({title:"\u63d0\u73b0\u6210\u529f",icon:"none",duration:2e3}),[2,!0])}})})},e._inst=null,e}();n.RedPackData=m;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.open_node=null,t.opened_node=null,t.opened_open_node=null,t.opened_get_node=null,t.unlock_btn_node=null,t.amount_label=null,t.progressBar=null,t._native_ad_active=!1,t._amount=0,t._video_valid=!1,t._maxProgress=100,t._boxProgress=0,t._adOutValue=0,t._bannerOut=!1,t.hongbao_btn=null,t._close_resolve=null,t}var n;return __extends(t,e),n=t,t.prototype.init=function(){var e=this;if(!this.open_node){this.open_node=this.node.getChildByName("open"),this.opened_node=this.node.getChildByName("opened"),this.opened_get_node=this.opened_node.getChildByName("opened").getChildByName("get"),this.opened_open_node=this.opened_node.getChildByName("opened").getChildByName("open"),this.unlock_btn_node=this.open_node.getChildByName("btn_unlock"),this.amount_label=this.opened_node.getChildByName("opened").getChildByName("amount").getComponent(cc.Label),this.progressBar=this.open_node.getChildByName("progress").getComponent(cc.ProgressBar);var t=a.wechat.wxCoordProjection(this.node.getChildByName("banner"));if(o.bannerAd.setTagTop("hb",t.top),!n._native_ad&&"undefined"!=typeof wx&&void 0!==window["adunit-line-adbox"]){var i=wx.createCustomAd({adUnitId:window["adunit-line-hb"],adIntervals:30,style:{top:t.top,left:(a.wechat.getSystemInfo().screenWidth-360)/2}});n._native_ad=i,i.onLoad(function(){console.log("hb line banner loaded"),e.showNativeAd()})}}},t.prototype.start=function(){var e=this;this.init(),this.unlock_btn_node.on(cc.Node.EventType.TOUCH_END,this.boxTouch,this);var t=this.opened_open_node.getChildByName("btn_open"),n=!0;t.on("click",function(){n&&(n=!1,a.wechat.showRewardedVideoAd().then(function(){return __awaiter(e,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,m.Inst.addHongbao(this._amount)];case 1:return(e=t.sent())>0?(this.amount_label.string=e/100+"\u5143",this.opened_open_node.active=!1,this.opened_get_node.active=!0,m.Inst.vd_count++):(cc.Canvas.instance.node.emit("hideBanner"),this.node.active=!1,this.node.removeFromParent(),cc.Canvas.instance.node.emit("show-continue")),n=!0,[2]}})})}).catch(function(e){n=!0,"undefined"!=typeof wx&&e!==a.ERR_MSG_USER_CANCELLED&&wx.showToast({title:"\u89c6\u9891\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",icon:"none",duration:2e3})}))}),this.opened_open_node.getChildByName("btn_close").on("click",function(){cc.Canvas.instance.node.emit("hideBanner"),console.log("send banner hide event"),e.node.active=!1,e.node.removeFromParent(),cc.Canvas.instance.node.emit("show-continue")});var o=this.opened_get_node.getChildByName("btn_get");o.on("click",function(){if(cc.Canvas.instance.node.emit("hideBanner"),console.log("send banner hide event"),cc.Canvas.instance.node.emit("show-continue"),e.opened_node.getChildByName("adTitle").active=!1,e.hongbao_btn&&e.hongbao_btn.isValid){var t=e.hongbao_btn.convertToWorldSpaceAR(cc.v2(0,0));console.log("pos",t,e.node.parent.convertToNodeSpaceAR(t)),e.node.getChildByName("bgNode").active=!1,cc.tween(e.node).to(.3,{scale:.15}).call(function(){}).to(.8,{position:e.node.parent.convertToNodeSpaceAR(t)}).call(function(){e.node.active=!1,e.node.removeFromParent(),e.hongbao_btn.getComponent(r.default).refresh(),cc.tween(e.hongbao_btn).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}).start()}else e.node.getChildByName("bgNode").active=!1,e.node.active=!1,e.node.removeFromParent()}),cc.tween(this.unlock_btn_node.children[0]).repeatForever(cc.tween().to(.1,{scale:1.1},{easing:"sineOut"}).to(.15,{scale:1},{easing:"sineIn"})).start(),cc.tween(o).repeatForever(cc.tween().to(.3,{scale:1.1},{easing:"sineOut"}).to(.4,{scale:.95},{easing:"sineIn"})).start(),cc.tween(t).repeatForever(cc.tween().to(.3,{scale:1.1},{easing:"sineOut"}).to(.4,{scale:.95},{easing:"sineIn"})).start()},t.prototype.onEnable=function(){n.isShow=!0},t.prototype.onDisable=function(){n.isShow=!1,this.hideNativeAd(),this._close_resolve&&this._close_resolve(),this._close_resolve=null},t.prototype.showNativeAd=function(){var e=this;console.log("hb showNativeAd",!!n._native_ad,this.node.isValid,this.node.active,this._native_ad_active);var t=n._native_ad;t&&(this.node.isValid&&this.node.active&&this._native_ad_active?t.show().then(function(){e.node.isValid&&e.node.active&&e._native_ad_active||t.hide()}):t.isShow()&&t.hide())},t.prototype.hideNativeAd=function(){this._native_ad_active=!1,n._native_ad&&n._native_ad.isShow()&&n._native_ad.hide()},t.prototype.onShow=function(){a.wechat.hideBannerAd()},t.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){var e,t,o,i,c,s,l,d,h=this;return __generator(this,function(){if(this.init(),this._boxProgress=35,this.setProgress(),this.hongbao_btn=r.default.inst,this.open_node.active=!0,this.opened_node.active=!1,this.node.zIndex=10002,this.node.active=!0,e=cc.winSize.width,t=cc.winSize.height,e/=this.node.scale,t/=this.node.scale,(o=this.node.getChildByName("bgNode")).active=!0,o.setContentSize(e,t),this._bannerOut=!1,this._adOutValue=this.randomNum(2*this._maxProgress/3,4*this._maxProgress/5),n._show_counter++,this._video_valid=!1,setTimeout(function(){h.preloadRewardVideoAd()},2e3),2==a.wechat.getConfig("ad_box_type")){switch(i=a.wechat.getConfig("ad_box_button_position")||{type:"bottom",y:.1},c=i.type||"center",s=i.x||0,l=i.y||0,s>-1&&s<1&&(s*=cc.winSize.width),l>-1&&l<1&&(l*=cc.winSize.height),c){case"center":break;case"bottom":l+=-cc.winSize.height/2;break;case"right":s+=cc.winSize.width/2}console.log("-----------------ad box button postion",i),s/=this.node.scale,l/=this.node.scale,this.unlock_btn_node.setPosition(cc.v2(s,l))}else(d=a.wechat.getConfig("button_position"))||(d=1),1==d||n._show_counter%d==1?this.unlock_btn_node.y=-t/2+135/this.node.scale:this.unlock_btn_node.y=this.progressBar.node.y-40-this.unlock_btn_node.getContentSize().height/2;return this._native_ad_active=!1,this.hideNativeAd(),a.wechat.showBannerAd("hb").catch(function(){console.log("fail to show banner of hb page"),h._native_ad_active=!0,h.showNativeAd()}),[2,new Promise(function(e){h._close_resolve=e})]})})},t.prototype.preloadRewardVideoAd=function(){var e=this;a.wechat.loadRewardedVideoAd().then(function(){e._video_valid=!0,console.log("rewardVideoAd loaded")}).catch(function(t){"rewarded video ad is showing"===t?setTimeout(function(){e.preloadRewardVideoAd()},1e3):console.log("fail to load rewardVideoAd",t)})},Object.defineProperty(t.prototype,"free_hongbao",{get:function(){var e=parseInt(cc.sys.localStorage.getItem("hongbao_free_count"));return isNaN(e)?0:e},set:function(e){cc.sys.localStorage.setItem("hongbao_free_count",e)},enumerable:!1,configurable:!0}),t.prototype.boxTouch=function(){return __awaiter(this,void 0,void 0,function(){var e,t=this;return __generator(this,function(n){switch(n.label){case 0:if(this.open_node.getChildByName("boxNodeOpen").runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.05,-10),cc.rotateTo(.05,0))),this._boxProgress+=10,!(this._boxProgress>=this._adOutValue)||this._bannerOut)return[3,13];switch(this._boxProgress=this._maxProgress,this._bannerOut=!0,a.wechat.getConfig("ad_box_type")){case 3:return[3,1];case 2:return[3,5]}return[3,10];case 1:return[4,a.wechat.showCustomBanner("ad_box")];case 2:return n.sent()?[3,4]:(a.wechat.hideCustomBanner(),[4,a.wechat.showBannerAd("hb2").catch(function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,a.wechat.startRewardedVideoAd()];case 1:return e.sent(),[2]}})})})]);case 3:n.sent(),n.label=4;case 4:return[3,12];case 5:return(e=!this._video_valid)?[3,7]:[4,a.wechat.startRewardedVideoAd()];case 6:e=!n.sent(),n.label=7;case 7:return e?[4,a.wechat.showBannerAd("hb2").catch(function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(){return a.wechat.showCustomBanner("ad_box"),[2]})})})]:[3,9];case 8:n.sent(),n.label=9;case 9:return[3,12];case 10:return[4,a.wechat.showBannerAd("hb2").catch(function(){return __awaiter(t,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return(e=!this._video_valid)?[3,2]:[4,a.wechat.startRewardedVideoAd()];case 1:e=!t.sent(),t.label=2;case 2:return e&&a.wechat.showCustomBanner("ad_box"),[2]}})})})];case 11:return n.sent(),[3,12];case 12:setTimeout(function(){return __awaiter(t,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return this._boxProgress=this._maxProgress,this.setProgress(),this.open_node.active=!1,this._amount=m.Inst.randomAmount(),e=parseInt(a.wechat.getConfig("hongbao_free")),console.log("free",e,this.free_hongbao),e&&this.free_hongbao<e?(this.free_hongbao++,this.opened_node.active=!0,this.opened_get_node.active=!1,this.opened_node.getChildByName("opened").runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1))),[4,m.Inst.addHongbao(this._amount)]):[3,2];case 1:return(t=n.sent())>0?(this.amount_label.string=t/100+"\u5143",this.opened_open_node.active=!1,this.opened_get_node.active=!0,m.Inst.vd_count++):(cc.Canvas.instance.node.emit("hideBanner"),this.node.active=!1,this.node.removeFromParent(),cc.Canvas.instance.node.emit("show-continue")),[3,3];case 2:this.opened_node.active=!0,this.opened_get_node.active=!1,this.opened_open_node.active=!0,this.opened_node.getChildByName("adTitle").active=!0,this.amount_label.string="???\u5143",this.opened_node.getChildByName("opened").runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1))),this.opened_open_node.getChildByName("tips").getComponent(cc.Label).string="\u6700\u9ad8\u53ef\u83b7\u5f97"+9*this._amount/100+"\u5143",n.label=3;case 3:return[2]}})})},500),n.label=13;case 13:return this.setProgress(),[2]}})})},t.prototype.onClose=function(){cc.Canvas.instance.node.emit("hideBanner"),console.log("send banner hide event"),this.node.active=!1,this.node.removeFromParent(),cc.Canvas.instance.node.emit("show-continue")},t.prototype.update=function(){this._boxProgress>.5&&this._boxProgress<this._maxProgress?(this._boxProgress-=.5,this.setProgress()):this._boxProgress<this._maxProgress&&(this._boxProgress=0,this.setProgress())},t.prototype.setProgress=function(){this.progressBar.progress=this._boxProgress/this._maxProgress},t.prototype.randomNum=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.load=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,new Promise(function(e,t){i.cocos.loadRes("redpack/redpack",cc.Prefab).then(function(t){e(cc.instantiate(t))}).catch(function(e){t(e)})})]})})},t._native_ad=null,t.isShow=!1,t._show_counter=0,n=__decorate([s],t)}(cc.Component);n.default=f,cc._RF.pop()},{bannerAd:"bannerAd",libcocos:"libcocos",libwechat:"libwechat",redPackIcon:"redPackIcon"}],topGameWall:[function(e,t,n){"use strict";cc._RF.push(t,"d77aa/LWTZKJoN3R81FNUJf","topGameWall"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=e("libwechat"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.game_list=null,t}return __extends(t,e),t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return cc.sys.isNative&&(this.node.children[0].active=!1,this.node.children[1].active=!1),[4,r.wechat.requestGameList(6)];case 1:return(e=t.sent())&&e[1]&&(this.game_list=e,console.log("----------game list",e),this.show(this.game_list)),[2]}})})},t.prototype.onEnable=function(){this.node.zIndex=1e4,this.content.setContentSize(890,this.content.getContentSize().height);for(var e=0;e<6;e++)this.content.children[e].stopAllActions(),this.content.children[e].x=150*e-375;var t=function(e){var t=n.content.children[e];cc.tween(t).repeatForever(cc.tween().delay(2).by(.5,{position:cc.v2(-150,0)}).delay(1.5).call(function(){t.x<=-675&&(t.x=225)})).start()},n=this;for(e=0;e<6;e++)t(e)},t.prototype.show=function(e){for(var t=0;t<6;t++)this.content.children[t]&&e[t]&&this.content.children[t].getComponent("gameIcon").setData(e[t])},__decorate([a(cc.Node)],t.prototype,"content",void 0),__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{libwechat:"libwechat"}],ts:[function(e,t){"use strict";cc._RF.push(t,"6d791YGcrpDso3wV0W/dJ2k","ts"),cc._RF.pop()},{}],use_reversed_rotateTo:[function(e,t){"use strict";cc._RF.push(t,"4bb7d26fQpN648QmJxUmtz+","use_reversed_rotateTo"),cc.RotateTo._reverse=!0,cc._RF.pop()},{}],"use_v2.1-2.2.1_cc.Toggle_event":[function(e,t){"use strict";cc._RF.push(t,"85db6rTB/pJ8K1MBLwFKVwG","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["AttributesMenu","CommonVehicle","CustomProgressBar","DebugSelfRotation","DialogMenu","DisplayBox","DisplayStage","GameItem","GameScene","Global","ListView","LoadingScene","MainScene","PPGameRank","PPGameSdk","PPGameWall","Panel","PresetCars","Queue","RacingCar","RacingRoad","ResultMenu","ReviveMenu","RoadSegment","Storage","StoreMenu","UnlockMenu","WXGameWall","adBox","bannerAd","gameIcon","gameRecord","gameWall1","gameline","gamewall","libcocos","libfacebook","libutils","libwechat","libwechat_review","my_anim","privacy","redPack","redPackIcon","redPackPage","redPackWithdraw","topGameWall","use_reversed_rotateTo","use_v2.1-2.2.1_cc.Toggle_event","ts"]);